!function(){var a="refresh-sihp-transjax";YUI.add(a,function(c){var b={remove_fave_photo:"Remove this photo from your favorites?",remove_fave_video:"Remove this video from your favorites?",add_fave_photo:"Add this photo to your favorites?",add_fave_video:"Add this video to your favorites?",added_contact:c.config.flickr.flags.enable_follow_theme?"Following":"Added!",add_contact:c.config.flickr.flags.enable_follow_theme?"Follow":"+ Add",scroll_down:"Scroll down",scroll_up:"Scroll up",scroll_to_next_photo:"Scroll to next photo",scroll_to_prev_photo:"Scroll to previous photo",shortcut_description:"Show all keyboard shortcuts",esc_description:"Close a dialog, like this one"};c.transjax.add("refresh-sihp",b)},"0.0.1",{requires:F.config.modules[a].requires||[],optional:F.config.modules[a].optional||[]})}();!function(){var module_id="refresh-sihp-sidebar";YUI.add(module_id,function(Y){var WIN_HEIGHT=0,DOC_HEIGHT=0,NAV_HEIGHT=0,FOOT_HEIGHT=0,SIDEBAR_HEIGHT=0,BILLBOARD_HEIGHT=0,NAV_PADDING=10,LEFT_MARGIN=0,FEED_WIDTH=0,self=this,dom={body:Y.one(document.body),main:Y.one("#main"),nav:Y.one("#global-nav"),feed:Y.one("#activityFeed"),sidebar:Y.one("#sidebar"),billboardAd:Y.one("#ad-container-billboard")};function checkBillboard(){var adHelper=F.adHelper;adHelper&&adHelper.onScheduledAd({spaceID:792600147,position:"MAST"},function(){remeasure({includeNav:!0}),redraw()})}function init(config){(config=config||{}).sidebarNode=dom.sidebar,remeasure({includeNav:!0,includeFoot:!0}),Y.one("#no-friends")||Y.one("#see-more-button-wrap").get("offsetHeight")-NAV_PADDING,redraw(),Y.refreshSIHPFriendFinder.init(config),Y.once("refreshAnnouncement:close",function(){remeasure({includeNav:!0}),redraw()}),Y.once("nofriends:close",measureAndDraw),Y.once("photobooksbanner:close",measureAndDraw),Y.on("SIHP:appended",measureAndDraw),Y.on("Liquid:resize",Y.betterThrottle(measureAndDraw,100,self)),Y.config.flickr.flags.enable_feed_reskin&&Y.all("#sihp-flickr-uploadr .install-button").on("click",function(e){e.preventDefault(),e.target.hasClass("disabled")||("macintosh"===Y.UA.os?(Y.rapidTracker.beacon("mac-uploadr-download"),Y.config.win.location="https://flickr.com/tools/downloadmac"):"windows"===Y.UA.os&&(Y.rapidTracker.beacon("windows-uploadr-download"),Y.config.win.location="https://flickr.com/tools/downloadwindows"))}),Y.one("#sihp-flickr-pro-upsell")&&Y.rapidTracker.addModules("sihp-flickr-pro-upsell")}function remeasure(options){options=options||{},WIN_HEIGHT=Y.one("window").get("winHeight"),DOC_HEIGHT=dom.body.get("docHeight"),dom.feed.get("offsetHeight"),SIDEBAR_HEIGHT=dom.sidebar.get("offsetHeight"),FEED_WIDTH=dom.feed.get("offsetWidth"),LEFT_MARGIN=Y.config.flickr.flags.enable_feed_reskin?dom.feed.getX()+FEED_WIDTH+20+20:dom.feed.getX()+FEED_WIDTH+20,dom.billboardAd&&FEED_WIDTH<970?(BILLBOARD_HEIGHT=dom.billboardAd.get("offsetHeight"),isNaN(BILLBOARD_HEIGHT)&&(BILLBOARD_HEIGHT=0)):BILLBOARD_HEIGHT=0,options.includeNav&&(NAV_HEIGHT=dom.nav.get("offsetHeight")+dom.nav.get("offsetTop")+NAV_PADDING),options.includeFoot&&(FOOT_HEIGHT=Y.one("#foot")?Y.one("#foot").get("offsetHeight"):0,Y.one("#footer_admin_info_div")&&(FOOT_HEIGHT+=Y.one("#footer_admin_info_div").get("offsetHeight")))}function redraw(e,currentScroll){currentScroll=currentScroll||(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop),SIDEBAR_HEIGHT<WIN_HEIGHT-NAV_HEIGHT?DOC_HEIGHT-FOOT_HEIGHT<currentScroll+NAV_HEIGHT+SIDEBAR_HEIGHT?dom.sidebar.setStyles({position:"absolute",top:"auto",bottom:0,left:"auto"}):currentScroll<=BILLBOARD_HEIGHT?dom.sidebar.setStyles({position:"absolute",top:BILLBOARD_HEIGHT,bottom:"auto",left:"auto"}):dom.sidebar.setStyles({position:"fixed",top:NAV_HEIGHT,bottom:"auto",left:LEFT_MARGIN}):DOC_HEIGHT-FOOT_HEIGHT<currentScroll+NAV_HEIGHT+SIDEBAR_HEIGHT?dom.sidebar.setStyles({position:"absolute",top:"auto",bottom:0,left:"auto"}):currentScroll<=Math.abs(WIN_HEIGHT-NAV_HEIGHT-BILLBOARD_HEIGHT-SIDEBAR_HEIGHT)?dom.sidebar.setStyles({position:"absolute",top:BILLBOARD_HEIGHT,bottom:"auto",left:"auto"}):dom.sidebar.setStyles({position:"fixed",top:"auto",bottom:0,left:LEFT_MARGIN})}function measureAndDraw(){remeasure(),redraw()}Y.refreshSIHPSidebar={init:init,scrollHandler:redraw,updateConfig:remeasure,loadSidebar:function(){var io_cfg={method:"get",data:"magic_cookie="+Y.config.flickr.magic_cookie,on:{success:function(id,o,args){var html=o.responseText.replace(/[\t\n]+/g,"");dom.sidebar.append(html),init(),Y.deferImages(dom.sidebar.all("img.defer"),{threshold:Y.DOM.winHeight()}),checkBillboard()},failure:function(obj,xhr){checkBillboard()}}};Y.io("/refresh_sihp_sidebar_fragment.gne?cachebust="+(new Date).getTime(),io_cfg)}}},"0.0.1",{requires:F.config.modules[module_id].requires||[],optional:F.config.modules[module_id].optional||[]})}();/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("classnamemanager",function(e,t){var n="classNamePrefix",r="classNameDelimiter",i=e.config;i[n]=i[n]||"yui3",i[r]=i[r]||"-",e.ClassNameManager=function(){var t=i[n],s=i[r];return{getClassName:e.cached(function(){var n=e.Array(arguments);return n[n.length-1]!==!0?n.unshift(t):n.pop(),n.join(s)})}}()},"3.11.0",{requires:["yui-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-base",function(e,t){function R(e){var t=this,n,r,i=t.constructor;t._strs={},t._cssPrefix=i.CSS_PREFIX||s(i.NAME.toLowerCase()),e=e||{},R.superclass.constructor.call(t,e),r=t.get(T),r&&(r!==P&&(n=r),t.render(n))}var n=e.Lang,r=e.Node,i=e.ClassNameManager,s=i.getClassName,o,u=e.cached(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),a="content",f="visible",l="hidden",c="disabled",h="focused",p="width",d="height",v="boundingBox",m="contentBox",g="parentNode",y="ownerDocument",b="auto",w="srcNode",E="body",S="tabIndex",x="id",T="render",N="rendered",C="destroyed",k="strings",L="<div></div>",A="Change",O="loading",M="_uiSet",_="",D=function(){},P=!0,H=!1,B,j={},F=[f,c,d,p,h,S],I=e.UA.webkit,q={};R.NAME="widget",B=R.UI_SRC="ui",R.ATTRS=j,j[x]={valueFn:"_guid",writeOnce:P},j[N]={value:H,readOnly:P},j[v]={value:null,setter:"_setBB",writeOnce:P},j[m]={valueFn:"_defaultCB",setter:"_setCB",writeOnce:P},j[S]={value:null,validator:"_validTabIndex"},j[h]={value:H,readOnly:P},j[c]={value:H},j[f]={value:P},j[d]={value:_},j[p]={value:_},j[k]={value:{},setter:"_strSetter",getter:"_strGetter"},j[T]={value:H,writeOnce:P},R.CSS_PREFIX=s(R.NAME.toLowerCase()),R.getClassName=function(){return s.apply(i,[R.CSS_PREFIX].concat(e.Array(arguments),!0))},o=R.getClassName,R.getByNode=function(t){var n,i=o();return t=r.one(t),t&&(t=t.ancestor("."+i,!0),t&&(n=q[e.stamp(t,!0)])),n||null},e.extend(R,e.Base,{getClassName:function(){return s.apply(i,[this._cssPrefix].concat(e.Array(arguments),!0))},initializer:function(t){var n=this.get(v);n instanceof r&&this._mapInstance(e.stamp(n))},_mapInstance:function(e){q[e]=this},destructor:function(){var t=this.get(v),n;t instanceof r&&(n=e.stamp(t,!0),n in q&&delete q[n],this._destroyBox())},destroy:function(e){return this._destroyAllNodes=e,R.superclass.destroy.apply(this)},_destroyBox:function(){var e=this.get(v),t=this.get(m),n=this._destroyAllNodes,r;r=e&&e.compareTo(t),this.UI_EVENTS&&this._destroyUIEvents(),this._unbindUI(e),t&&(n&&t.empty(),t.remove(P)),r||(n&&e.empty(),e.remove(P))},render:function(e){return!this.get(C)&&!this.get(N)&&(this.publish(T,{queuable:H,fireOnce:P,defaultTargetOnly:P,defaultFn:this._defRenderFn}),this.fire(T,{parentNode:e?r.one(e):null})),this},_defRenderFn:function(e){this._parentNode=e.parentNode,this.renderer(),this._set(N,P),this._removeLoadingClassNames()},renderer:function(){var e=this;e._renderUI(),e.renderUI(),e._bindUI(),e.bindUI(),e._syncUI(),e.syncUI()},bindUI:D,renderUI:D,syncUI:D,hide:function(){return this.set(f,H)},show:function(){return this.set(f,P)},focus:function(){return this._set(h,P)},blur:function(){return this._set(h,H)},enable:function(){return this.set(c,H)},disable:function(){return this.set(c,P)},_uiSizeCB:function(e){this.get(m).toggleClass(o(a,"expanded"),e)},_renderBox:function(e){var t=this,n=t.get(m),i=t.get(v),s=t.get(w),o=t.DEF_PARENT_NODE,u=s&&s.get(y)||i.get(y)||n.get(y);s&&!s.compareTo(n)&&!n.inDoc(u)&&s.replace(n),!i.compareTo(n.get(g))&&!i.compareTo(n)&&(n.inDoc(u)&&n.replace(i),i.appendChild(n)),e=e||o&&r.one(o),e?e.appendChild(i):i.inDoc(u)||r.one(E).insert(i,0)},_setBB:function(e){return this._setBox(this.get(x),e,this.BOUNDING_TEMPLATE,!0)},_setCB:function(e){return this.CONTENT_TEMPLATE===null?this.get(v):this._setBox(null,e,this.CONTENT_TEMPLATE,!1)},_defaultCB:function(e){return this.get(w)||null},_setBox:function(t,n,i,s){return n=r.one(n),n||(n=r.create(i),s?this._bbFromTemplate=!0:this._cbFromTemplate=!0),n.get(x)||n.set(x,t||e.guid()),n},_renderUI:function(){this._renderBoxClassNames(),this._renderBox(this._parentNode)},_renderBoxClassNames:function(){var e=this._getClasses(),t,n=this.get(v),r;n.addClass(o());for(r=e.length-3;r>=0;r--)t=e[r],n.addClass(t.CSS_PREFIX||s(t.NAME.toLowerCase()));this.get(m).addClass(this.getClassName(a))},_removeLoadingClassNames:function(){var e=this.get(v),t=this.get(m),n=this.getClassName(O),r=o(O);e.removeClass(r).removeClass(n),t.removeClass(r).removeClass(n)},_bindUI:function(){this._bindAttrUI(this._UI_ATTRS.BIND),this._bindDOM()},_unbindUI:function(e){this._unbindDOM(e)},_bindDOM:function(){var t=this.get(v).get(y),n=R._hDocFocus;n||(n=R._hDocFocus=t.on("focus",this._onDocFocus,this),n.listeners={count:0}),n.listeners[e.stamp(this,!0)]=!0,n.listeners.count++,I&&(this._hDocMouseDown=t.on("mousedown",this._onDocMouseDown,this))},_unbindDOM:function(t){var n=R._hDocFocus,r=e.stamp(this,!0),i,s=this._hDocMouseDown;n&&(i=n.listeners,i[r]&&(delete i[r],i.count--),i.count===0&&(n.detach(),R._hDocFocus=null)),I&&s&&s.detach()},_syncUI:function(){this._syncAttrUI(this._UI_ATTRS.SYNC)},_uiSetHeight:function(e){this._uiSetDim(d,e),this._uiSizeCB(e!==_&&e!==b)},_uiSetWidth:function(e){this._uiSetDim(p,e)},_uiSetDim:function(e,t){this.get(v).setStyle(e,n.isNumber(t)?t+this.DEF_UNIT:t)},_uiSetVisible:function(e){this.get(v).toggleClass(this.getClassName(l),!e)},_uiSetDisabled:function(e){this.get(v).toggleClass(this.getClassName(c),e)},_uiSetFocused:function(e,t){var n=this.get(v);n.toggleClass(this.getClassName(h),e),t!==B&&(e?n.focus():n.blur())},_uiSetTabIndex:function(e){var t=this.get(v);n.isNumber(e)?t.set(S,e):t.removeAttribute(S)},_onDocMouseDown:function(e){this._domFocus&&this._onDocFocus(e)},_onDocFocus:function(e){var t=R.getByNode(e.target),n=R._active;n&&n!==t&&(n._domFocus=!1,n._set(h,!1,{src:B}),R._active=null),t&&(t._domFocus=!0,t._set(h,!0,{src:B}),R._active=t)},toString:function(){return this.name+"["+this.get(x)+"]"},DEF_UNIT:"px",DEF_PARENT_NODE:null,CONTENT_TEMPLATE:L,BOUNDING_TEMPLATE:L,_guid:function(){return e.guid()},_validTabIndex:function(e){return n.isNumber(e)||n.isNull(e)},_bindAttrUI:function(e){var t,n=e.length;for(t=0;t<n;t++)this.after(e[t]+A,this._setAttrUI)},_syncAttrUI:function(e){var t,n=e.length,r;for(t=0;t<n;t++)r=e[t],this[M+u(r)](this.get(r))},_setAttrUI:function(e){e.target===this&&this[M+u(e.attrName)](e.newVal,e.src)},_strSetter:function(t){return e.merge(this.get(k),t)},getString:function(e){return this
.get(k)[e]},getStrings:function(){return this.get(k)},_UI_ATTRS:{BIND:F,SYNC:F}}),e.Widget=R},"3.11.0",{requires:["attribute","base-base","base-pluginhost","classnamemanager","event-focus","node-base","node-style"],skinnable:!0});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-htmlparser",function(e,t){var n=e.Widget,r=e.Node,i=e.Lang,s="srcNode",o="contentBox";n.HTML_PARSER={},n._buildCfg={aggregates:["HTML_PARSER"]},n.ATTRS[s]={value:null,setter:r.one,getter:"_getSrcNode",writeOnce:!0},e.mix(n.prototype,{_getSrcNode:function(e){return e||this.get(o)},_preAddAttrs:function(e,t,n){var r={id:e.id,boundingBox:e.boundingBox,contentBox:e.contentBox,srcNode:e.srcNode};this.addAttrs(r,t,n),delete e.boundingBox,delete e.contentBox,delete e.srcNode,delete e.id,this._applyParser&&this._applyParser(t)},_applyParsedConfig:function(t,n,r){return r?e.mix(n,r,!1):n},_applyParser:function(t){var n=this,r=this._getNodeToParse(),s=n._getHtmlParser(),o,u;s&&r&&e.Object.each(s,function(e,t,s){u=null,i.isFunction(e)?u=e.call(n,r):i.isArray(e)?(u=r.all(e[0]),u.isEmpty()&&(u=null)):u=r.one(e),u!==null&&u!==undefined&&(o=o||{},o[t]=u)}),t=n._applyParsedConfig(r,t,o)},_getNodeToParse:function(){var e=this.get("srcNode");return this._cbFromTemplate?null:e},_getHtmlParser:function(){var t=this._getClasses(),n={},r,i;for(r=t.length-1;r>=0;r--)i=t[r].HTML_PARSER,i&&e.mix(n,i,!0);return n}})},"3.11.0",{requires:["widget-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-skin",function(e,t){var n="boundingBox",r="contentBox",i="skin",s=e.ClassNameManager.getClassName;e.Widget.prototype.getSkinName=function(e){var t=this.get(r)||this.get(n),o,u;return e=e||s(i,""),u=new RegExp("\\b"+e+"(\\S+)"),t&&t.ancestor(function(e){return o=e.get("className").match(u),o}),o?o[1]:null}},"3.11.0",{requires:["widget-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-uievents",function(e,t){var n="boundingBox",r=e.Widget,i="render",s=e.Lang,o=":",u=e.Widget._uievts=e.Widget._uievts||{};e.mix(r.prototype,{_destroyUIEvents:function(){var t=e.stamp(this,!0);e.each(u,function(n,r){n.instances[t]&&(delete n.instances[t],e.Object.isEmpty(n.instances)&&(n.handle.detach(),u[r]&&delete u[r]))})},UI_EVENTS:e.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(n)},_createUIEvent:function(t){var n=this._getUIEventNode(),i=e.stamp(n)+t,s=u[i],o;s||(o=n.delegate(t,function(e){var t=r.getByNode(this);t&&t._filterUIEvent(e)&&t.fire(e.type,{domEvent:e})},"."+e.Widget.getClassName()),u[i]=s={instances:{},handle:o}),s.instances[e.stamp(this)]=1},_filterUIEvent:function(e){return e.currentTarget.compareTo(e.container)||e.container.compareTo(this._getUIEventNode())},_getUIEvent:function(e){if(s.isString(e)){var t=this.parseType(e)[1],n,r;return t&&(n=t.indexOf(o),n>-1&&(t=t.substring(n+o.length)),this.UI_EVENTS[t]&&(r=t)),r}},_initUIEvent:function(e){var t=this._getUIEvent(e),n=this._uiEvtsInitQueue||{};t&&!n[t]&&(this._uiEvtsInitQueue=n[t]=1,this.after(i,function(){this._createUIEvent(t),delete this._uiEvtsInitQueue[t]}))},on:function(e){return this._initUIEvent(e),r.superclass.on.apply(this,arguments)},publish:function(e,t){var n=this._getUIEvent(e);return n&&t&&t.defaultFn&&this._initUIEvent(n),r.superclass.publish.apply(this,arguments)}},!0)},"3.11.0",{requires:["node-event-delegate","widget-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stdmod",function(e,t){function H(e){}var n=e.Lang,r=e.Node,i=e.UA,s=e.Widget,o="",u="hd",a="bd",f="ft",l="header",c="body",h="footer",p="fillHeight",d="stdmod",v="Node",m="Content",g="firstChild",y="childNodes",b="ownerDocument",w="contentBox",E="height",S="offsetHeight",x="auto",T="headerContentChange",N="bodyContentChange",C="footerContentChange",k="fillHeightChange",L="heightChange",A="contentUpdate",O="renderUI",M="bindUI",_="syncUI",D="_applyParsedConfig",P=e.Widget.UI_SRC;H.HEADER=l,H.BODY=c,H.FOOTER=h,H.AFTER="after",H.BEFORE="before",H.REPLACE="replace";var B=H.HEADER,j=H.BODY,F=H.FOOTER,I=B+m,q=F+m,R=j+m;H.ATTRS={headerContent:{value:null},footerContent:{value:null},bodyContent:{value:null},fillHeight:{value:H.BODY,validator:function(e){return this._validateFillHeight(e)}}},H.HTML_PARSER={headerContent:function(e){return this._parseStdModHTML(B)},bodyContent:function(e){return this._parseStdModHTML(j)},footerContent:function(e){return this._parseStdModHTML(F)}},H.SECTION_CLASS_NAMES={header:s.getClassName(u),body:s.getClassName(a),footer:s.getClassName(f)},H.TEMPLATES={header:'<div class="'+H.SECTION_CLASS_NAMES[B]+'"></div>',body:'<div class="'+H.SECTION_CLASS_NAMES[j]+'"></div>',footer:'<div class="'+H.SECTION_CLASS_NAMES[F]+'"></div>'},H.prototype={initializer:function(){this._stdModNode=this.get(w),e.before(this._renderUIStdMod,this,O),e.before(this._bindUIStdMod,this,M),e.before(this._syncUIStdMod,this,_)},_syncUIStdMod:function(){var e=this._stdModParsed;(!e||!e[I])&&this._uiSetStdMod(B,this.get(I)),(!e||!e[R])&&this._uiSetStdMod(j,this.get(R)),(!e||!e[q])&&this._uiSetStdMod(F,this.get(q)),this._uiSetFillHeight(this.get(p))},_renderUIStdMod:function(){this._stdModNode.addClass(s.getClassName(d)),this._renderStdModSections(),this.after(T,this._afterHeaderChange),this.after(N,this._afterBodyChange),this.after(C,this._afterFooterChange)},_renderStdModSections:function(){n.isValue(this.get(I))&&this._renderStdMod(B),n.isValue(this.get(R))&&this._renderStdMod(j),n.isValue(this.get(q))&&this._renderStdMod(F)},_bindUIStdMod:function(){this.after(k,this._afterFillHeightChange),this.after(L,this._fillHeight),this.after(A,this._fillHeight)},_afterHeaderChange:function(e){e.src!==P&&this._uiSetStdMod(B,e.newVal,e.stdModPosition)},_afterBodyChange:function(e){e.src!==P&&this._uiSetStdMod(j,e.newVal,e.stdModPosition)},_afterFooterChange:function(e){e.src!==P&&this._uiSetStdMod(F,e.newVal,e.stdModPosition)},_afterFillHeightChange:function(e){this._uiSetFillHeight(e.newVal)},_validateFillHeight:function(e){return!e||e==H.BODY||e==H.HEADER||e==H.FOOTER},_uiSetFillHeight:function(e){var t=this.getStdModNode(e),n=this._currFillNode;n&&t!==n&&n.setStyle(E,o),t&&(this._currFillNode=t),this._fillHeight()},_fillHeight:function(){if(this.get(p)){var e=this.get(E);e!=o&&e!=x&&this.fillHeight(this.getStdModNode(this.get(p)))}},_uiSetStdMod:function(e,t,r){if(n.isValue(t)){var i=this.getStdModNode(e,!0);this._addStdModContent(i,t,r),this.set(e+m,this._getStdModContent(e),{src:P})}else this._eraseStdMod(e);this.fire(A)},_renderStdMod:function(e){var t=this.get(w),n=this._findStdModSection(e);return n||(n=this._getStdModTemplate(e)),this._insertStdModSection(t,e,n),this[e+v]=n,this[e+v]},_eraseStdMod:function(e){var t=this.getStdModNode(e);t&&(t.remove(!0),delete this[e+v])},_insertStdModSection:function(e,t,n){var r=e.get(g);if(t===F||!r)e.appendChild(n);else if(t===B)e.insertBefore(n,r);else{var i=this[F+v];i?e.insertBefore(n,i):e.appendChild(n)}},_getStdModTemplate:function(e){return r.create(H.TEMPLATES[e],this._stdModNode.get(b))},_addStdModContent:function(e,t,n){switch(n){case H.BEFORE:n=0;break;case H.AFTER:n=undefined;break;default:n=H.REPLACE}e.insert(t,n)},_getPreciseHeight:function(e){var t=e?e.get(S):0,n="getBoundingClientRect";if(e&&e.hasMethod(n)){var r=e.invoke(n);r&&(t=r.bottom-r.top)}return t},_findStdModSection:function(e){return this.get(w).one("> ."+H.SECTION_CLASS_NAMES[e])},_parseStdModHTML:function(t){var n=this._findStdModSection(t);return n?(this._stdModParsed||(this._stdModParsed={},e.before(this._applyStdModParsedConfig,this,D)),this._stdModParsed[t+m]=1,n.get("innerHTML")):null},_applyStdModParsedConfig:function(e,t,n){var r=this._stdModParsed;r&&(r[I]=!(I in t)&&I in r,r[R]=!(R in t)&&R in r,r[q]=!(q in t)&&q in r)},_getStdModContent:function(e){return this[e+v]?this[e+v].get(y):null},setStdModContent:function(e,t,n){this.set(e+m,t,{stdModPosition:n})},getStdModNode:function(e,t){var n=this[e+v]||null;return!n&&t&&(n=this._renderStdMod(e)),n},fillHeight:function(e){if(e){var t=this.get(w),r=[this.headerNode,this.bodyNode,this.footerNode],s,o,u=0,a=0,f=!1;for(var l=0,c=r.length;l<c;l++)s=r[l],s&&(s!==e?u+=this._getPreciseHeight(s):f=!0);f&&((i.ie||i.opera)&&e.set(S,0),o=t.get(S)-parseInt(t.getComputedStyle("paddingTop"),10)-parseInt(t.getComputedStyle("paddingBottom"),10)-parseInt(t.getComputedStyle("borderBottomWidth"),10)-parseInt(t.getComputedStyle("borderTopWidth"),10),n.isNumber(o)&&(a=o-u,a>=0&&e.set(S,a)))}}},e.WidgetStdMod=H},"3.11.0",{requires:["base-build","widget"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position",function(e,t){function d(e){}var n=e.Lang,r=e.Widget,i="xy",s="position",o="positioned",u="boundingBox",a="relative",f="renderUI",l="bindUI",c="syncUI",h=r.UI_SRC,p="xyChange";d.ATTRS={x:{setter:function(e){this._setX(e)},getter:function(){return this._getX()},lazyAdd:!1},y:{setter:function(e){this._setY(e)},getter:function(){return this._getY()},lazyAdd:!1},xy:{value:[0,0],validator:function(e){return this._validateXY(e)}}},d.POSITIONED_CLASS_NAME=r.getClassName(o),d.prototype={initializer:function(){this._posNode=this.get(u),e.after(this._renderUIPosition,this,f),e.after(this._syncUIPosition,this,c),e.after(this._bindUIPosition,this,l)},_renderUIPosition:function(){this._posNode.addClass(d.POSITIONED_CLASS_NAME)},_syncUIPosition:function(){var e=this._posNode;e.getStyle(s)===a&&this.syncXY(),this._uiSetXY(this.get(i))},_bindUIPosition:function(){this.after(p,this._afterXYChange)},move:function(){var e=arguments,t=n.isArray(e[0])?e[0]:[e[0],e[1]];this.set(i,t)},syncXY:function(){this.set(i,this._posNode.getXY(),{src:h})},_validateXY:function(e){return n.isArray(e)&&n.isNumber(e[0])&&n.isNumber(e[1])},_setX:function(e){this.set(i,[e,this.get(i)[1]])},_setY:function(e){this.set(i,[this.get(i)[0],e])},_getX:function(){return this.get(i)[0]},_getY:function(){return this.get(i)[1]},_afterXYChange:function(e){e.src!=h&&this._uiSetXY(e.newVal)},_uiSetXY:function(e){this._posNode.setXY(e)}},e.WidgetPosition=d},"3.11.0",{requires:["base-build","node-screen","widget"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-align",function(e,t){function c(e){}var n=e.Lang,r="align",i="alignOn",s="visible",o="boundingBox",u="offsetWidth",a="offsetHeight",f="region",l="viewportRegion";c.ATTRS={align:{value:null},centered:{setter:"_setAlignCenter",lazyAdd:!1,value:!1},alignOn:{value:[],validator:e.Lang.isArray}},c.TL="tl",c.TR="tr",c.BL="bl",c.BR="br",c.TC="tc",c.RC="rc",c.BC="bc",c.LC="lc",c.CC="cc",c.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionAlign is added"),e.after(this._bindUIPosAlign,this,"bindUI"),e.after(this._syncUIPosAlign,this,"syncUI")},_posAlignUIHandles:null,destructor:function(){this._detachPosAlignUIHandles()},_bindUIPosAlign:function(){this.after("alignChange",this._afterAlignChange),this.after("alignOnChange",this._afterAlignOnChange),this.after("visibleChange",this._syncUIPosAlign)},_syncUIPosAlign:function(){var e=this.get(r);this._uiSetVisiblePosAlign(this.get(s)),e&&this._uiSetAlign(e.node,e.points)},align:function(e,t){return arguments.length?this.set(r,{node:e,points:t}):this._syncUIPosAlign(),this},centered:function(e){return this.align(e,[c.CC,c.CC])},_setAlignCenter:function(e){return e&&this.set(r,{node:e===!0?null:e,points:[c.CC,c.CC]}),e},_uiSetAlign:function(t,r){if(!n.isArray(r)||r.length!==2){e.error("align: Invalid Points Arguments");return}var i=this._getRegion(t),s,o,u;if(!i)return;s=r[0],o=r[1];switch(o){case c.TL:u=[i.left,i.top];break;case c.TR:u=[i.right,i.top];break;case c.BL:u=[i.left,i.bottom];break;case c.BR:u=[i.right,i.bottom];break;case c.TC:u=[i.left+Math.floor(i.width/2),i.top];break;case c.BC:u=[i.left+Math.floor(i.width/2),i.bottom];break;case c.LC:u=[i.left,i.top+Math.floor(i.height/2)];break;case c.RC:u=[i.right,i.top+Math.floor(i.height/2)];break;case c.CC:u=[i.left+Math.floor(i.width/2),i.top+Math.floor(i.height/2)];break;default:}u&&this._doAlign(s,u[0],u[1])},_uiSetVisiblePosAlign:function(e){e?this._attachPosAlignUIHandles():this._detachPosAlignUIHandles()},_attachPosAlignUIHandles:function(){if(this._posAlignUIHandles)return;var t=this.get(o),n=e.bind(this._syncUIPosAlign,this),r=[];e.Array.each(this.get(i),function(i){var s=i.eventName,o=e.one(i.node)||t;s&&r.push(o.on(s,n))}),this._posAlignUIHandles=r},_detachPosAlignUIHandles:function(){var t=this._posAlignUIHandles;t&&((new e.EventHandle(t)).detach(),this._posAlignUIHandles=null)},_doAlign:function(e,t,n){var r=this._posNode,i;switch(e){case c.TL:i=[t,n];break;case c.TR:i=[t-r.get(u),n];break;case c.BL:i=[t,n-r.get(a)];break;case c.BR:i=[t-r.get(u),n-r.get(a)];break;case c.TC:i=[t-r.get(u)/2,n];break;case c.BC:i=[t-r.get(u)/2,n-r.get(a)];break;case c.LC:i=[t,n-r.get(a)/2];break;case c.RC:i=[t-r.get(u),n-r.get(a)/2];break;case c.CC:i=[t-r.get(u)/2,n-r.get(a)/2];break;default:}i&&this.move(i)},_getRegion:function(t){var n;return t?(t=e.Node.one(t),t&&(n=t.get(f))):n=this._posNode.get(l),n},_afterAlignChange:function(e){var t=e.newVal;t&&this._uiSetAlign(t.node,t.points)},_afterAlignOnChange:function(e){this._detachPosAlignUIHandles(),this.get(s)&&this._attachPosAlignUIHandles()}},e.WidgetPositionAlign=c},"3.11.0",{requires:["widget-position"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stack",function(e,t){function O(e){}var n=e.Lang,r=e.UA,i=e.Node,s=e.Widget,o="zIndex",u="shim",a="visible",f="boundingBox",l="renderUI",c="bindUI",h="syncUI",p="offsetWidth",d="offsetHeight",v="parentNode",m="firstChild",g="ownerDocument",y="width",b="height",w="px",E="shimdeferred",S="shimresize",x="visibleChange",T="widthChange",N="heightChange",C="shimChange",k="zIndexChange",L="contentUpdate",A="stacked";O.ATTRS={shim:{value:r.ie==6},zIndex:{value:0,setter:"_setZIndex"}},O.HTML_PARSER={zIndex:function(e){return this._parseZIndex(e)}},O.SHIM_CLASS_NAME=s.getClassName(u),O.STACKED_CLASS_NAME=s.getClassName(A),O.SHIM_TEMPLATE='<iframe class="'+O.SHIM_CLASS_NAME+'" frameborder="0" title="Widget Stacking Shim" src="javascript:false" tabindex="-1" role="presentation"></iframe>',O.prototype={initializer:function(){this._stackNode=this.get(f),this._stackHandles={},e.after(this._renderUIStack,this,l),e.after(this._syncUIStack,this,h),e.after(this._bindUIStack,this,c)},_syncUIStack:function(){this._uiSetShim(this.get(u)),this._uiSetZIndex(this.get(o))},_bindUIStack:function(){this.after(C,this._afterShimChange),this.after(k,this._afterZIndexChange)},_renderUIStack:function(){this._stackNode.addClass(O.STACKED_CLASS_NAME)},_parseZIndex:function(e){var t;return!e.inDoc()||e.getStyle("position")==="static"?t="auto":t=e.getComputedStyle("zIndex"),t==="auto"?null:t},_setZIndex:function(e){return n.isString(e)&&(e=parseInt(e,10)),n.isNumber(e)||(e=0),e},_afterShimChange:function(e){this._uiSetShim(e.newVal)},_afterZIndexChange:function(e){this._uiSetZIndex(e.newVal)},_uiSetZIndex:function(e){this._stackNode.setStyle(o,e)},_uiSetShim:function(e){e?(this.get(a)?this._renderShim():this._renderShimDeferred(),r.ie==6&&this._addShimResizeHandlers()):this._destroyShim()},_renderShimDeferred:function(){this._stackHandles[E]=this._stackHandles[E]||[];var e=this._stackHandles[E],t=function(e){e.newVal&&this._renderShim()};e.push(this.on(x,t))},_addShimResizeHandlers:function(){this._stackHandles[S]=this._stackHandles[S]||[];var e=this.sizeShim,t=this._stackHandles[S];t.push(this.after(x,e)),t.push(this.after(T,e)),t.push(this.after(N,e)),t.push(this.after(L,e))},_detachStackHandles:function(e){var t=this._stackHandles[e],n;if(t&&t.length>0)while(n=t.pop())n.detach()},_renderShim:function(){var e=this._shimNode,t=this._stackNode;e||(e=this._shimNode=this._getShimTemplate(),t.insertBefore(e,t.get(m)),this._detachStackHandles(E),this.sizeShim())},_destroyShim:function(){this._shimNode&&(this._shimNode.get(v).removeChild(this._shimNode),this._shimNode=null,this._detachStackHandles(E),this._detachStackHandles(S))},sizeShim:function(){var e=this._shimNode,t=this._stackNode;e&&r.ie===6&&this.get(a)&&(e.setStyle(y,t.get(p)+w),e.setStyle(b,t.get(d)+w))},_getShimTemplate:function(){return i.create(O.SHIM_TEMPLATE,this._stackNode.get(g))}},e.WidgetStack=O},"3.11.0",{requires:["base-build","widget"],skinnable:!0});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-constrain",function(e,t){function m(e){}var n="constrain",r="constrain|xyChange",i="constrainChange",s="preventOverlap",o="align",u="",a="bindUI",f="xy",l="x",c="y",h=e.Node,p="viewportRegion",d="region",v;m.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}},v=m._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}},m.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added"),e.after(this._bindUIPosConstrained,this,a)},getConstrainedXY:function(e,t){t=t||this.get(n);var r=this._getRegion(t===!0?null:t),i=this._posNode.get(d);return[this._constrain(e[0],l,i,r),this._constrain(e[1],c,i,r)]},constrain:function(e,t){var r,i,s=t||this.get(n);s&&(r=e||this.get(f),i=this.getConstrainedXY(r,s),(i[0]!==r[0]||i[1]!==r[1])&&this.set(f,i,{constrained:!0}))},_setConstrain:function(e){return e===!0?e:h.one(e)},_constrain:function(e,t,n,r){if(r){this.get(s)&&(e=this._preventOverlap(e,t,n,r));var i=t==l,o=i?r.width:r.height,u=i?n.width:n.height,a=i?r.left:r.top,f=i?r.right-u:r.bottom-u;if(e<a||e>f)u<o?e<a?e=a:e>f&&(e=f):e=a}return e},_preventOverlap:function(e,t,n,r){var i=this.get(o),s=t===l,a,f,c,h,p,d;return i&&i.points&&v[t][i.points.join(u)]&&(f=this._getRegion(i.node),f&&(a=s?n.width:n.height,c=s?f.left:f.top,h=s?f.right:f.bottom,p=s?f.left-r.left:f.top-r.top,d=s?r.right-f.right:r.bottom-f.bottom),e>c?d<a&&p>a&&(e=c-a):p<a&&d>a&&(e=h)),e},_bindUIPosConstrained:function(){this.after(i,this._afterConstrainChange),this._enableConstraints(this.get(n))},_afterConstrainChange:function(e){this._enableConstraints(e.newVal)},_enableConstraints:function(e){e?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on(r,this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(e){e.constrained||(e.newVal=this.getConstrainedXY(e.newVal))},_getRegion:function(e){var t;return e?(e=h.one(e),e&&(t=e.get(d))):t=this._posNode.get(p),t}},e.WidgetPositionConstrain=m},"3.11.0",{requires:["widget-position"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("overlay",function(e,t){e.Overlay=e.Base.create("overlay",e.Widget,[e.WidgetStdMod,e.WidgetPosition,e.WidgetStack,e.WidgetPositionAlign,e.WidgetPositionConstrain])},"3.11.0",{requires:["widget","widget-stdmod","widget-position","widget-position-align","widget-stack","widget-position-constrain"],skinnable:!0});
YUI.add("gallery-popover",function(Y){var VERTICALOFFSET=18,proto={initializer:function(){},bindUI:function(){this.after("arrowPositionChange",function(e){this._arrow.removeClass(this.getClassName("arrow",e.prevVal)),this._arrowMask.removeClass(this.getClassName("arrow","mask",e.prevVal)),this._arrow.addClass(this.getClassName("arrow",e.newVal)),this._arrowMask.addClass(this.getClassName("arrow","mask",e.newVal))})},renderUI:function(){this._arrow=Y.Node.create('<span class="'+this.getClassName("arrow")+'">◣</span>'),this._arrowMask=Y.Node.create('<span class="'+this.getClassName("arrow","mask")+'"></span>'),this.get("boundingBox").append(this._arrow).append(this._arrowMask);var arrowPosition=this.get("arrowPosition");this._arrow.addClass(this.getClassName("arrow",arrowPosition)),this._arrowMask.addClass(this.getClassName("arrow","mask",arrowPosition)),Y.UA.webkit&&"windows"===Y.UA.os?(this._arrow.addClass("win-webkit"),this._arrow.addClass(Y.UA.chrome?"win-chrome":"win-safari")):Y.UA.gecko&&"windows"===Y.UA.os&&(this._arrow.addClass("win-gecko"),this._arrow.addClass("win-firefox"),1.9<=Y.UA.gecko&&Y.UA.gecko<2&&this._arrow.addClass("win-firefox-3"))},syncUI:function(){},alignToElement:function(node,constrainNode){var alignmentPositions,offsets,nodeRegion,xy,constrainedXY,delta,arrow_x_new,arrowMask_x_new,arrow_y_new,arrowMask_y_new,arrowPosition=this.get("arrowPosition");switch(this.get("showSquare")&&(VERTICALOFFSET=8),arrowPosition){case"tl":alignmentPositions=[Y.WidgetPositionAlign.TL,Y.WidgetPositionAlign.BC],offsets={x:-28,y:VERTICALOFFSET};break;case"t":alignmentPositions=[Y.WidgetPositionAlign.TC,Y.WidgetPositionAlign.BC],offsets={x:0,y:VERTICALOFFSET};break;case"tr":alignmentPositions=[Y.WidgetPositionAlign.TR,Y.WidgetPositionAlign.BC],offsets={x:28,y:VERTICALOFFSET};break;case"rt":alignmentPositions=[Y.WidgetPositionAlign.TR,Y.WidgetPositionAlign.LC],offsets={x:-VERTICALOFFSET,y:-28};break;case"r":alignmentPositions=[Y.WidgetPositionAlign.RC,Y.WidgetPositionAlign.LC],offsets={x:-VERTICALOFFSET,y:0};break;case"rb":alignmentPositions=[Y.WidgetPositionAlign.BR,Y.WidgetPositionAlign.LC],offsets={x:-VERTICALOFFSET,y:28};break;case"br":alignmentPositions=[Y.WidgetPositionAlign.BR,Y.WidgetPositionAlign.TC],offsets={x:28,y:-VERTICALOFFSET};break;case"b":alignmentPositions=[Y.WidgetPositionAlign.BC,Y.WidgetPositionAlign.TC],offsets={x:0,y:-VERTICALOFFSET};break;case"bl":alignmentPositions=[Y.WidgetPositionAlign.BL,Y.WidgetPositionAlign.TC],offsets={x:-28,y:-VERTICALOFFSET};break;case"lb":alignmentPositions=[Y.WidgetPositionAlign.BL,Y.WidgetPositionAlign.RC],offsets={x:VERTICALOFFSET,y:28};break;case"l":alignmentPositions=[Y.WidgetPositionAlign.LC,Y.WidgetPositionAlign.RC],offsets={x:VERTICALOFFSET,y:0};break;case"lt":alignmentPositions=[Y.WidgetPositionAlign.TL,Y.WidgetPositionAlign.RC],offsets={x:VERTICALOFFSET,y:-28}}if(removePosition(this._arrow),removePosition(this._arrowMask),this.align(node,alignmentPositions),xy=[(nodeRegion=this._posNode.get("region")).left+offsets.x,nodeRegion.top+offsets.y],this.move(xy),constrainNode&&(this.constrain(null,constrainNode),constrainedXY=[(nodeRegion=this._posNode.get("region")).left,nodeRegion.top],"tl"===arrowPosition||"t"===arrowPosition||"tr"===arrowPosition||"bl"===arrowPosition||"b"===arrowPosition||"br"===arrowPosition?(xy[0]!==constrainedXY[0]&&(delta=xy[0]-constrainedXY[0],this._arrow.setX(this._arrow.getX()),this._arrow.setStyle("right","auto"),(arrow_x_new=this._arrow.getX()+delta)+27>nodeRegion.right?arrow_x_new=nodeRegion.right-27:arrow_x_new<nodeRegion.left&&(arrow_x_new=nodeRegion.left),this._arrow.setX(arrow_x_new),this._arrowMask.setX(this._arrowMask.getX()),this._arrowMask.setStyle("right","auto"),(arrowMask_x_new=this._arrowMask.getX()+delta)+50>nodeRegion.right?arrowMask_x_new=nodeRegion.right-50:arrowMask_x_new<nodeRegion.left&&(arrowMask_x_new=nodeRegion.left),this._arrowMask.setX(arrowMask_x_new)),xy[1]!==constrainedXY[1]&&(delta=xy[1]-constrainedXY[1],xy=[(nodeRegion=this._posNode.get("region")).left,nodeRegion.top+delta],this.move(xy))):"lt"!==arrowPosition&&"l"!==arrowPosition&&"lb"!==arrowPosition&&"rt"!==arrowPosition&&"r"!==arrowPosition&&"rb"!==arrowPosition||(xy[1]!==constrainedXY[1]&&(delta=xy[1]-constrainedXY[1],this._arrow.setY(this._arrow.getY()),this._arrow.setStyle("bottom","auto"),(arrow_y_new=this._arrow.getY()+delta)+27>nodeRegion.bottom?arrow_y_new=nodeRegion.bottom-27:arrow_y_new<nodeRegion.top&&(arrow_y_new=nodeRegion.top),this._arrow.setY(arrow_y_new),this._arrowMask.setY(this._arrowMask.getY()),this._arrowMask.setStyle("bottom","auto"),(arrowMask_y_new=this._arrowMask.getY()+delta)+50>nodeRegion.bottom?arrowMask_y_new=nodeRegion.bottom-50:arrowMask_y_new<nodeRegion.top&&(arrowMask_y_new=nodeRegion.top),this._arrowMask.setY(arrow_y_new)),xy[0]!==constrainedXY[0]&&(delta=xy[0]-constrainedXY[0],xy=[(nodeRegion=this._posNode.get("region")).left+delta,nodeRegion.top],this.move(xy)))),this._positionMarkerNode||(this._positionMarkerNode=Y.DOM.create('<div class="popover-position-marker"></div>'),Y.one("body").append(this._positionMarkerNode)),"br"===this.get("arrowPosition")&&this.get("accordian")&&(this.get("srcNode").getDOMNode().parentNode.style.bottom=""),Y.DOM.setXY(this._positionMarkerNode,this._posNode.get("region")),this.align(this._positionMarkerNode,[Y.WidgetPositionAlign.TL,Y.WidgetPositionAlign.BL]),"br"===this.get("arrowPosition")){this.get("isRefresh")&&this.get("refreshBottom")&&this.get("refreshRight")?function(popover){!function(){var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)},menuPopover=popover.get("srcNode").getDOMNode().parentNode;menuPopover.style.display="none",requestAnimFrame(function(){menuPopover.style.top="",menuPopover.style.left="",menuPopover.style.bottom=popover.get("refreshBottom"),menuPopover.style.right=popover.get("refreshRight"),requestAnimFrame(function(){menuPopover.style.display="block"})})}()}(this):function(popover){!function(){var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)},menuPopover=popover.get("srcNode").getDOMNode().parentNode;requestAnimFrame(function(){if(!menuPopover.style.bottom){var currTop=function(val){return parseInt(val.replace("px",""),10)}(menuPopover.style.top);310,menuPopover.style.bottom=-1*currTop-310+"px"}requestAnimFrame(function(){menuPopover.style.top=""})})}()}(this)}this.get("extraCSS")&&this.get("srcNode").ancestor(".yui3-popover").addClass(this.get("extraCSS"))}},statik={TOPLEFT:"tl",TOP:"t",TOPRIGHT:"tr",RIGHTTOP:"rt",RIGHT:"r",RIGHTBOTTOM:"rb",BOTTOMRIGHT:"br",BOTTOM:"b",BOTTOMLEFT:"bl",LEFTBOTTOM:"lb",LEFT:"l",LEFTTOP:"lt",CSS_PREFIX:"yui3-popover",ATTRS:{arrowPosition:{value:"tr",validator:function(val){return"tl"===val||"t"===val||"tr"===val||"bl"===val||"b"===val||"br"===val||"lt"===val||"l"===val||"lb"===val||"rt"===val||"r"===val||"rb"===val}},accordian:{value:!1,validator:function(val){return"boolean"==typeof val}},isRefresh:{value:!1},refreshBottom:{value:null},refreshRight:{value:null},extraCSS:{value:""},showSquare:{value:!1}}};function removePosition(node){node.setStyle("top","").setStyle("right","").setStyle("bottom","").setStyle("left","")}Y.Popover=Y.Base.create("popover",Y.Widget,[Y.WidgetStdMod,Y.WidgetPosition,Y.WidgetStack,Y.WidgetPositionAlign,Y.WidgetPositionConstrain],proto,statik)},"0.0.1",{requires:F.config.modules["gallery-popover"].requires||[],optional:F.config.modules["gallery-popover"].optional||[]});YUI.add("menus",function(Y){var registry={};function Menu(config){Menu.superclass.constructor.apply(this,arguments)}Y.menus={add:function(config){return registry[config.id]=new Menu(config),registry[config.id]},hide:function(){Y.fire("flickr-menus:hide")}},Menu.NAME="Menu",Menu.ATTRS={id:{value:""},popover:{},context:{},button_node:{},constrain_node:{},open_on_hover:{value:!1},hide_delay:{},scroll:{value:!1},button_evt_listeners:{},click_to_hide_handle:{},escape_key_listener:{},use_touch_events:{value:"ontouchstart"in document.documentElement},show_timer:{},hide_timer:{},hidden_prop:{value:""},onHide:{}},Y.extend(Menu,Y.Base,{initializer:function(config){this.set("scroll",config.scroll),this.set("id",config.id),this.set("popover",config.popover),this.set("context",config.context),config.button_node instanceof Y.Node?this.set("button_node",config.button_node):(config.button_node=void 0,delete config.button_node),config.constrain_node instanceof Y.Node?this.set("constrain_node",config.constrain_node):(config.constrain_node=void 0,delete config.constrain_node),Y.on("flickr-menus:hide",function(e){"source:nav-selecta-container"!==e&&this.hide()},this),this.attachWindowHideHandler(),this.attachButtonActionHandler(),this.after("button_nodeChange",this.attachButtonActionHandler,this)},show:function(){if(this.get("popover").get("visible"))return!1;this.get("button_node")&&this.get("button_node").addClass("ActiveButt"),Y.fire("flickr-menus:hide"),this.get("button_node")&&this.get("popover").alignToElement(this.get("button_node"),this.get("constrain_node")||Y.one("#main")),this.get("popover").show(),Y.PageContext.set(this.get("context")),Y.later(20,this,function(){var click_to_hide_handle,escape_key_listener;this.get("click_to_hide_handle")||(click_to_hide_handle=Y.one("body").on(this.get("use_touch_events")?"touchstart":"click",function(e){!this.get("popover").get("boundingBox").contains(e.target)&&e.target.ancestor("body",!0)&&this.hide()},this),this.set("click_to_hide_handle",click_to_hide_handle)),this.get("escape_key_listener")||(escape_key_listener=Y.keyboardShortcutManager.register({keystring:"27",handler:function(e){this.hide()},context:this.get("context"),scope:this}),this.set("escape_key_listener",escape_key_listener))}),this.get("scroll")&&Y.one("#"+this.get("id")).vis.animScrollIntoView(!0,40,!0),Y.fire("menus:show")},hide:function(){if(!this.get("popover").get("visible"))return!1;this.get("button_node")&&this.get("button_node").removeClass("ActiveButt"),this.get("popover").hide(),Y.PageContext.unset(this.get("context")),this.get("escape_key_listener")&&(this.get("escape_key_listener").detach(),this.set("escape_key_listener",void 0)),this.get("click_to_hide_handle")&&(this.get("click_to_hide_handle").detach(),this.set("click_to_hide_handle",void 0)),Y.fire("menus:hide"),"function"==typeof this.get("onHide")&&this.get("onHide")()},toggle:function(){this.get("popover").get("visible")?this.hide():this.show()},attachButtonActionHandler:function(){var listeners,i,click_toggler,hover_toggler,new_evt_listeners=[];if(this.get("button_evt_listeners")){for(i=(listeners=this.get("button_evt_listeners")).length-1;0<=i;i--)listeners[i].detach();this.set("button_evt_listeners",[])}this.get("open_on_hover")?(hover_toggler=function(e){if(!e.currentTarget.hasClass("DisabledButt")){if("mouseenter"===e.type&&e.currentTarget.hasClass("open")){var focusedElt=Y.focusTracker.get();"BODY"!==focusedElt.getDOMNode().tagName&&(focusedElt.blur(),this.show())}"mouseenter"!==e.type?("touchstart"===e.type&&e.stopImmediatePropagation(),"mousemove"!==e.type||e.currentTarget.hasClass("open")?"focus"===e.type&&document[this.get("hidden_prop")]||e.currentTarget.hasClass("open")&&"mouseleave"!==e.type&&"blur"!==e.type||(this.toggle(),e.halt()):this.show()):this.show()}},new_evt_listeners.push(this.get("button_node").on("focus",hover_toggler,this)),new_evt_listeners.push(this.get("button_node").on("blur",hover_toggler,this)),this.get("use_touch_events")&&new_evt_listeners.push(this.get("button_node").on("touchstart",hover_toggler,this)),new_evt_listeners.push(this.get("button_node").on("mouseenter",hover_toggler,this)),new_evt_listeners.push(this.get("button_node").on("mouseleave",hover_toggler,this)),new_evt_listeners.push(this.get("button_node").once("mousemove",hover_toggler,this))):(click_toggler=function(e){if(e.preventDefault(),!e.currentTarget.hasClass("DisabledButt")){this.toggle();try{e.currentTarget.blur()}catch(it_was_the_worst_of_times){}}},new_evt_listeners.push(this.get("button_node").on("click",click_toggler,this))),this.set("button_evt_listeners",new_evt_listeners)},attachWindowHideHandler:function(){void 0!==document.hidden?this.set("hidden_prop","hidden"):void 0!==document.mozHidden?this.set("hidden_prop","mozHidden"):void 0!==document.msHidden?this.set("hidden_prop","msHidden"):void 0!==document.webkitHidden&&this.set("hidden_prop","webkitHidden")}})},"0.0.1",{requires:F.config.modules.menus.requires||[],optional:F.config.modules.menus.optional||[]});YUI.add("share-menu-transjax",function(b){b.transjax.add("share-menu",{menu_fragment_error:"Sorry, there was a problem loading the sharing menu.",services_fragment_error:"Sorry, we couldn't find any services for you to share with.",grab_the_link_fragment_error:"There was an error",share_blog_no_blogs:"Sorry, we couldn't find any blogs for your account.",share_blog_choose_blog:"Choose a blog below:",sharing_email_error:"Oops! That doesn't look like a real email address. Try again?",sharing_no_contact:"Hmm... we couldn't find %s in your contacts list. Do you want to try entering their email address instead?",sharing_no_member:"Hmm... we couldn't find %s on Flickr. Do you want to try entering their email address instead?",uber_contact_list_default_text:"screen name, real name, or email",uber_contact_list_max_results:"Showing [results_shown] of [total_results] results. <a href='[url]'>See all...</a>",uber_contact_list_no_realname:"No real name given",generating_guest_pass_msg:"Generating Guest Pass...",sharing_initial_instructions:"Enter email addresses or a contact's screen name",sharing_instructions_one_added:"1 recipient so far... add another?",sharing_instructions_many_added:"%s recipients so far... add another?",sharing_msg_over_limit:"Please limit your message to %s characters or fewer.",spam_url_warning:"Hey! A URL or phrase that you tried to post has been used for abuse on Flickr before. (ex. SPAM) If that's you, stop it! If that's not you, sorry, but you can't post it.",spam_share_warning:"Slow down, partner! To protect the Flickr community against spam, we place a few restrictions on new accounts. You can read more about these restrictions in <a href='/help/website/#870679'>this FAQ</a>.",status_sending_msg:"Sending message..."})},"0.0.1",{requires:["transjax-base"]});YUI.add("flanal",function(Y){Y.flanal=function(key,title,config){var endpoint="/flanal_event.gne?target="+key+"&title="+title+("value"in(config=config||{})?"&value="+config.value:"")+("units"in config?"&units="+config.units:"")+"&rand="+Math.random();config.sync?Y.use("io",function(Y){Y.io(endpoint,{sync:!0})}):(new Image).src=endpoint,Y.log(key+" ("+title+")","info","flanal")}},"0.0.1",{requires:F.config.modules.flanal.requires||[],optional:F.config.modules.flanal.optional||[]});YUI.add("share-this-v3-dialog-transjax",function(a){a.transjax.add("share-this-v3-dialog",{try_again_later:"D'oh! That didn't work. Please try again later.",following_flickr_waiting:"Following...",following_flickr_success:"Awesome, you're following <a href='http://twitter.com/Flickr' target='_blank'>@Flickr</a>!"})},"0.0.1",{requires:["transjax-base"]});/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("array-extras",function(e,t){var n=e.Array,r=e.Lang,i=Array.prototype;n.lastIndexOf=r._isNative(i.lastIndexOf)?function(e,t,n){return n||n===0?e.lastIndexOf(t,n):e.lastIndexOf(t)}:function(e,t,n){var r=e.length,i=r-1;if(n||n===0)i=Math.min(n<0?r+n:n,r);if(i>-1&&r>0)for(;i>-1;--i)if(i in e&&e[i]===t)return i;return-1},n.unique=function(e,t){var n=0,r=e.length,i=[],s,o,u,a;e:for(;n<r;n++){a=e[n];for(s=0,u=i.length;s<u;s++){o=i[s];if(t){if(t.call(e,a,o,n,e))continue e}else if(a===o)continue e}i.push(a)}return i},n.filter=r._isNative(i.filter)?function(e,t,n){return i.filter.call(e,t,n)}:function(e,t,n){var r=0,i=e.length,s=[],o;for(;r<i;++r)r in e&&(o=e[r],t.call(n,o,r,e)&&s.push(o));return s},n.reject=function(e,t,r){return n.filter(e,function(e,n,i){return!t.call(r,e,n,i)})},n.every=r._isNative(i.every)?function(e,t,n){return i.every.call(e,t,n)}:function(e,t,n){for(var r=0,i=e.length;r<i;++r)if(r in e&&!t.call(n,e[r],r,e))return!1;return!0},n.map=r._isNative(i.map)?function(e,t,n){return i.map.call(e,t,n)}:function(e,t,n){var r=0,s=e.length,o=i.concat.call(e);for(;r<s;++r)r in e&&(o[r]=t.call(n,e[r],r,e));return o},n.reduce=r._isNative(i.reduce)?function(e,t,n,r){return i.reduce.call(e,function(e,t,i,s){return n.call(r,e,t,i,s)},t)}:function(e,t,n,r){var i=0,s=e.length,o=t;for(;i<s;++i)i in e&&(o=n.call(r,o,e[i],i,e));return o},n.find=function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(r in e&&t.call(n,e[r],r,e))return e[r];return null},n.grep=function(e,t){return n.filter(e,function(e,n){return t.test(e)})},n.partition=function(e,t,r){var i={matches:[],rejects:[]};return n.each(e,function(n,s){var u=t.call(r,n,s,e)?i.matches:i.rejects;u.push(n)}),i},n.zip=function(e,t){var r=[];return n.each(e,function(e,n){r.push([e,t[n]])}),r},n.flatten=function(e){var t=[],i,s,o;if(!e)return t;for(i=0,s=e.length;i<s;++i)o=e[i],r.isArray(o)?t.push.apply(t,n.flatten(o)):t.push(o);return t}},"3.11.0",{requires:["yui-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("autocomplete-base",function(e,t){function T(){}var n=e.Escape,r=e.Lang,i=e.Array,s=e.Object,o=r.isFunction,u=r.isString,a=r.trim,f=e.Attribute.INVALID_VALUE,l="_functionValidator",c="_sourceSuccess",h="allowBrowserAutocomplete",p="inputNode",d="query",v="queryDelimiter",m="requestTemplate",g="results",y="resultListLocator",b="value",w="valueChange",E="clear",S=d,x=g;T.prototype={initializer:function(){e.before(this._bindUIACBase,this,"bindUI"),e.before(this._syncUIACBase,this,"syncUI"),this.publish(E,{defaultFn:this._defClearFn}),this.publish(S,{defaultFn:this._defQueryFn}),this.publish(x,{defaultFn:this._defResultsFn})},destructor:function(){this._acBaseEvents&&this._acBaseEvents.detach(),delete this._acBaseEvents,delete this._cache,delete this._inputNode,delete this._rawSource},clearCache:function(){return this._cache&&(this._cache={}),this},sendRequest:function(t,n){var r,i=this.get("source");return t||t===""?this._set(d,t):t=this.get(d)||"",i&&(n||(n=this.get(m)),r=n?n.call(this,t):t,i.sendRequest({query:t,request:r,callback:{success:e.bind(this._onResponse,this,t)}})),this},_bindUIACBase:function(){var t=this.get(p),n=t&&t.tokenInput;n&&(t=n.get(p),this._set("tokenInput",n));if(!t){e.error("No inputNode specified.");return}this._inputNode=t,this._acBaseEvents=new e.EventHandle([t.on(w,this._onInputValueChange,this),t.on("blur",this._onInputBlur,this),this.after(h+"Change",this._syncBrowserAutocomplete),this.after("sourceTypeChange",this._afterSourceTypeChange),this.after(w,this._afterValueChange)])},_syncUIACBase:function(){this._syncBrowserAutocomplete(),this.set(b,this.get(p).get(b))},_createArraySource:function(e){var t=this;return{type:"array",sendRequest:function(n){t[c](e.concat(),n)}}},_createFunctionSource:function(e){var t=this;return{type:"function",sendRequest:function(n){function i(e){t[c](e||[],n)}var r;(r=e(n.query,i))&&i(r)}}},_createObjectSource:function(e){var t=this;return{type:"object",sendRequest:function(n){var r=n.query;t[c](s.owns(e,r)?e[r]:[],n)}}},_functionValidator:function(e){return e===null||o(e)},_getObjectValue:function(e,t){if(!e)return;for(var n=0,r=t.length;e&&n<r;n++)e=e[t[n]];return e},_parseResponse:function(e,t,r){var i={data:r,query:e,results:[]},s=this.get(y),o=[],u=t&&t.results,a,f,l,c,h,p,d,v,m,g,b;u&&s&&(u=s.call(this,u));if(u&&u.length){a=this.get("resultFilters"),b=this.get("resultTextLocator");for(p=0,d=u.length;p<d;++p)m=u[p],g=b?b.call(this,m):m.toString(),o.push({display:n.html(g),raw:m,text:g});for(p=0,d=a.length;p<d;++p){o=a[p].call(this,e,o.concat());if(!o)return;if(!o.length)break}if(o.length){l=this.get("resultFormatter"),h=this.get("resultHighlighter"),v=this.get("maxResults"),v&&v>0&&o.length>v&&(o.length=v);if(h){c=h.call(this,e,o.concat());if(!c)return;for(p=0,d=c.length;p<d;++p)m=o[p],m.highlighted=c[p],m.display=m.highlighted}if(l){f=l.call(this,e,o.concat());if(!f)return;for(p=0,d=f.length;p<d;++p)o[p].display=f[p]}}}i.results=o,this.fire(x,i)},_parseValue:function(e){var t=this.get(v);return t&&(e=e.split(t),e=e[e.length-1]),r.trimLeft(e)},_setEnableCache:function(e){this._cache=e?{}:null},_setLocator:function(e){if(this[l](e))return e;var t=this;return e=e.toString().split("."),function(n){return n&&t._getObjectValue(n,e)}},_setRequestTemplate:function(e){return this[l](e)?e:(e=e.toString(),function(t){return r.sub(e,{query:encodeURIComponent(t)})})},_setResultFilters:function(t){var n,s;return t===null?[]:(n=e.AutoCompleteFilters,s=function(e){return o(e)?e:u(e)&&n&&o(n[e])?n[e]:!1},r.isArray(t)?(t=i.map(t,s),i.every(t,function(e){return!!e})?t:f):(t=s(t),t?[t]:f))},_setResultHighlighter:function(t){var n;return this[l](t)?t:(n=e.AutoCompleteHighlighters,u(t)&&n&&o(n[t])?n[t]:f)},_setSource:function(t){var n=this.get("sourceType")||r.type(t),i;return t&&o(t.sendRequest)||t===null||n==="datasource"?(this._rawSource=t,t):(i=T.SOURCE_TYPES[n])?(this._rawSource=t,r.isString(i)?this[i](t):i(t)):(e.error("Unsupported source type '"+n+"'. Maybe autocomplete-sources isn't loaded?"),f)},_sourceSuccess:function(e,t){t.callback.success({data:e,response:{results:e}})},_syncBrowserAutocomplete:function(){var e=this.get(p);e.get("nodeName").toLowerCase()==="input"&&e.setAttribute("autocomplete",this.get(h)?"on":"off")},_updateValue:function(e){var t=this.get(v),n,s,o;e=r.trimLeft(e),t&&(n=a(t),o=i.map(a(this.get(b)).split(t),a),s=o.length,s>1&&(o[s-1]=e,e=o.join(n+" ")),e=e+n+" "),this.set(b,e)},_afterSourceTypeChange:function(e){this._rawSource&&this.set("source",this._rawSource)},_afterValueChange:function(e){var t=e.newVal,n=this,r=e.src===T.UI_SRC,i,s,o,u;r||n._inputNode.set(b,t),o=n.get("minQueryLength"),u=n._parseValue(t)||"",o>=0&&u.length>=o?r?(i=n.get("queryDelay"),s=function(){n.fire(S,{inputValue:t,query:u,src:e.src})},i?(clearTimeout(n._delay),n._delay=setTimeout(s,i)):s()):n._set(d,u):(clearTimeout(n._delay),n.fire(E,{prevVal:e.prevVal?n._parseValue(e.prevVal):null,src:e.src}))},_onInputBlur:function(e){var t=this.get(v),n,i,s;if(t&&!this.get("allowTrailingDelimiter")){t=r.trimRight(t),s=i=this._inputNode.get(b);if(t)while((i=r.trimRight(i))&&(n=i.length-t.length)&&i.lastIndexOf(t)===n)i=i.substring(0,n);else i=r.trimRight(i);i!==s&&this.set(b,i)}},_onInputValueChange:function(e){var t=e.newVal;t!==this.get(b)&&this.set(b,t,{src:T.UI_SRC})},_onResponse:function(e,t){e===(this.get(d)||"")&&this._parseResponse(e||"",t.response,t.data)},_defClearFn:function(){this._set(d,null),this._set(g,[])},_defQueryFn:function(e){this.sendRequest(e.query)},_defResultsFn:function(e){this._set(g,e[g])}},T.ATTRS={allowBrowserAutocomplete:{value:!1},allowTrailingDelimiter:{value:!1},enableCache:{lazyAdd:!1,setter:"_setEnableCache",value:!0},inputNode:{setter:e.one,writeOnce:"initOnly"},maxResults:{value:0},minQueryLength:{value:1},query:{readOnly:!0,value:null},queryDelay:{value:100},queryDelimiter:{value:null},requestTemplate:{setter:"_setRequestTemplate",value:null},resultFilters:{setter:"_setResultFilters",value:[]},resultFormatter
:{validator:l,value:null},resultHighlighter:{setter:"_setResultHighlighter",value:null},resultListLocator:{setter:"_setLocator",value:null},results:{readOnly:!0,value:[]},resultTextLocator:{setter:"_setLocator",value:null},source:{setter:"_setSource",value:null},sourceType:{value:null},tokenInput:{readOnly:!0},value:{value:""}},T._buildCfg={aggregates:["SOURCE_TYPES"],statics:["UI_SRC"]},T.SOURCE_TYPES={array:"_createArraySource","function":"_createFunctionSource",object:"_createObjectSource"},T.UI_SRC=e.Widget&&e.Widget.UI_SRC||"ui",e.AutoCompleteBase=T},"3.11.0",{optional:["autocomplete-sources"],requires:["array-extras","base-build","escape","event-valuechange","node-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("autocomplete-sources",function(e,t){var n=e.AutoCompleteBase,r=e.Lang,i="_sourceSuccess",s="maxResults",o="requestTemplate",u="resultListLocator";e.mix(n.prototype,{_YQL_SOURCE_REGEX:/^(?:select|set|use)\s+/i,_beforeCreateObjectSource:function(t){return t instanceof e.Node&&t.get("nodeName").toLowerCase()==="select"?this._createSelectSource(t):e.JSONPRequest&&t instanceof e.JSONPRequest?this._createJSONPSource(t):this._createObjectSource(t)},_createIOSource:function(t){function a(n){var o=n.request;if(r._cache&&o in r._cache){r[i](r._cache[o],n);return}s&&s.isInProgress()&&s.abort(),s=e.io(r._getXHRUrl(t,n),{on:{success:function(t,s){var u;try{u=e.JSON.parse(s.responseText)}catch(a){e.error("JSON parse error",a)}u&&(r._cache&&(r._cache[o]=u),r[i](u,n))}}})}var n={type:"io"},r=this,s,o,u;return n.sendRequest=function(t){o=t;if(u)return;u=!0,e.use("io-base","json-parse",function(){n.sendRequest=a,a(o)})},n},_createJSONPSource:function(t){function u(e){var n=e.request,s=e.query;if(r._cache&&n in r._cache){r[i](r._cache[n],e);return}t._config.on.success=function(t){r._cache&&(r._cache[n]=t),r[i](t,e)},t.send(s)}var n={type:"jsonp"},r=this,s,o;return n.sendRequest=function(i){s=i;if(o)return;o=!0,e.use("jsonp",function(){t instanceof e.JSONPRequest||(t=new e.JSONPRequest(t,{format:e.bind(r._jsonpFormatter,r)})),n.sendRequest=u,u(s)})},n},_createSelectSource:function(e){var t=this;return{type:"select",sendRequest:function(n){var r=[];e.get("options").each(function(e){r.push({html:e.get("innerHTML"),index:e.get("index"),node:e,selected:e.get("selected"),text:e.get("text"),value:e.get("value")})}),t[i](r,n)}}},_createStringSource:function(e){return this._YQL_SOURCE_REGEX.test(e)?this._createYQLSource(e):e.indexOf("{callback}")!==-1?this._createJSONPSource(e):this._createIOSource(e)},_createYQLSource:function(t){function c(o){var u=o.query,a=n.get("yqlEnv"),f=n.get(s),c,h,p;p=r.sub(t,{maxResults:f>0?f:1e3,request:o.request,query:u});if(n._cache&&p in n._cache){n[i](n._cache[p],o);return}c=function(e){n._cache&&(n._cache[p]=e),n[i](e,o)},h={proto:n.get("yqlProtocol")},l?(l._callback=c,l._opts=h,l._params.q=p,a&&(l._params.env=a)):l=new e.YQLRequest(p,{on:{success:c},allowCache:!1},a?{env:a}:null,h),l.send()}var n=this,o={type:"yql"},a,f,l;return n.get(u)||n.set(u,n._defaultYQLLocator),o.sendRequest=function(t){a=t,f||(f=!0,e.use("yql",function(){o.sendRequest=c,c(a)}))},o},_defaultYQLLocator:function(t){var n=t&&t.query&&t.query.results,i;return n&&r.isObject(n)?(i=e.Object.values(n)||[],n=i.length===1?i[0]:i,r.isArray(n)||(n=[n])):n=[],n},_getXHRUrl:function(e,t){var n=this.get(s);return t.query!==t.request&&(e+=t.request),r.sub(e,{maxResults:n>0?n:1e3,query:encodeURIComponent(t.query)})},_jsonpFormatter:function(e,t,n){var i=this.get(s),u=this.get(o);return u&&(e+=u(n)),r.sub(e,{callback:t,maxResults:i>0?i:1e3,query:encodeURIComponent(n)})}}),e.mix(n.ATTRS,{yqlEnv:{value:null},yqlProtocol:{value:"http"}}),e.mix(n.SOURCE_TYPES,{io:"_createIOSource",jsonp:"_createJSONPSource",object:"_beforeCreateObjectSource",select:"_createSelectSource",string:"_createStringSource",yql:"_createYQLSource"},!0)},"3.11.0",{optional:["io-base","json-parse","jsonp","yql"],requires:["autocomplete-base"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("lang/autocomplete-list_en",function(e){e.Intl.add("autocomplete-list","en",{item_selected:"{item} selected.",items_available:"Suggestions are available. Use up and down arrows to select."})},"3.11.0");
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("selector-css2",function(e,t){var n="parentNode",r="tagName",i="attributes",s="combinator",o="pseudos",u=e.Selector,a={_reRegExpTokens:/([\^\$\?\[\]\*\+\-\.\(\)\|\\])/,SORT_RESULTS:!0,_isXML:function(){var t=e.config.doc.createElement("div").tagName!=="DIV";return t}(),shorthand:{"\\#(-?[_a-z0-9]+[-\\w\\uE000]*)":"[id=$1]","\\.(-?[_a-z]+[-\\w\\uE000]*)":"[className~=$1]"},operators:{"":function(t,n){return e.DOM.getAttribute(t,n)!==""},"~=":"(?:^|\\s+){val}(?:\\s+|$)","|=":"^{val}-?"},pseudos:{"first-child":function(t){return e.DOM._children(t[n])[0]===t}},_bruteQuery:function(t,n,r){var i=[],s=[],o,a=u._tokenize(t),f=a[a.length-1],l=e.DOM._getDoc(n),c,h,p,d,v;if(f){h=f.id,p=f.className,d=f.tagName||"*";if(n.getElementsByTagName)h&&(n.all||n.nodeType===9||e.DOM.inDoc(n))?s=e.DOM.allById(h,n):p?s=n.getElementsByClassName(p):s=n.getElementsByTagName(d);else{o=[],c=n.firstChild,v=d==="*";while(c){while(c)c.tagName>"@"&&(v||c.tagName===d)&&s.push(c),o.push(c),c=c.firstChild;while(o.length>0&&!c)c=o.pop().nextSibling}}s.length&&(i=u._filterNodes(s,a,r))}return i},_filterNodes:function(t,n,r){var i=0,s,o=n.length,a=o-1,f=[],l=t[0],c=l,h=e.Selector.getters,p,d,v,m,g,y,b,w;for(i=0;c=l=t[i++];){a=o-1,m=null;e:while(c&&c.tagName){v=n[a],b=v.tests,s=b.length;if(s&&!g)while(w=b[--s]){p=w[1],h[w[0]]?y=h[w[0]](c,w[0]):(y=c[w[0]],w[0]==="tagName"&&!u._isXML&&(y=y.toUpperCase()),typeof y!="string"&&y!==undefined&&y.toString?y=y.toString():y===undefined&&c.getAttribute&&(y=c.getAttribute(w[0],2)));if(p==="="&&y!==w[2]||typeof p!="string"&&p.test&&!p.test(y)||!p.test&&typeof p=="function"&&!p(c,w[0],w[2])){if(c=c[m])while(c&&(!c.tagName||v.tagName&&v.tagName!==c.tagName))c=c[m];continue e}}a--;if(!!g||!(d=v.combinator)){f.push(l);if(r)return f;break}m=d.axis,c=c[m];while(c&&!c.tagName)c=c[m];d.direct&&(m=null)}}return l=c=null,f},combinators:{" ":{axis:"parentNode"},">":{axis:"parentNode",direct:!0},"+":{axis:"previousSibling",direct:!0}},_parsers:[{name:i,re:/^\uE003(-?[a-z]+[\w\-]*)+([~\|\^\$\*!=]=?)?['"]?([^\uE004'"]*)['"]?\uE004/i,fn:function(t,n){var r=t[2]||"",i=u.operators,s=t[3]?t[3].replace(/\\/g,""):"",o;if(t[1]==="id"&&r==="="||t[1]==="className"&&e.config.doc.documentElement.getElementsByClassName&&(r==="~="||r==="="))n.prefilter=t[1],t[3]=s,n[t[1]]=t[1]==="id"?t[3]:s;r in i&&(o=i[r],typeof o=="string"&&(t[3]=s.replace(u._reRegExpTokens,"\\$1"),o=new RegExp(o.replace("{val}",t[3]))),t[2]=o);if(!n.last||n.prefilter!==t[1])return t.slice(1)}},{name:r,re:/^((?:-?[_a-z]+[\w-]*)|\*)/i,fn:function(e,t){var n=e[1];u._isXML||(n=n.toUpperCase()),t.tagName=n;if(n!=="*"&&(!t.last||t.prefilter))return[r,"=",n];t.prefilter||(t.prefilter="tagName")}},{name:s,re:/^\s*([>+~]|\s)\s*/,fn:function(e,t){}},{name:o,re:/^:([\-\w]+)(?:\uE005['"]?([^\uE005]*)['"]?\uE006)*/i,fn:function(e,t){var n=u[o][e[1]];return n?(e[2]&&(e[2]=e[2].replace(/\\/g,"")),[e[2],n]):!1}}],_getToken:function(e){return{tagName:null,id:null,className:null,attributes:{},combinator:null,tests:[]}},_tokenize:function(t){t=t||"",t=u._parseSelector(e.Lang.trim(t));var n=u._getToken(),r=t,i=[],o=!1,a,f,l,c;e:do{o=!1;for(l=0;c=u._parsers[l++];)if(a=c.re.exec(t)){c.name!==s&&(n.selector=t),t=t.replace(a[0],""),t.length||(n.last=!0),u._attrFilters[a[1]]&&(a[1]=u._attrFilters[a[1]]),f=c.fn(a,n);if(f===!1){o=!1;break e}f&&n.tests.push(f);if(!t.length||c.name===s)i.push(n),n=u._getToken(n),c.name===s&&(n.combinator=e.Selector.combinators[a[1]]);o=!0}}while(o&&t.length);if(!o||t.length)i=[];return i},_replaceMarkers:function(e){return e=e.replace(/\[/g,"\ue003"),e=e.replace(/\]/g,"\ue004"),e=e.replace(/\(/g,"\ue005"),e=e.replace(/\)/g,"\ue006"),e},_replaceShorthand:function(t){var n=e.Selector.shorthand,r;for(r in n)n.hasOwnProperty(r)&&(t=t.replace(new RegExp(r,"gi"),n[r]));return t},_parseSelector:function(t){var n=e.Selector._replaceSelector(t),t=n.selector;return t=e.Selector._replaceShorthand(t),t=e.Selector._restore("attr",t,n.attrs),t=e.Selector._restore("pseudo",t,n.pseudos),t=e.Selector._replaceMarkers(t),t=e.Selector._restore("esc",t,n.esc),t},_attrFilters:{"class":"className","for":"htmlFor"},getters:{href:function(t,n){return e.DOM.getAttribute(t,n)},id:function(t,n){return e.DOM.getId(t)}}};e.mix(e.Selector,a,!0),e.Selector.getters.src=e.Selector.getters.rel=e.Selector.getters.href,e.Selector.useNative&&e.config.doc.querySelector&&(e.Selector.shorthand["\\.(-?[_a-z]+[-\\w]*)"]="[class~=$1]")},"3.11.0",{requires:["selector-native"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("selector-css3",function(e,t){e.Selector._reNth=/^(?:([\-]?\d*)(n){1}|(odd|even)$)*([\-+]?\d*)$/,e.Selector._getNth=function(t,n,r,i){e.Selector._reNth.test(n);var s=parseInt(RegExp.$1,10),o=RegExp.$2,u=RegExp.$3,a=parseInt(RegExp.$4,10)||0,f=[],l=e.DOM._children(t.parentNode,r),c;u?(s=2,c="+",o="n",a=u==="odd"?1:0):isNaN(s)&&(s=o?1:0);if(s===0)return i&&(a=l.length-a+1),l[a-1]===t?!0:!1;s<0&&(i=!!i,s=Math.abs(s));if(!i){for(var h=a-1,p=l.length;h<p;h+=s)if(h>=0&&l[h]===t)return!0}else for(var h=l.length-a,p=l.length;h>=0;h-=s)if(h<p&&l[h]===t)return!0;return!1},e.mix(e.Selector.pseudos,{root:function(e){return e===e.ownerDocument.documentElement},"nth-child":function(t,n){return e.Selector._getNth(t,n)},"nth-last-child":function(t,n){return e.Selector._getNth(t,n,null,!0)},"nth-of-type":function(t,n){return e.Selector._getNth(t,n,t.tagName)},"nth-last-of-type":function(t,n){return e.Selector._getNth(t,n,t.tagName,!0)},"last-child":function(t){var n=e.DOM._children(t.parentNode);return n[n.length-1]===t},"first-of-type":function(t){return e.DOM._children(t.parentNode,t.tagName)[0]===t},"last-of-type":function(t){var n=e.DOM._children(t.parentNode,t.tagName);return n[n.length-1]===t},"only-child":function(t){var n=e.DOM._children(t.parentNode);return n.length===1&&n[0]===t},"only-of-type":function(t){var n=e.DOM._children(t.parentNode,t.tagName);return n.length===1&&n[0]===t},empty:function(e){return e.childNodes.length===0},not:function(t,n){return!e.Selector.test(t,n)},contains:function(e,t){var n=e.innerText||e.textContent||"";return n.indexOf(t)>-1},checked:function(e){return e.checked===!0||e.selected===!0},enabled:function(e){return e.disabled!==undefined&&!e.disabled},disabled:function(e){return e.disabled}}),e.mix(e.Selector.operators,{"^=":"^{val}","$=":"{val}$","*=":"{val}"}),e.Selector.combinators["~"]={axis:"previousSibling"}},"3.11.0",{requires:["selector-native","selector-css2"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("shim-plugin",function(e,t){function n(e){this.init(e)}n.CLASS_NAME="yui-node-shim",n.TEMPLATE='<iframe class="'+n.CLASS_NAME+'" frameborder="0" title="Node Stacking Shim"'+'src="javascript:false" tabindex="-1" role="presentation"'+'style="position:absolute; z-index:-1;"></iframe>',n.prototype={init:function(e){this._host=e.host,this.initEvents(),this.insert(),this.sync()},initEvents:function(){this._resizeHandle=this._host.on("resize",this.sync,this)},getShim:function(){return this._shim||(this._shim=e.Node.create(n.TEMPLATE,this._host.get("ownerDocument")))},insert:function(){var e=this._host;this._shim=e.insertBefore(this.getShim(),e.get("firstChild"))},sync:function(){var e=this._shim,t=this._host;e&&e.setAttrs({width:t.getStyle("width"),height:t.getStyle("height")})},destroy:function(){var e=this._shim;e&&e.remove(!0),this._resizeHandle.detach()}},n.NAME="Shim",n.NS="shim",e.namespace("Plugin"),e.Plugin.Shim=n},"3.11.0",{requires:["node-style","node-pluginhost"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("autocomplete-list",function(e,t){var n=e.Lang,r=e.Node,i=e.Array,s=e.UA.ie&&e.UA.ie<7,o=9,u="_CLASS_ITEM",a="_CLASS_ITEM_ACTIVE",f="_CLASS_ITEM_HOVER",l="_SELECTOR_ITEM",c="activeItem",h="alwaysShowList",p="circular",d="hoveredItem",v="id",m="item",g="list",y="result",b="results",w="visible",E="width",S="select",x=e.Base.create("autocompleteList",e.Widget,[e.AutoCompleteBase,e.WidgetPosition,e.WidgetPositionAlign],{ARIA_TEMPLATE:"<div/>",ITEM_TEMPLATE:"<li/>",LIST_TEMPLATE:"<ul/>",UI_EVENTS:function(){var t=e.merge(e.Node.DOM_EVENTS);return delete t.valuechange,delete t.valueChange,t}(),initializer:function(){var t=this.get("inputNode");if(!t){e.error("No inputNode specified.");return}this._inputNode=t,this._listEvents=[],this.DEF_PARENT_NODE=t.get("parentNode"),this[u]=this.getClassName(m),this[a]=this.getClassName(m,"active"),this[f]=this.getClassName(m,"hover"),this[l]="."+this[u],this.publish(S,{defaultFn:this._defSelectFn})},destructor:function(){while(this._listEvents.length)this._listEvents.pop().detach();this._ariaNode&&this._ariaNode.remove().destroy(!0)},bindUI:function(){this._bindInput(),this._bindList()},renderUI:function(){var t=this._createAriaNode(),n=this.get("boundingBox"),r=this.get("contentBox"),i=this._inputNode,o=this._createListNode(),u=i.get("parentNode");i.addClass(this.getClassName("input")).setAttrs({"aria-autocomplete":g,"aria-expanded":!1,"aria-owns":o.get("id")}),u.append(t),s&&n.plug(e.Plugin.Shim),this._ariaNode=t,this._boundingBox=n,this._contentBox=r,this._listNode=o,this._parentNode=u},syncUI:function(){this._syncResults(),this._syncVisibility()},hide:function(){return this.get(h)?this:this.set(w,!1)},selectItem:function(e,t){if(e){if(!e.hasClass(this[u]))return this}else{e=this.get(c);if(!e)return this}return this.fire(S,{itemNode:e,originEvent:t||null,result:e.getData(y)}),this},_activateNextItem:function(){var e=this.get(c),t;return e?t=e.next(this[l])||(this.get(p)?null:e):t=this._getFirstItemNode(),this.set(c,t),this},_activatePrevItem:function(){var e=this.get(c),t=e?e.previous(this[l]):this.get(p)&&this._getLastItemNode();return this.set(c,t||null),this},_add:function(t){var r=[];return i.each(n.isArray(t)?t:[t],function(e){r.push(this._createItemNode(e).setData(y,e))},this),r=e.all(r),this._listNode.append(r.toFrag()),r},_ariaSay:function(e,t){var r=this.get("strings."+e);this._ariaNode.set("text",t?n.sub(r,t):r)},_bindInput:function(){var e=this._inputNode,t,n,r;this.get("align")===null&&(r=this.get("tokenInput"),t=r&&r.get("boundingBox")||e,this.set("align",{node:t,points:["tl","bl"]}),!this.get(E)&&(n=t.get("offsetWidth"))&&this.set(E,n)),this._listEvents=this._listEvents.concat([e.after("blur",this._afterListInputBlur,this),e.after("focus",this._afterListInputFocus,this)])},_bindList:function(){this._listEvents=this._listEvents.concat([e.one("doc").after("click",this._afterDocClick,this),e.one("win").after("windowresize",this._syncPosition,this),this.after({mouseover:this._afterMouseOver,mouseout:this._afterMouseOut,activeItemChange:this._afterActiveItemChange,alwaysShowListChange:this._afterAlwaysShowListChange,hoveredItemChange:this._afterHoveredItemChange,resultsChange:this._afterResultsChange,visibleChange:this._afterVisibleChange}),this._listNode.delegate("click",this._onItemClick,this[l],this)])},_clear:function(){this.set(c,null),this._set(d,null),this._listNode.get("children").remove(!0)},_createAriaNode:function(){var e=r.create(this.ARIA_TEMPLATE);return e.addClass(this.getClassName("aria")).setAttrs({"aria-live":"polite",role:"status"})},_createItemNode:function(t){var n=r.create(this.ITEM_TEMPLATE);return n.addClass(this[u]).setAttrs({id:e.stamp(n),role:"option"}).setAttribute("data-text",t.text).append(t.display)},_createListNode:function(){var t=this.get("listNode")||r.create(this.LIST_TEMPLATE);return t.addClass(this.getClassName(g)).setAttrs({id:e.stamp(t),role:"listbox"}),this._set("listNode",t),this.get("contentBox").append(t),t},_getFirstItemNode:function(){return this._listNode.one(this[l])},_getLastItemNode:function(){return this._listNode.one(this[l]+":last-child")},_syncPosition:function(){this._syncUIPosAlign(),this._syncShim()},_syncResults:function(e){e||(e=this.get(b)),this._clear(),e.length&&(this._add(e),this._ariaSay("items_available")),this._syncPosition(),this.get("activateFirstItem")&&!this.get(c)&&this.set(c,this._getFirstItemNode())},_syncShim:s?function(){var e=this._boundingBox.shim;e&&e.sync()}:function(){},_syncVisibility:function(t){this.get(h)&&(t=!0,this.set(w,t)),typeof t=="undefined"&&(t=this.get(w)),this._inputNode.set("aria-expanded",t),this._boundingBox.set("aria-hidden",!t),t?this._syncPosition():(this.set(c,null),this._set(d,null),this._boundingBox.get("offsetWidth")),e.UA.ie===7&&e.one("body").addClass("yui3-ie7-sucks").removeClass("yui3-ie7-sucks")},_afterActiveItemChange:function(t){var n=this._inputNode,r=t.newVal,i=t.prevVal,s;i&&i._node&&i.removeClass(this[a]),r?(r.addClass(this[a]),n.set("aria-activedescendant",r.get(v))):n.removeAttribute("aria-activedescendant"),this.get("scrollIntoView")&&(s=r||n,(!s.inRegion(e.DOM.viewportRegion(),!0)||!s.inRegion(this._contentBox,!0))&&s.scrollIntoView())},_afterAlwaysShowListChange:function(e){this.set(w,e.newVal||this.get(b).length>0)},_afterDocClick:function(e){var t=this._boundingBox,n=e.target;n!==this._inputNode&&n!==t&&n.ancestor("#"+t.get("id"),!0)&&this.hide()},_afterHoveredItemChange:function(e){var t=e.newVal,n=e.prevVal;n&&n.removeClass(this[f]),t&&t.addClass(this[f])},_afterListInputBlur:function(){this._listInputFocused=!1,this.get(w)&&!this._mouseOverList&&(this._lastInputKey!==o||!this.get("tabSelect")||!this.get(c))&&this.hide()},_afterListInputFocus:function(){this._listInputFocused=!0},_afterMouseOver:function(e){var t=e.domEvent.target.ancestor(this[l],!0);this._mouseOverList=!0,t&&this._set(d,t)},_afterMouseOut:function(){this._mouseOverList=!1,this._set(d,null)},_afterResultsChange:function(e){this._syncResults(e.newVal
),this.get(h)||this.set(w,!!e.newVal.length)},_afterVisibleChange:function(e){this._syncVisibility(!!e.newVal)},_onItemClick:function(e){var t=e.currentTarget;this.set(c,t),this.selectItem(t,e)},_defSelectFn:function(e){var t=e.result.text;this._inputNode.focus(),this._updateValue(t),this._ariaSay("item_selected",{item:t}),this.hide()}},{ATTRS:{activateFirstItem:{value:!1},activeItem:{setter:e.one,value:null},alwaysShowList:{value:!1},circular:{value:!0},hoveredItem:{readOnly:!0,value:null},listNode:{writeOnce:"initOnly",value:null},scrollIntoView:{value:!1},strings:{valueFn:function(){return e.Intl.get("autocomplete-list")}},tabSelect:{value:!0},visible:{value:!1}},CSS_PREFIX:e.ClassNameManager.getClassName("aclist")});e.AutoCompleteList=x,e.AutoComplete=x},"3.11.0",{lang:["en","es","hu","it"],requires:["autocomplete-base","event-resize","node-screen","selector-css3","shim-plugin","widget","widget-position","widget-position-align"],skinnable:!0});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("autocomplete-list-keys",function(e,t){function u(){e.before(this._bindKeys,this,"bindUI"),this._initKeys()}var n=40,r=13,i=27,s=9,o=38;u.prototype={_initKeys:function(){var e={},t={};e[n]=this._keyDown,t[r]=this._keyEnter,t[i]=this._keyEsc,t[s]=this._keyTab,t[o]=this._keyUp,this._keys=e,this._keysVisible=t},destructor:function(){this._unbindKeys()},_bindKeys:function(){this._keyEvents=this._inputNode.on("keydown",this._onInputKey,this)},_unbindKeys:function(){this._keyEvents&&this._keyEvents.detach(),this._keyEvents=null},_keyDown:function(){this.get("visible")?this._activateNextItem():this.show()},_keyEnter:function(e){var t=this.get("activeItem");if(!t)return!1;this.selectItem(t,e)},_keyEsc:function(){this.hide()},_keyTab:function(e){var t;if(this.get("tabSelect")){t=this.get("activeItem");if(t)return this.selectItem(t,e),!0}return!1},_keyUp:function(){this._activatePrevItem()},_onInputKey:function(e){var t,n=e.keyCode;this._lastInputKey=n,this.get("results").length&&(t=this._keys[n],!t&&this.get("visible")&&(t=this._keysVisible[n]),t&&t.call(this,e)!==!1&&e.preventDefault())}},e.Base.mix(e.AutoCompleteList,[u])},"3.11.0",{requires:["autocomplete-list","base-build"]});
/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("autocomplete-plugin",function(e,t){function r(e){e.inputNode=e.host,!e.render&&e.render!==!1&&(e.render=!0),r.superclass.constructor.apply(this,arguments)}var n=e.Plugin;e.extend(r,e.AutoCompleteList,{},{NAME:"autocompleteListPlugin",NS:"ac",CSS_PREFIX:e.ClassNameManager.getClassName("aclist")}),n.AutoComplete=r,n.AutoCompleteList=r},"3.11.0",{requires:["autocomplete-list","node-pluginhost"]});
YUI.add("bo-selecta-transjax",function(a){a.transjax.add("bo-selecta",{me:"me",loading:"Loading...",uber_contact_list_view_profile:"View Profile",uber_contact_list_friend_and_family:"Friend &amp; Family",uber_contact_list_friend:"Friend",uber_contact_list_family:"Family",uber_contact_list_contact:"Contact",uber_contact_list_removed:"Removed",uber_contact_list_edit:"Edit",uber_contact_list_default_text:"screen name, real name, or email",uber_contact_list_max_results:'Showing [results_shown] of [total_results] results. <a href="[url]">See all...</a>',uber_contact_list_no_realname:"No real name given",bo_selecta_no_contacts_found:"No contacts found.",bo_selecta_no_members_found:"No members found.",bo_selecta_global_search_msg:"Search through all Flickr members?",bo_selecta_global_search_msg_2:"Search all Flickr members?",too_many_results:"We found too many results to display here. Please type a few more characters."})},"0.0.1",{requires:["transjax-base"]});/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datasource-local",function(e,t){var n=e.Lang,r=function(){r.superclass.constructor.apply(this,arguments)};e.mix(r,{NAME:"dataSourceLocal",ATTRS:{source:{value:null}},_tId:0,transactions:{},issueCallback:function(e,t){var n=e.on||e.callback,r=n&&n.success,i=e.details[0];i.error=e.error||e.response.error,i.error&&(t.fire("error",i),r=n&&n.failure),r&&r(i)}}),e.extend(r,e.Base,{initializer:function(e){this._initEvents()},_initEvents:function(){this.publish("request",{defaultFn:e.bind("_defRequestFn",this),queuable:!0}),this.publish("data",{defaultFn:e.bind("_defDataFn",this),queuable:!0}),this.publish("response",{defaultFn:e.bind("_defResponseFn",this),queuable:!0})},_defRequestFn:function(e){var t=this.get("source"),r=e.details[0];n.isUndefined(t)&&(r.error=new Error("Local source undefined")),r.data=t,this.fire("data",r)},_defDataFn:function(e){var t=e.data,r=e.meta,i={results:n.isArray(t)?t:[t],meta:r?r:{}},s=e.details[0];s.response=i,this.fire("response",s)},_defResponseFn:function(e){r.issueCallback(e,this)},sendRequest:function(e){var t=r._tId++,n;return e=e||{},n=e.on||e.callback,this.fire("request",{tId:t,request:e.request,on:n,callback:n,cfg:e.cfg||{}}),t}}),e.namespace("DataSource").Local=r},"3.11.0",{requires:["base"]});
YUI.add("bo-selecta-global-search-datasource",function(Y){Y.BoSelectaGlobalSearchDataSource=function(attr){Y.BoSelectaGlobalSearchDataSource.superclass.constructor.apply(this,arguments),this.request=null,this.selector=attr.selector},Y.extend(Y.BoSelectaGlobalSearchDataSource,Y.DataSource.Local,{_defRequestFn:function(e){var query,that=this;return this.request&&this.request.readyState<4&&this.request.abort(),this.selector.loadingBox.setStyle("display","block"),query=decodeURIComponent(e.request),this.request=Y.flickrAPI.callMethod("flickr.people.search",{username:query},{success:function(response,raw_response){var rsp=response.data;response.params;if(that.selector.searchingGlobally){for(var person,tempPerson,matches=[],people=rsp.people.person,n=0,len=people.length;n<len;n++)(person={n:(tempPerson=people[n]).nsid,e:tempPerson.email,u:tempPerson.username,r:tempPerson.realname,a:tempPerson.path_alias,d:tempPerson.friend,y:tempPerson.family,s:tempPerson.iconserver,f:tempPerson.iconfarm})[0]=tempPerson.name,person.i=person.f&&0!==person.f&&person.s&&0!==person.s?"http://farm"+person.f+".static"+(Y.config.flickr.dev?"-dev":"")+".flickr.com/"+person.s+"/buddyicons/"+person.n+".jpg":"http://www.flickr.com/images/buddyicon.gif",matches.push(person);if(0===matches.length&&(that.selector.hideNoContactMessage||matches.push({message:Y.transjax.get("bo-selecta","bo_selecta_no_members_found"),disableActive:!0}),0<that.selector.zeroResultsMessages.length)){var msg;for(n=0,len=that.selector.zeroResultsMessages.length;n<len;n++)(msg=that.selector.zeroResultsMessages[n]).validator(that.selector)&&matches.push(msg)}that.selector.loadingBox.setStyle("display","none"),that.fire("data",Y.mix({data:matches},e))}else that.selector.loadingBox.setStyle("display","none")},failure:function(response,raw_response){response.data,response.params;var matches=[];matches.push({message:Y.transjax.get("bo-selecta","too_many_results"),totalResultsMessage:!0}),that.selector.loadingBox.setStyle("display","none"),that.fire("data",Y.mix({data:matches},e))}}),e.tId}})},"0.0.1",{requires:["bo-selecta-transjax","datasource-local","gallery-flickr-api"]});/*
YUI 3.11.0 (build d549e5c)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datasource-function",function(e,t){var n=e.Lang,r=function(){r.superclass.constructor.apply(this,arguments)};e.mix(r,{NAME:"dataSourceFunction",ATTRS:{source:{validator:n.isFunction}}}),e.extend(r,e.DataSource.Local,{_defRequestFn:function(e){var t=this.get("source"),n=e.details[0];if(t)try{n.data=t(e.request,this,e)}catch(r){n.error=r}else n.error=new Error("Function data failure");return this.fire("data",n),e.tId}}),e.DataSource.Function=r},"3.11.0",{requires:["datasource-local"]});
YUI.add("image-fader",function(Y){Y.imageFader={attach:function(nodes,target_opacity){target_opacity=Y.Lang.isNumber(target_opacity)?target_opacity:1,Y.Lang.isString(nodes)&&(nodes=Y.all(nodes)),nodes.on("load",function(e){e.target.inDoc()&&new Y.Anim({node:e.target,to:{opacity:target_opacity},duration:.2}).run()})}}},"0.0.1",{requires:["node","anim"]});YUI.add("bo-selecta-3",function(Y){function highlightTerm(str,regex){return str?(str=Y.StringFilters.unescape_entities(str,!0),-1===(start_position=regex?str.search(regex):-1)?Y.BoSelecta3.sanitizeString(str):(end_position=start_position+str.match(regex)[0].length,Y.StringFilters.escape_entities(str.substring(0,start_position),!0)+'<span class="term-highlight">'+Y.StringFilters.escape_entities(str.substring(start_position,end_position),!0)+"</span>"+Y.StringFilters.escape_entities(str.substring(end_position,str.length),!0))):str;var start_position,end_position}Y.BoSelecta3=function(inputField,attr){attr=attr||{},this.showUsername=attr.showUsername||!0,this.showSubtitle=attr.showSubtitle||!1,this.showIcon=attr.showIcon||!1,this.showRelationship=attr.showRelationship||!1,this.usePersonMenu=attr.usePersonMenu||!1,this.linkUsernameToPhotostream=attr.linkUsernameToPhotostream||!1,this.linkSubtitle=attr.linkSubtitle||!1,this.showEditRelationshipLink=attr.showEditRelationshipLink||!1,this.searchOnUsername=attr.searchOnUsername||!0,this.searchOnRealname=attr.searchOnRealname||!1,this.searchOnEmail=attr.searchOnEmail||!1,this.searchOnPathAlias=attr.searchOnPathAlias||!1,this.searchUsingSoundex=attr.searchUsingSoundex||!1,this.includeUser=attr.includeUser||!1,this.includeAddressBook=attr.includeAddressBook||!1,this.maxResultsDisplayed=attr.maxResultsDisplayed||5,this.globalMaxResultsDisplayed=attr.globalMaxResultsDisplayed||10,this.showTotalResults=attr.showTotalResults||!1,this.disableMouseHover=attr.disableMouseHover||!1,this.selectFirstItem=attr.selectFirstItem||!1,this.hideNoContactMessage=attr.hideNoContactMessage||!1,this.zeroResultsMessages=attr.zeroResultsMessages||[],this.preloadText=attr.preloadText||"",this.defaultText=attr.defaultText||"",this.loadingText=attr.loadingText||Y.transjax.get("bo-selecta","loading"),this.focusOnFetch=attr.focusOnFetch||!1,this.fetchDataImmediately=attr.fetchDataImmediately||!1,this.allowNoContacts=attr.allowNoContacts||!1,this.allowFormSubmit=attr.allowFormSubmit||!1,this.respectCanTagFlag=attr.respectCanTagFlag||!1,this.apiURL=attr.apiURL||Y.config.flickr.people.api_url,this.enableGlobalSearch=attr.enableGlobalSearch||!1,this.defaultContainerWidth=attr.defaultContainerWidth||250,this.minListWidth=attr.minListWidth||228,this.maxListWidth=attr.maxListWidth||500,this.loadTransparently=attr.loadTransparently||!1,this.includeUser&&(this.meString=Y.transjax.get("bo-selecta","me").toLowerCase()),this.contacts=null,this.skipList={},this.shadowInit=!1,this.fetchingData=!1,this.haveTriedToFetchData=!1,this.searchingGlobally=!1,this._initHTML(inputField),this._initAutoComplete(),this.fetchDataImmediately&&this.fetchData()},Y.augment(Y.BoSelecta3,Y.EventTarget),Y.BoSelecta3.prototype._initHTML=function(inputField){Y.Lang.isString(inputField)&&(inputField=Y.one(inputField)),!inputField instanceof Y.Node&&(inputField=Y.one("#BoSelecta_input")),this.inputField=inputField,this.container=this.inputField.get("parentNode"),this.container.all(".no-js-fallback").setStyle("display","none"),this.container.addClass("bo-selecta-3"),this.container.addClass("yui-skin-sam"),this.containerId=Y.stamp(this.container),this.inputField.addClass("input");var loadingEls=this.container.all(".loading");0<loadingEls.size()?(this.loadingBox=loadingEls.item(0),this.loadingBox.setStyle("display",this.fetchDataImmediately&&!this.loadTransparently?"block":"none")):(this.loadingBox=Y.Node.create('<div class="loading">'+this.loadingText+"</div>"),this.loadingBox.setStyle("display",this.fetchDataImmediately&&!this.loadTransparently?"block":"none"),this.container.append(this.loadingBox)),this.inputField.set("disabled",!1),this.inputField.set("value",this.preloadText),this.inputField.addClass("grey"),this.inputField.on("focus",this.clearDefaultText,this,!0),this.inputField.on("blur",function(e){""===this.inputField.get("value")&&this.restoreDefaultText()},this,!0),this.allowFormSubmit||(this.form=this.container.ancestor("form",!0),this.form&&this.form.on("submit",function(e){e.halt()})),this.maxInputWidth=parseInt(this.container.getStyle("width"),10)||this.defaultContainerWidth,this.defaultInputWidth=parseInt(this.inputField.getStyle("width"),10)||this.defaultContainerWidth},Y.BoSelecta3.prototype._initAutoComplete=function(){var that=this;this.contactsCacheDataSource=new Y.DataSource.Function({source:function(q){return that._searchContacts(q)}}),this.globalSearchDataSource=new Y.BoSelectaGlobalSearchDataSource({selector:this}),this.autoComp=new Y.AutoComplete({inputNode:this.inputField,source:this.contactsCacheDataSource,resultTextLocator:function(result){return result&&result.u?Y.BoSelecta3.sanitizeString(result.u):""},resultFormatter:function(query,results,highlighted){return that._formatResult(query,results,highlighted)},activateFirstItem:this.selectFirstItem,queryDelay:0,render:!0}),this.autoComp.on("select",this._onItemSelectEvent,this,!0),this.autoComp.on("query",this._handleQueryChange,this,!0),this.autoComp.after("query",this._resizeListToFit,this,!0),this.inputField.on("keydown",this._onInputFieldKeyDown,this,!0),this.inputField.on("focus",function(e){var query=that.getQuery();query&&that.autoComp.sendRequest(query)}),this.inputField.on("blur",function(e){that.autoComp.get("visible")?that.resultsHideHandler||(that.resultsHideHandle=Y.one("document").on("click",function(e){e.target.ancestor(".yui3-aclist-item")||(Y.fire("BoSelecta:widgetBlur"),Y.fire("flickr-menus:hide"),that.resultsHideHandle.detach())})):Y.fire("BoSelecta:widgetBlur")}),Y.on("flickr-menus:hide",this.hideResults,this,!0)},Y.BoSelecta3.prototype._fetchData=function(){if(!this.fetchingData){this.fetchingData=!0,this.haveTriedToFetchData=!0,this.fire("BoSelecta:dataFetchStart"),this.loadTransparently||(this.inputField.setStyle("display","none"),this.loadingBox.setStyle("display","block"));var url=this.apiURL,that=this,callback={success:function(id,o,args){if("-1"!==o.responseText&&""!==o.responseText){var contactSplit,responseText=o.responseText.split("")[1];that.contacts=responseText.split("");for(var n=0,len=that.contacts.length;n<len;n++)0!==(contactSplit=that.contacts[n].split("")).length&&(that.contacts[n]={},that.contacts[n].n=contactSplit[0],that.contacts[n].e=contactSplit[1],that.contacts[n].u=contactSplit[2],that.contacts[n].r=contactSplit[3],that.contacts[n].s=contactSplit[4],that.contacts[n].f=contactSplit[5],that.contacts[n].a=contactSplit[6],that.contacts[n].d=contactSplit[7],that.contacts[n].y=contactSplit[8],that.contacts[n].c=contactSplit[9],that.contacts[n].us=Y.StringFilters.soundex(that.contacts[n].u),that.contacts[n].rs=Y.StringFilters.soundex(that.contacts[n].r),that.contacts[n][0]=that.contacts[n].u);that.loadTransparently||(that.restoreDefaultText(),that.loadingBox.setStyle("display","none"),that.inputField.setStyle("display","inline"),that.focusOnFetch&&that.clear(!0)),that.fetchingData=!1,that.fire("BoSelecta:dataFetchComplete")}else that.allowNoContacts?(that.contacts=[],that.loadTransparently||(that.restoreDefaultText(),that.loadingBox.setStyle("display","none"),that.inputField.setStyle("display","inline"),""!==that.inputField.get("value")&&!that.focusOnFetch||that.clear(!0)),that.fire("BoSelecta:dataFetchComplete")):callback.failure()},failure:function(id,o,args){that.autoComp.destroy(),that.form&&"form"===that.form.get("tagName").toLowerCase()&&Y.Event.purgeElement(that.form),that.inputField.get("parentNode").all(".no-js-fallback").setStyle("display",""),that._destroy(),that.fetchingData=!1,that.fire("BoSelecta:dataError")}};url?Y.io(url,{method:"GET",on:callback}):callback.failure()}},Y.BoSelecta3.prototype._destroy=function(removeInput){var container=this.inputField.get("parentNode");Y.Event.purgeElement(this.inputField),this.inputField.removeClass("grey"),this.inputField.removeClass("yui-ac-input"),this.inputField.set("value",""),this.inputField.setStyle("display",""),this.inputField.removeClass("input"),removeInput&&this.inputField.remove(),this.loadingBox.remove(),container.removeClass("yui-skin-sam"),container.removeClass("bo-selecta-3")},Y.BoSelecta3.prototype._searchContacts=function(query){var me,originalQuery,matches=[],that=this;if(""===query||query&&query===this.defaultText)return matches;if(query&&"string"==typeof query&&this.contacts){originalQuery=query,query=this._escapeForRegEx(query),query=Y.StringFilters.substitute_equivalent_chars(query);for(var contact,match,queryRegEx=new RegExp(query,"i"),querySoundex=Y.StringFilters.soundex(originalQuery),n=0,len=this.contacts.length;n<len;n++)match=!1,(contact=this.contacts[n]).matched=null,!contact.n||this.includeUser&&originalQuery!==this.meString||contact.n!==Y.config.flickr.user.nsid?this.skipList&&(this.skipList[contact.n]||this.skipList[contact.e])||(this.searchOnUsername&&contact.u&&-1!==contact.u.search(queryRegEx)&&(match=!0,contact.matched="username",contact.matchedPos=contact.u.search(queryRegEx)),!match&&this.searchOnRealname&&contact.r&&-1!==contact.r.search(queryRegEx)&&(match=!0,contact.matched="realname",contact.matchedPos=contact.r.search(queryRegEx)),!match&&this.searchOnEmail&&contact.e&&"@"!==query&&-1!==contact.e.search(queryRegEx)&&(match=!0,contact.matched="email",contact.matchedPos=contact.e.search(queryRegEx)),!match&&this.searchOnPathAlias&&contact.a&&-1!==contact.a.search(queryRegEx)&&(match=!0,contact.matched="path_alias",contact.matchedPos=contact.a.search(queryRegEx)),this.searchUsingSoundex&&(!match&&this.searchOnUsername&&contact.us&&Y.StringFilters.isEqualSoundex(contact.us,querySoundex)&&(match=!0,contact.matched="username-soundex",contact.matchedPos=contact.us===querySoundex?0:Y.StringFilters.isEqualSoundex(contact.us,querySoundex)),!match&&this.searchOnRealname&&contact.rs&&Y.StringFilters.isEqualSoundex(contact.rs,querySoundex)&&(match=!0,contact.matched="realname-soundex",contact.matchedPos=contact.rs===querySoundex?0:Y.StringFilters.isEqualSoundex(contact.rs,querySoundex))),match&&matches.push(contact)):originalQuery!==this.meString||this.skipList[contact.n]||(me=contact)}if(0!==matches.length||originalQuery===this.meString&&me){for(n=0,len=matches.length;n<len;n++)if(!matches[n].n&&!matches[n].u){var m=0;for(len=matches.length;m<len;m++)if(n!==m&&matches[n]&&matches[m]&&matches[n].e===matches[m].e){delete matches[n];break}}for(n=0,len=matches.length;n<len;)matches[n]?n++:(matches.splice(n,1),len--);var propertyToPositionMap={username:0,realname:1,email:2,path_alias:3,"username-soundex":4,"realname-soundex":5};matches.sort(function(a,b){var aType=a.n&&a.u?"contact":"addressBookEntry";if(aType!=(b.n&&b.u?"contact":"addressBookEntry"))return"contact"==aType?-1:1;if(a.matchedPos!==b.matchedPos)return a.matchedPos<b.matchedPos?-1:1;if(propertyToPositionMap[a.matched]!==propertyToPositionMap[b.matched])return propertyToPositionMap[a.matched]<propertyToPositionMap[b.matched]?-1:1;var au=a.u.charCodeAt(0),bu=b.u.charCodeAt(0);return au===bu?0:au<bu?-1:1}),originalQuery===this.meString&&me&&(me.matched="username",matches.unshift(me));var totalResults=matches.length;if(matches=matches.splice(0,this.maxResultsDisplayed),this.showTotalResults){matches.push({message:Y.transjax.get("bo-selecta","uber_contact_list_max_results").replace(/\[results_shown\]/,Math.min(matches.length,this.maxResultsDisplayed)).replace(/\[total_results\]/,totalResults).replace(/\[url\]/,"/search/people/?q=%s&m=names&see=all"),totalResultsMessage:!0})}}else if(this.hideNoContactMessage||(matches.push({message:Y.transjax.get("bo-selecta","bo_selecta_no_contacts_found"),notFoundLink:!0,disableActive:!0}),this.enableGlobalSearch&&matches.push({globalSearchLink:!0,query:originalQuery,message:Y.transjax.get("bo-selecta","bo_selecta_global_search_msg")})),0<this.zeroResultsMessages.length)for(var msg,n=0,len=this.zeroResultsMessages.length;n<len;n++)(msg=this.zeroResultsMessages[n]).validator(this)&&matches.push(msg);return this.showEditRelationshipLink&&!this.relationshipLinksInitialized&&Y.use("contact-changer",function(Y){that.container.delegate("click",function(e){Y.contact_changer.show(e.target.getAttribute("data-nsid")),e.preventDefault()},".edit-rel a"),that.relationshipLinksInitialized=!0}),matches},Y.BoSelecta3.prototype._formatResult=function(query,results,highlighted){var contact,messageHTML,buddyIconHTML,addressBookContactHTML,pClass,pathIdentifier,relationshipHTML,usernameHTML,subtitleHTML,contactEl,formatedResults=[],queryRegEx=query?new RegExp(Y.StringFilters.substitute_equivalent_chars(this._escapeForRegEx(query)),"gi"):null;query=query||"";for(var n=0,len=results.length;n<len;n++)(contact=results[n].raw)&&(contact.globalSearchLink?(messageHTML='<p class="bs-global-search-link bs-message bs-onclick"><span>'+contact.message+"</span></p>",formatedResults.push(messageHTML)):contact.totalResultsMessage?(messageHTML='<p class="bs-message bs-total-results bs-disable-active"><span>'+contact.message+"</span></p>",formatedResults.push(messageHTML)):contact.message?(messageHTML='<p class="bs-message'+(contact.notFoundLink?"":" bs-onclick")+(contact.disableActive?" bs-disable-active":"")+(contact.className?" "+contact.className:"")+'">'+contact.message+"</p>",formatedResults.push(messageHTML)):(pClass=this.respectCanTagFlag&&"0"===contact.c?' class="disabled"':"",!contact.e||contact.u||contact.n?(' / <a href="/people/'+(pathIdentifier=contact.a?contact.a:contact.n)+'/">'+Y.transjax.get("bo-selecta","uber_contact_list_view_profile")+"</a>",contact.i||(contact.i=contact.f&&0!==contact.f&&contact.s&&0!==contact.s?"http://farm"+contact.f+".static"+(Y.config.flickr.dev?"-dev":"")+".flickr.com/"+contact.s+"/buddyicons/"+contact.n+".jpg":"http://www.flickr.com/images/buddyicon.gif"),F.config.flickr.is_secure&&(contact.i=contact.i.replace("http:","https:")),relationshipHTML="",this.showRelationship&&("1"===contact.d&&"1"===contact.y?relationshipHTML+=Y.transjax.get("bo-selecta","uber_contact_list_friend_and_family"):"1"===contact.d?relationshipHTML+=Y.transjax.get("bo-selecta","uber_contact_list_friend"):"1"===contact.y?relationshipHTML+=Y.transjax.get("bo-selecta","uber_contact_list_family"):"1"===contact.removed?relationshipHTML+='<em class="contact-removed">'+Y.transjax.get("bo-selecta","uber_contact_list_removed")+"</em>":this.searchingGlobally?relationshipHTML+="":relationshipHTML+=Y.transjax.get("bo-selecta","uber_contact_list_contact"),this.showEditRelationshipLink&&!this.searchingGlobally&&(relationshipHTML+=' <span class="edit-rel">(<a href="/people/'+pathIdentifier+'/relationship/" data-nsid="'+contact.n+'">'+Y.transjax.get("bo-selecta","uber_contact_list_edit")+"</a>)</span>")),buddyIconHTML=this.showIcon?'<img src="'+contact.i+'" width="24" height="24" class="BuddyIconX fade-in" nsid="'+contact.n+'">':"",buddyIconHTML=this.linkUsernameToPhotostream?'<a href="/photos/'+pathIdentifier+'/">'+buddyIconHTML+"</a>":buddyIconHTML,usernameHTML=this.showUsername?highlightTerm(this._sanitizeString(contact.u),queryRegEx):"",usernameHTML=this.linkUsernameToPhotostream?'<strong class="username"><a href="/photos/'+pathIdentifier+'/">'+usernameHTML+"</a></strong>":'<strong class="username">'+usernameHTML+"</strong>",subtitleHTML="",this.showSubtitle&&(contact.matched&&"realname"!==contact.matched&&"realname-soundex"!==contact.matched?"username"===contact.matched||"username-soundex"===contact.matched?subtitleHTML=contact.r?this._sanitizeString(contact.r):Y.transjax.get("bo-selecta","uber_contact_list_no_realname"):"email"===contact.matched?subtitleHTML=highlightTerm(this._sanitizeString(contact.e),queryRegEx):"path_alias"===contact.matched&&contact.a&&(subtitleHTML="flickr.com/people/"+highlightTerm(this._sanitizeString(contact.a),queryRegEx)+"/"):subtitleHTML=contact.r?highlightTerm(this._sanitizeString(contact.r),queryRegEx):Y.transjax.get("bo-selecta","uber_contact_list_no_realname"),subtitleHTML=this.linkSubtitle?'<a title="'+Y.transjax.get("bo-selecta","uber_contact_list_view_profile")+'" href="/people/'+pathIdentifier+'/" class="realname">'+subtitleHTML+"</a>":'<span class="realname">'+subtitleHTML+"</span>"),contactEl=Y.Node.create('<p nsid="'+contact.n+'"'+pClass+'><span class="name">'+buddyIconHTML+usernameHTML+subtitleHTML+'</span><span class="relationship">'+relationshipHTML+"</span></p>"),Y.imageFader.attach(contactEl.all("img")),formatedResults.push(contactEl)):(contact.i||(contact.i="/images/icon_unread.gif"),buddyIconHTML=this.showIcon?'<img src="'+contact.i+'" width="16" height="16" class="BuddyIconX bs-email-icon">':"",addressBookContactHTML='<p email="'+contact.e+'"'+pClass+'><span class="name name-email">'+buddyIconHTML+'<strong class="username">'+highlightTerm(this._sanitizeString(contact.e),queryRegEx)+'</strong></span><span class="relationship"></span></p>',formatedResults.push(addressBookContactHTML))));return formatedResults},Y.BoSelecta3.prototype._resizeListToFit=function(e){var ac,nameNode,relationshipNode,badgeWidth,minWidth=this.minListWidth,maxWidth=this.maxListWidth;("autocompleteList:query"===e.type||"autocompleteList:visibleChange"===e.type&&!0===e.newVal)&&((ac=e.currentTarget).get("listNode").all("li p").each(function(node){nameNode=node.one(".name"),relationshipNode=node.one(".relationship"),nameNode&&relationshipNode&&(badgeWidth=nameNode.get("offsetWidth")+relationshipNode.get("offsetWidth")+12,minWidth<badgeWidth&&(minWidth=badgeWidth))}),this.baseListWidth||(this.baseListWidth=ac.get("width")),maxWidth<minWidth&&(minWidth=maxWidth),minWidth<this.baseListWidth&&(minWidth=this.baseListWidth),ac.set("width",minWidth))},Y.BoSelecta3.prototype._attachIconEvents=function(parent){if(personmenu_process_img&&"function"==typeof personmenu_process_img)for(var img,imgs=parent.all("img"),n=0,len=imgs.size();n<len;n++)img=Y.Node.getDOMNode(imgs.item(n)),imgs.item(n).hasClass("BuddyIconX")&&(img.nsid=imgs.item(n).getAttribute("nsid"),personmenu_process_img(img))},Y.BoSelecta3.prototype._useGlobalSearch=function(query){var that=this;this.searchingGlobally=!0,query&&this.inputField.set("value",decodeURIComponent(query)),this.autoComp.set("source",this.globalSearchDataSource),this.autoComp.set("minQueryLength",2),this.autoComp.set("maxResultsDisplayed",this.globalMaxResultsDisplayed),this.autoComp.set("queryDelay",600),this.loadingBox.addClass("loading-global").removeClass("loading"),this.loadingBox.set("innerHTML",""),this.globalSearchRemover=this.inputField.on("keyup",function(e){""===that.inputField.get("value")&&(that.globalSearchRemover.detach(),that._useContactsCache())}),query=this.getQuery(),this.autoComp.sendRequest(query)},Y.BoSelecta3.prototype._useContactsCache=function(query){this.searchingGlobally=!1,query&&this.inputField.set("value",decodeURIComponent(query)),this.autoComp.set("source",this.contactsCacheDataSource),this.autoComp.set("minQueryLength",1),this.autoComp.set("maxResultsDisplayed",0),this.autoComp.set("queryDelay",0)},Y.BoSelecta3.prototype._onItemSelectEvent=function(e,arg){var contact=e.result.raw;if(contact.message)return contact.globalSearchLink?this._useGlobalSearch(contact.query):contact.onclick&&"function"==typeof contact.onclick?contact.onclick(e,this):this.clear(),void e.preventDefault();this.fire("BoSelecta:resultSelect",contact,contact.query),this.searchingGlobally&&this._useContactsCache()},Y.BoSelecta3.prototype._handleQueryChange=function(e){this.fire("BoSelecta:queryChange",e.query)},Y.BoSelecta3.prototype._onInputFieldKeyDown=function(e){if(13===e.keyCode&&this.autoComp){var isMessage=!1;if(this.autoComp._oCurItem){var pEls=Y.one(this.autoComp._oCurItem).all("p");0<pEls.size()&&(isMessage=pEls.item(0).hasClass("bs-message")&&!pEls.item(0).hasClass("bs-onclick"))}this.autoComp._oCurItem&&!isMessage||this.fire("BoSelecta:inputEnter")}},Y.BoSelecta3.prototype._sanitizeString=function(str){return str=str.replace(/</g,"&lt;").replace(/>/g,"&gt;")},Y.BoSelecta3.prototype._unsanitizeString=function(str){return str=str.replace(/\&lt;/g,"<").replace(/\&gt;/g,">")},Y.BoSelecta3.prototype._escapeForRegEx=function(str){return str=(str=(str=decodeURIComponent(str)).replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\$/g,"\\$").replace(/\^/g,"\\^").replace(/\?/g,"\\?")).replace(/\|/g,"\\|").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]")},Y.BoSelecta3.prototype.fetchData=function(){this.contacts||this.haveTriedToFetchData||this._fetchData()},Y.BoSelecta3.prototype.refreshData=function(){this._fetchData()},Y.BoSelecta3.prototype.hideResults=function(){this.autoComp&&this.autoComp.hide&&this.autoComp.hide(),this.resultsHideHandle&&this.resultsHideHandle.detach&&this.resultsHideHandle.detach()},Y.BoSelecta3.prototype.clear=function(focus){if(this.inputField.removeClass("grey"),this.inputField.set("value",""),focus)try{this.inputField.focus()}catch(e){}this.hideResults()},Y.BoSelecta3.prototype.clearDefaultText=function(focus){this.inputField.hasClass("grey")&&this.clear(focus)},Y.BoSelecta3.prototype.restoreDefaultText=function(){this.clear(),this.inputField.addClass("grey"),this.inputField.set("value",this.defaultText),this.inputField.blur()},Y.BoSelecta3.prototype.getQuery=function(){return this.inputField.hasClass("grey")?"":this.inputField.get("value")},Y.BoSelecta3.prototype.refreshResults=function(){this.autoComp&&this.getQuery()&&this.autoComp.sendRequest(this.getQuery())},Y.BoSelecta3.prototype.skipContact=function(contact){this.skipList[contact.n?contact.n:contact.e]=!0},Y.BoSelecta3.prototype.unskipContact=function(contact){this.skipList[contact.n?contact.n:contact.e]=!1},Y.BoSelecta3.prototype.unskipAll=function(){this.skipList={}},Y.BoSelecta3.prototype.showInFieldLoading=function(){this.loadingBox.addClass("loading-global"),this.loadingBox.removeClass("loading"),this.loadingBox.setStyle("display","block")},Y.BoSelecta3.prototype.hideInFieldLoading=function(){this.loadingBox.setStyle("display","")},Y.BoSelecta3.prototype.destroy=function(){this._destroy(!0)},Y.BoSelecta3.sanitizeString=Y.BoSelecta3.prototype._sanitizeString,Y.BoSelecta3.unsanitizeString=Y.BoSelecta3.prototype._unsanitizeString},"0.0.1",{requires:F.config.modules["bo-selecta-3"].requires||[],optional:F.config.modules["bo-selecta-3"].optional||[]});YUI.add("share-this-v3-service-email-transjax",function(a){a.transjax.add("share-this-v3-service-email",{email_field_default_text:"screen name, real name, or email",send_an_email:"Send an email to this address",no_realname:"No real name given",sharing_email_error:"Oops! That doesn't look like a real email address. Try again?",sharing_no_contact:"Hmm... we couldn't find %s in your contacts list. Do you want to try entering their email address instead?"})},"0.0.1",{requires:["transjax-base"]});YUI.add("share-this-v3-service-twitter-transjax",function(a){a.transjax.add("share-this-v3-service-twitter",{over_limit_1:"%s whoa!",over_limit_5:"%s too much!",over_limit_10:"%s less is more!",over_limit_20:"%s way over!",over_limit_30:"%s booooring!"})},"0.0.1",{requires:["transjax-base"]});YUI.add("share-this-v3-services",function(Y){var services={};Y.shareThisV3Services={add_service:function(service_obj){services[service_obj.name]=service_obj},get_services:function(){return services},get_service:function(service_type_id){var service,found;for(service in services)if(services.hasOwnProperty(service)&&services[service].id===service_type_id){found=!0;break}return found?services[service]:void 0}}},"0.0.1",{requires:[]});YUI.add("share-this-v3-service-blogger",function(Y){var share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"blogger",id:3,setup_url:"/share.gne?action=setup&service_type_id=3",use_popup:!0,popup_params:{width:780,height:480},default_text:null,on_window_closed:function(){var service_obj=Y.shareThisV3Dialog.get_current_service();Y.log("auth (maybe) complete for "+service_obj.name),Y.shareThisV3Dialog.fetch_sharing_fragment({on_complete:function(){Y.shareThisV3Dialog.refresh_dialog_state(),Y.fire("shareDialog:servicesAuthComplete")}})},on_show_screen:{setup:function(){Y.log("blogger: setup screen")},setup_choose_a_blog:function(){Y.log("blogger: setup_choose_a_blog()")},share:function(){Y.log("blogger: share screen");var service_obj=Y.shareThisV3Dialog.get_current_service(),helpers=Y.shareThisV3Dialog.service_helpers;Y.global_dialog.show();var textarea=Y.one("#blogger-text");service_obj.default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",Y.shareThisV3Dialog.service_helpers.maybeClearText),textarea.on("blur",Y.shareThisV3Dialog.service_helpers.maybeRestoreText),helpers.addDescriptionEvents(Y.one("#share-this-v3-dialog .add-object-description"),textarea)},share_confirmblog:function(){Y.log("share_confirmblog()"),Y.global_dialog.show()}},on_auth_failed:function(){Y.log("on_auth_failed"),set_dialog_state("state-setup state-setup-error"),Y.global_dialog.reposition()},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#blogger-text")})},share_chooseblog:function(){Y.global_dialog.hide(),Y.global_dialog.set_loading(!0)}},misc:{maybe_highlight_endpoint:function(e){var o=e.target,txt_default=e.target.getAttribute("data-default-url"),index=e.target.get("value").indexOf(txt_default);-1!==index&&Y.shareThisV3Dialog.service_helpers.setSelectionRange(Y.Node.getDOMNode(o),index,index+txt_default.length)}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-email",function(Y){Y.config.flickr.user.apiURL=null;var selector,share_services=Y.shareThisV3Services,added_contacts={},form_disabled=!1,form_id="#share-form-email",submit_via_click=!1;function disableForm(){form_disabled||(Y.shareThisV3Dialog.service_helpers.disableForm(Y.one(form_id)),form_disabled=!0)}function enableForm(){form_disabled&&(Y.shareThisV3Dialog.service_helpers.enableForm(Y.one(form_id)),form_disabled=!1)}function verifyForm(){var helpers=Y.shareThisV3Dialog.service_helpers,requires_guestpass=helpers.is_guestpass_required(),automatic_guestpass=helpers.is_guestpass_automatic(),has_input=testEmailAddress(Y.one("#sharing-email-input").get("value"))||function(){var to_send=getContactsToSend();return to_send.to_email||to_send.to_flickr}();!requires_guestpass||automatic_guestpass?has_input?enableForm():disableForm():has_input&&helpers.is_guestpass_chosen()?enableForm():disableForm()}function getShareParams(){var params=getContactsToSend(),form_params=Y.shareThisV3Dialog.get_form_params();params=Y.merge(params,form_params);var textarea=Y.one("#email-text"),message_text=textarea.get("value");return message_text&&message_text!==textarea.getAttribute("data-default-text")&&(params.message_text=message_text),params}function addContactItem(contact){if(void 0===added_contacts[contact.n?contact.n:contact.e]){added_contacts[contact.n?contact.n:contact.e]=contact,selector.skipContact(contact),F.config.flickr.is_secure&&(contact.i=contact.i.replace("http:","https:"));var lastLIs,container=Y.one("#bo-selecta-results-box");liEl=document.createElement("li"),liEl.innerHTML=contact.n?'<p nsid="'+contact.n+'"><span class="name"><img src="'+contact.i+'" width="24" height="24" class="BuddyIconX" nsid="'+contact.n+'" id="pt-icon-'+contact.n+'"><strong class="username">'+selector._sanitizeString(contact.u)+'</strong><span class="realname">'+(contact.r?selector._sanitizeString(contact.r):Y.transjax.get("share-this-v3-service-email","no_realname"))+'</span></span><span class="controls"><a href="#" class="delete-x" class="pt-remove" id="pt-remove-'+contact.n+'"><span>[x]</span></a></span></p>':'<p email="'+selector._sanitizeString(contact.e)+'" class="email-contact"><span class="name"><img src="'+contact.i+'" width="16" height="16" class="BuddyIconX bs-email-icon"><strong class="username email">'+selector._sanitizeString(contact.e)+'</strong></span><span class="controls"><a href="#" class="delete-x" class="pt-remove" id="pt-remove-'+selector._sanitizeString(contact.e)+'"><span>[x]</span></a></span></p>',container.appendChild(liEl),container.addClass("not-empty"),Y.is_ie&&container.setStyle("display","block"),(lastLIs=container.all("li.last"))&&lastLIs.each(function(){this.removeClass("last")}),Y.one(liEl).addClass("last"),5<container.getElementsByTagName("li").length&&container.addClass("overflow"),container.set("scrollTop",container.get("scrollHeight"))}return setTimeout(function(){selector.clear(!0)},1),verifyForm(),Y.global_dialog.reposition(),"undefined"!=typeof e&&e.preventDefault(),!1}function addEmailAddressHandler(e){var emailItems,i,j,originalText=selector.getQuery(),input=Y.one("#sharing-email-input");if(!(emailItems=originalText.replace(/([\;\s<>]+)/g,",").split(",")).length)return addEmailAddress(!1,e);for(i=0,j=emailItems.length;i<j;i++)emailItems[i]&&(input.set("value",emailItems[i]),addEmailAddress(!0,e));input.set("value","")}function addEmailAddress(alert_option,e){var original_text=selector.getQuery();if(validateContact(alert_option)){var contact={e:selector.getQuery()};if(void 0===added_contacts[contact.e]){added_contacts[contact.e]=contact;var container=Y.one("#bo-selecta-results-box"),liEl=document.createElement("li");liEl.innerHTML='<p email="'+selector._sanitizeString(contact.e)+'" class="email-contact"><span class="name"><img src="/images/icon_unread.gif" width="16" height="16" class="BuddyIconX bs-email-icon"><strong class="username email">'+selector._sanitizeString(contact.e)+'</strong></span><span class="controls"><a href="#" class="pt-remove delete-x" id="pt-remove-'+selector._sanitizeString(contact.e)+'"><span>[x]</span></a></span></p>',container.appendChild(liEl),container.addClass("not-empty"),Y.UA.ie&&container.setStyle("display","block"),container.all("li").removeClass("last"),Y.one(liEl).addClass("last"),5<container.all("li").size()&&container.addClass("overflow"),container.set("scrollTop",container.get("scrollHeight")),selector.clear(!0)}verifyForm()}return e&&original_text&&!submit_via_click?(e.halt(),!1):Y.config.flickr.flags.enable_grease&&!Y.config.flickr.user.nsid?(Y.use("grease",function(Y){var params=getShareParams();Y.grease.shareV3(params),Y.grease.authenticate(function(ok){})}),e&&e.preventDefault(),!1):void 0}function testEmailAddress(chunk){return/[a-z_0-9\.\-\+\']+@[a-z_0-9\.\-\+]+\.[a-z]/i.test(chunk)}function looksLikeEmail(chunk){return/\.|@/.test(chunk)}function validateContact(no_alert){var textEntered=selector.getQuery();if(""===textEntered)return!1;if(testEmailAddress(textEntered))return!0;var message=Y.config.flickr.flags.enable_grease?Y.transjax.get("share-this-v3-service-email","sharing_email_error",textEntered):Y.transjax.get("share-this-v3-service-email","sharing_no_contact",textEntered);return looksLikeEmail(textEntered)&&(message=Y.transjax.get("share-this-v3-service-email","sharing_email_error")),no_alert||alert(message),!1}function removeContactItem(e){e.halt();var p=e.target.ancestor("p"),contactIdentifier=p.getAttribute("nsid")?p.getAttribute("nsid"):p.getAttribute("email");selector.unskipContact(added_contacts[contactIdentifier]),delete added_contacts[contactIdentifier];var li=p.get("parentNode"),container=Y.one("#bo-selecta-results-box");container.removeChild(li),selector.clear(!0);var liEls=container.all("li");0===liEls.size()?(container.removeClass("not-empty"),Y.is_ie&&container.setStyle("display","")):(liEls.removeClass("last"),liEls.size()&&container.all("li:list-child").addClass("last")),liEls.size()<=5&&container.removeClass("overflow"),verifyForm()}function getContactsToSend(){var key,params={},to_email=[],to_flickr=[];for(key in added_contacts)added_contacts.hasOwnProperty(key)&&(added_contacts[key].n?to_flickr.push(added_contacts[key].n):added_contacts[key].e&&to_email.push(added_contacts[key].e));return 0<to_email.length&&(params.to_email=to_email.join()),0<to_flickr.length&&(params.to_flickr=to_flickr.join()),params}share_services?share_services.add_service({name:"email",id:130,default_text:null,on_show_screen:{share:function(){var helpers=Y.shareThisV3Dialog.service_helpers,emailField=Y.one("#sharing-email-input"),textarea=Y.one("#email-text"),service=Y.shareThisV3Dialog.get_current_service();submit_via_click=!1,service.default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",helpers.maybeClearText),textarea.on("blur",helpers.maybeRestoreText),Y.one("#to-flickr").set("value",""),Y.one("#to-email").set("value",""),added_contacts={},add_by_email=function(e){validateContact()&&(addEmailAddressHandler(),Y.global_dialog.reposition())},(selector=new Y.BoSelecta3(emailField,{showSubtitle:!0,showIcon:!0,maxResultsDisplayed:4,includeAddressBook:!!Y.config.flickr.user.nsid,searchOnUsername:!0,searchOnRealname:!0,searchOnEmail:!0,searchOnPathAlias:!0,showTotalResults:!0,allowNoContacts:!0,defaultText:Y.transjax.get("share-this-v3-service-email","email_field_default_text"),purgeFormOnDataFailure:!1,focusOnFetch:!0,fetchDataImmediately:!0,selectFirstItem:!0,allowFormSubmit:!1,hideNoContactMessage:!0,enableGlobalSearch:!1,zeroResultsMessages:[{message:"<span>"+Y.transjax.get("share-this-v3-service-email","send_an_email")+"</span>",className:"bs-send-email-link",onclick:add_by_email,validator:function(selecta){var query=selecta.getQuery();return looksLikeEmail(query)&&testEmailAddress(query)&&!selecta.searchingGlobally}}],apiURL:Y.config.flickr.user.nsid?emailField.getAttribute("data-api-url"):null})).on("BoSelecta:resultSelect",addContactItem),selector.on("BoSelecta:resultClick",addContactItem),Y.one(form_id).one('.Butt[type="submit"]').on("mousedown",function(e){submit_via_click=!0}),Y.one(form_id).on("submit",addEmailAddressHandler),helpers.is_guestpass_required()&&Y.all('#guestpass-box input[type="checkbox"]').on("click",verifyForm),form_disabled=!1,disableForm(),Y.one("#sharing-email-input").on("keyup",verifyForm),Y.delegate("click",removeContactItem,"#bo-selecta-results-box","a.delete-x")}},on_submit_form:{share:function(e){var params=getContactsToSend();if(Y.one("#to-flickr").set("value",params.to_flickr||null),Y.one("#to-email").set("value",params.to_email||null),Y.config.flickr.flags.enable_grease&&!Y.config.flickr.user.nsid)return e.preventDefault(),!1;Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#email-text")})}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:F.config.modules["share-this-v3-service-email"].requires||[],optional:F.config.modules["share-this-v3-service-email"].optional||[]});YUI.add("share-this-v3-service-facebook",function(Y){var form,gp_box,gp_required,gp_automatic,checkboxes,checked_count,share_services=Y.shareThisV3Services,form_disabled=!1,form_id="#share-form-facebook",guestpass_box_id="#guestpass-box";function check_guestpass_logic(){if(form=Y.one(form_id),gp_box=Y.one(guestpass_box_id),gp_required=Y.shareThisV3Dialog.service_helpers.is_guestpass_required(),gp_automatic=Y.shareThisV3Dialog.service_helpers.is_guestpass_automatic(),checkboxes=null,checked_count=0,!gp_required||gp_automatic)return form_disabled&&(Y.shareThisV3Dialog.service_helpers.enableForm(form),form_disabled=!1),!1;gp_box&&(checkboxes=gp_box.all('input[type="checkbox"]'))&&(checkboxes.each(function(){this.get("checked")&&checked_count++}),checked_count&&form_disabled?(Y.shareThisV3Dialog.service_helpers.enableForm(form),form_disabled=!1):checked_count||form_disabled||(Y.shareThisV3Dialog.service_helpers.disableForm(form),form_disabled=!0))}share_services?share_services.add_service({name:"facebook",id:128,setup_url:"/share.gne?action=setup&service_type_id=128",use_popup:!0,signed_out_url:"/share.gne?action=signedOutShare&service_type_id=128",popup_params:{width:780,height:500},default_text:null,setup_only:!1,share_signed_out:function(e){var service_obj=Y.shareThisV3Dialog.get_current_service(),service_data_params="&"+Y.shareThisV3Dialog.get_share_this_data(!0).join("&"),share_service_url=service_obj.signed_out_url+"&"+service_data_params;return Y.shareThisV3Dialog.webCirca1999(share_service_url,{width:640,height:320}),!1},on_window_closed:function(){var service_obj=Y.shareThisV3Dialog.get_current_service();Y.log("auth (maybe) complete for "+service_obj.name),service_obj.setup_only?Y.shareThisV3Dialog.service_helpers.setupOnly():Y.shareThisV3Dialog.fetch_sharing_fragment()},on_auth_failed:function(){Y.log("D'oh, auth did not work, or something. Retry?")},on_show_screen:{share:function(){form_disabled&&(form_disabled=!1,Y.shareThisV3Dialog.service_helpers.enableForm(form));var textarea=Y.one("#facebook-text");Y.shareThisV3Dialog.get_current_service().default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",Y.shareThisV3Dialog.service_helpers.maybeClearText),textarea.on("blur",Y.shareThisV3Dialog.service_helpers.maybeRestoreText),Y.all(guestpass_box_id+' input[type="checkbox"]').on("change",check_guestpass_logic),check_guestpass_logic(),Y.log("on_show_screen.share()")},error:function(){Y.fire("shareDialog:servicesAuthComplete")}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#facebook-text")})}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-livejournal",function(Y){var endpoint,username,password,share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"livejournal",id:5,use_setup_dialog:!0,default_text:null,on_show_screen:{setup:function(){Y.log("livejournal: setup screen");var service_obj=Y.shareThisV3Dialog.get_current_service();endpoint=Y.one("#lj-setup-api-endpoint"),username=Y.one("#lj-setup-username"),(password=Y.one("#lj-setup-password"))&&password.on("focus",service_obj.misc.set_password_field),username&&(username.on("keypress",service_obj.misc.update_endpoint_url),username.on("keyup",service_obj.misc.update_endpoint_url))},setup_choose_a_blog:function(){Y.log("livejournal: setup_choose_a_blog()")},share:function(){var service_obj=Y.shareThisV3Dialog.get_current_service(),helpers=Y.shareThisV3Dialog.service_helpers,textarea=Y.one("#livejournal-text");service_obj.default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",helpers.maybeClearText),textarea.on("blur",helpers.maybeRestoreText),helpers.addDescriptionEvents(Y.one("#share-this-v3-dialog .add-object-description"),textarea)},password:function(){Y.shareThisV3Dialog.get_current_service();var password=Y.one("#lj-setup-password");password&&password.focus()}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#livejournal-text")})}},on_auth_failed:function(){Y.shareThisV3Dialog.set_dialog_state("state-setup state-setup-error"),Y.global_dialog.reposition()},misc:{update_endpoint_url:function(e){endpoint.set("value",endpoint.getAttribute("data-default-url").replace("%s",username.get("value")))},set_password_field:function(e){var o=e.target;o&&Y.shareThisV3Dialog.service_helpers.setPasswordField(o)}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-pinterest",function(Y){var share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"pinterest",id:132,use_popup:!0,signed_out_url:"/share.gne?action=signedOutShare&service_type_id=132",share_signed_out:function(e){var service_obj=Y.shareThisV3Dialog.get_current_service(),service_data_params="&"+Y.shareThisV3Dialog.get_share_this_data(!0).join("&"),share_service_url=service_obj.signed_out_url+service_data_params;return Y.shareThisV3Dialog.webCirca1999(share_service_url,{width:685,height:520}),Y.fire("flickr-menus:hide"),!1}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-tumblr",function(Y){var share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"tumblr",id:12,setup_url:"/share.gne?action=setup&service_type_id=12",use_popup:!0,popup_params:{width:920,height:600},signed_out_url:"/share.gne?action=signedOutShare&service_type_id=12",default_text:null,share_signed_out:function(e){var service_obj=Y.shareThisV3Dialog.get_current_service(),service_data_params="&"+Y.shareThisV3Dialog.get_share_this_data(!0).join("&"),share_service_url=service_obj.signed_out_url+service_data_params;return Y.shareThisV3Dialog.webCirca1999(share_service_url,{width:788,height:375}),!1},on_window_closed:function(){var service_obj=Y.shareThisV3Dialog.get_current_service();Y.log("auth (maybe) complete for "+service_obj.name),service_obj.setup_only,Y.shareThisV3Dialog.fetch_sharing_fragment()},on_auth_failed:function(){Y.log("D'oh, auth did not work, or something. Retry?")},on_show_screen:{share:function(){Y.log("on_show_screen:share"),Y.global_dialog.show();var service_obj=Y.shareThisV3Dialog.get_current_service(),helpers=Y.shareThisV3Dialog.service_helpers,textarea=Y.one("#tumblr-text");Y.one("#tumblr-butt-post");if(!textarea)return Y.log("Warn: could not find textarea"),!1;helpers.addDescriptionEvents(Y.one("#share-this-v3-dialog .add-object-description"),textarea),helpers.addMoreOptionsEvents(),service_obj.default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",helpers.maybeClearText),textarea.on("blur",helpers.maybeRestoreText)}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#tumblr-text")})},setup_choose_a_blog:function(){Y.global_dialog.hide(),Y.global_dialog.set_loading(!0)}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-twitter",function(Y){var share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"twitter",id:9,setup_url:"/share.gne?action=setup&service_type_id=9",use_popup:!0,popup_params:{width:780,height:500},signed_out_url:"/share.gne?action=signedOutShare&service_type_id=9",max_tweet_length:140,default_text:null,flickr_shorturl_length:null,over_limit_classname:"over-limit",share_signed_out:function(e){var service_obj=Y.shareThisV3Dialog.get_current_service(),service_data_params="&"+Y.shareThisV3Dialog.get_share_this_data(!0).join("&"),share_service_url=service_obj.signed_out_url+service_data_params;return Y.shareThisV3Dialog.webCirca1999(share_service_url,{width:780,height:425}),!1},on_window_closed:function(){var service_obj=Y.shareThisV3Dialog.get_current_service();Y.log("auth (maybe) complete for "+service_obj.name),service_obj.setup_only?Y.shareThisV3Dialog.service_helpers.setupOnly():Y.shareThisV3Dialog.fetch_sharing_fragment()},on_auth_failed:function(){Y.log("D'oh, auth did not work, or something. Retry?")},on_show_screen:{share:function(){Y.log("on_show_screen:share");var over_limit_type,over_limit_size,service_obj=Y.shareThisV3Dialog.get_current_service(),textarea=Y.one("#tweet-text"),counter=Y.one("#tweet-characters"),lastLength=null,is_over_limit=!1,over_limit_strings={1:"over_limit_1",5:"over_limit_5",10:"over_limit_10",20:"over_limit_20",30:"over_limit_30"},submit_butt=Y.one("#twitter-butt-post");if(!textarea)return Y.log("Warn: could not find textarea"),!1;function selectText(field,start,end){if(field._node.setSelectionRange)field._node.focus(),field._node.setSelectionRange(start,end);else if(field._node.createTextRange){var range=field._node.createTextRange();range.collapse(!0),range.moveStart("character",start),range.moveEnd("character",end),range.select()}}var url=Y.Lang.trim(Y.one("#tweet-shorturl").get("title")),tweetContent=textarea.get("value");function updateWhileTyping(){var over,used=parseInt(textarea.get("value").length,10),remaining=140-parseInt(used,10);isNaN(remaining)||remaining===lastLength?isNaN(remaining)&&counter.setStyle("display","none"):((lastLength=remaining)<0&&!is_over_limit?(is_over_limit=!0,counter.addClass(service_obj.over_limit_classname),submit_butt.replaceClass("Butt","DisabledButt"),submit_butt.set("disabled",!0)):0<=remaining&&is_over_limit&&(is_over_limit=!1,counter.removeClass(service_obj.over_limit_classname),submit_butt.replaceClass("DisabledButt","Butt"),submit_butt.set("disabled",!1),counter.setStyle("fontSize","11px")),0<=remaining?counter.set("innerHTML",remaining):(1<=(over=Math.abs(remaining))&&over<5?(over_limit_type="1",over_limit_size=1):5<=over&&over<10?(over_limit_type="5",over_limit_size=1.25):10<=over&&over<20?(over_limit_type="10",over_limit_size=1.5):20<=over&&over<30?(over_limit_type="20",over_limit_size=1.75):30<=over&&(over_limit_type="30",over_limit_size=2),over_limit_string=Y.transjax.get("share-this-v3-service-twitter",over_limit_strings[over_limit_type],remaining),counter.set("innerHTML",over_limit_string),counter.setStyle("fontSize",Math.min(32,parseInt(11*over_limit_size+(30<over?(over-30)/10:0),10))+"px"))),Y.one("#tweet-shorturl a").on("click",function(e){var partialFlickrShortURLFinder=/([^\s^]*)([http\:\/\/]+)?flic\.kr([\/a-zA-Z0-9]+)?([^\s$]*)/;0<textarea.get("value").search(partialFlickrShortURLFinder)?textarea.set("value",textarea.get("value").replace(partialFlickrShortURLFinder,url)):textarea.set("value",textarea.get("value")+" "+url),selectText(textarea,textarea.get("value").length,textarea.get("value").length),e.preventDefault()});var regexEscapedURL=new RegExp("(^|\\s)"+url.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+"($|\\s)");textarea.get("value").search(regexEscapedURL)<0?(Y.one("#tweet-shorturl span").show(),submit_butt.replaceClass("Butt","DisabledButt"),submit_butt.set("disabled",!0)):(Y.one("#tweet-shorturl span").hide(),is_over_limit||(submit_butt.replaceClass("DisabledButt","Butt"),submit_butt.set("disabled",!1)))}textarea.set("text",tweetContent+" "+url),selectText(textarea,0,tweetContent.length),service_obj.max_tweet_length=parseInt(textarea.getAttribute("data-available-chars"),10),service_obj.default_text=textarea.getAttribute("data-default-text"),Y.shareThisV3Dialog.service_helpers.addMoreOptionsEvents(),textarea.on("focus",Y.shareThisV3Dialog.service_helpers.maybeClearText),textarea.on("focus",updateWhileTyping),textarea.on("blur",Y.shareThisV3Dialog.service_helpers.maybeRestoreText),textarea.on("keyup",updateWhileTyping),textarea.on("change",updateWhileTyping),updateWhileTyping()},success:function(){var node_yes=Y.one(".flickr-follow-yes"),node_no=Y.one(".flickr-follow-no");function onClick(e){var action=e.target.getAttribute("data-action"),service_obj=Y.shareThisV3Dialog.get_current_service(),url_params=[];url_params.push("action="+action),url_params.push("service_type_id=9"),url_params.push("service_id="+service_obj.service_id),url_params.push("magic_cookie="+Y.config.flickr.magic_cookie),url_params=url_params.join("&");"followFlickr"==action?Y.one("#follow-flickr").set("innerHTML",'<p class="follow-working">'+Y.transjax.get("share-this-v3-dialog","following_flickr_waiting")+"</p>"):(Y.one("#follow-flickr").remove(),Y.one(".follow-flickr-headline").remove()),Y.io("/share.gne",{method:"POST",data:url_params,on:{complete:function(id,obj,params){!function(text){return text&&text.match(/state-error/i)}(obj.responseText)?"followFlickr"==action&&Y.one("#follow-flickr").set("innerHTML",'<p class="follow-success">'+Y.transjax.get("share-this-v3-dialog","following_flickr_success")+"</p>"):Y.one("#follow-flickr").set("innerHTML",'<p class="follow-error">'+Y.transjax.get("share-this-v3-dialog","try_again_later")+"</p>")}}}),e.preventDefault()}node_yes&&node_no&&(node_yes.on("click",onClick),node_no.on("click",onClick))}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#tweet-text")})}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-wordpress",function(Y){var share_services=Y.shareThisV3Services;function checkForm(){var the_form=Y.one("#share-form-wordpress"),wp_setup_api_endpoint=Y.one("#wp-setup-api-endpoint"),content_ok=!1;""!==Y.one("#wp-setup-username").get("value")&&""!==wp_setup_api_endpoint.get("value")&&(content_ok=!0),content_ok?Y.shareThisV3Dialog.service_helpers.enableForm(the_form):Y.shareThisV3Dialog.service_helpers.disableForm(the_form)}share_services?share_services.add_service({name:"wordpress",id:7,use_setup_dialog:!0,default_text:null,on_show_screen:{setup:function(){Y.log("wordpress: setup screen");var service_obj=Y.shareThisV3Dialog.get_current_service(),endpoint=Y.one("#wp-setup-api-endpoint"),wp_setup_username=Y.one("#wp-setup-username");endpoint&&(endpoint.on("focus",service_obj.misc.maybe_highlight_endpoint),endpoint.focus(),endpoint.on("keypress",checkForm),endpoint.on("keyup",checkForm)),wp_setup_username&&(wp_setup_username.on("keypress",checkForm),wp_setup_username.on("keyup",checkForm)),checkForm()},setup_choose_a_blog:function(){Y.log("wordpress: choose_a_blog()")},share:function(){Y.log("wordpress: share screen");var helpers=Y.shareThisV3Dialog.service_helpers,service_obj=Y.shareThisV3Dialog.get_current_service(),textarea=Y.one("#wordpress-text"),subject=Y.one("#wordpress-subject");Y.global_dialog.set_loading(!1),Y.global_dialog.show(),service_obj.default_text=textarea.getAttribute("data-default-text"),helpers.addDescriptionEvents(Y.one("#share-this-v3-dialog .add-object-description"),textarea),textarea.on("focus",helpers.maybeClearText),textarea.on("blur",helpers.maybeRestoreText),subject&&subject.focus()},password:function(){Y.log("wordpress: password screen");Y.shareThisV3Dialog.get_current_service();var password=Y.one("#wp-setup-password");password&&password.focus()}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#wordpress-text")})},setup_choose_a_blog:function(){Y.global_dialog.hide(),Y.global_dialog.set_loading(!0)}},on_auth_failed:function(){Y.log("on_auth_failed"),set_dialog_state("state-setup state-setup-error"),Y.global_dialog.reposition(),Y.log("setup screen shown - now what, complain?")},misc:{maybe_highlight_endpoint:function(e){var o=e.target,txt_default=e.target.getAttribute("data-default-url"),index=e.target.get("value").indexOf(txt_default);-1!==index&&Y.shareThisV3Dialog.service_helpers.setSelectionRange(Y.Node.getDOMNode(o),index,index+txt_default.length)}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-service-yahoo-pulse",function(Y){var share_services=Y.shareThisV3Services;share_services?share_services.add_service({name:"yahoo",id:129,default_text:null,flickr_shorturl_length:null,share_signed_out:function(e){},on_show_screen:{share:function(){Y.log("on_show_screen:share");var service_obj=Y.shareThisV3Dialog.get_current_service(),textarea=Y.one("#pulse-text");service_obj.default_text=textarea.getAttribute("data-default-text"),textarea.on("focus",Y.shareThisV3Dialog.service_helpers.maybeClearText),textarea.on("blur",Y.shareThisV3Dialog.service_helpers.maybeRestoreText)}},on_submit_form:{share:function(){Y.shareThisV3Dialog.service_helpers.maybeClearText({target:Y.one("#pulse-text")}),Y.fire("shareDialog:servicesAuthComplete")}}}):Y.log("Y.shareThisV3Services null/undefined?")},"0.0.1",{requires:["share-this-v3-services"]});YUI.add("share-this-v3-dialog",function(Y){var web1999Window=null,service_name=null,share_object_id=null,share_object_type=null,share_object_owner_nsid=null,service_obj=null,assigned_events=[],data_state_prefix="state-",context="share-this-v3-dialog",service_helpers={assign_events:function(){assign_dialog_dismiss_events(),add_event(Y.all("#global-dialog-container form.share-form").on("submit",handle_fragment_form_submit))},addDescriptionEvents:function(addDescriptionLink,textarea){addDescriptionLink&&addDescriptionLink.on("click",function(e){Y.shareThisV3Dialog.service_helpers.addObjectDescription(textarea,e),e.target.ancestor(".add-description").addClass("description-added")})},addObjectDescription:function(textarea,e){maybeClearText({target:textarea});var desc=function(descriptionElement){var o=descriptionElement||Y.one("#share-this-v3-dialog textarea.share-object-description");if(o)return o.get("value")}(),userText=textarea.get("value");return desc&&textarea.set("value",(userText?userText+"\n\n":"")+desc),e.preventDefault(),!1},addMoreOptionsEvents:function(){var dialog=Y.one("#share-this-v3-dialog"),more_options=dialog.one(".more-options"),more_options_toggler=dialog.one(".more-options-toggler");more_options&&more_options_toggler&&more_options_toggler.one("a")&&more_options_toggler.one("a").on("click",function(e){e.preventDefault(),more_options.toggleClass("more-options-open"),more_options_toggler.toggleClass("more-options-toggler-open")})},disableForm:function(formObject){formObject.all('input[type="submit"]').each(function(){this.replaceClass("Butt","DisabledButt"),this.setAttribute("disabled","disabled")})},enableForm:function(formObject){formObject.all('input[type="submit"]').each(function(){this.replaceClass("DisabledButt","Butt"),this.removeAttribute("disabled")})},genericError:function(){Y.global_dialog.remove_existing_dialog(),Y.global_dialog.set_loading(!1),Y.global_dialog.create_alert_dialog("<b>"+Y.transjax.get("share-this-v3-dialog","try_again_later")+"</b>",function(){Y.global_dialog.hide()})},is_guestpass_automatic:function(){var o=Y.one("#guestpass-box");return!!o&&"true"===o.getAttribute("data-auto-guestpass")},is_guestpass_chosen:function(){var o=Y.one("#guestpass-box"),inputs=o?o.all('input[type="checkbox"]'):null,something_checked=!1;return inputs&&inputs.each(function(){this.get("checked")&&(something_checked=!0)}),something_checked},is_guestpass_required:function(){var o=Y.one("#guestpass-box");return!!o&&"true"===o.getAttribute("data-required")},on_show_screen:{setup:function(){},share:function(){Y.one("#guestpass-box")&&add_event(Y.all('#guestpass-box input[type="checkbox"]').on("click",guestpass_checkbox_update))},success:function(){Y.use("flanal",function(Y){Y.flanal("flickr.sharing."+service_obj.name+"_share_complete",service_obj.name+"_share_complete")})}},maybeClearText:maybeClearText,maybeRestoreText:function(e){},setupOnly:function(){return!(void 0===service_obj.setup_only||!service_obj.setup_only||(Y.global_dialog.hide(),Y.global_dialog.set_loading(!0),setTimeout(function(){window.location.href="/account/?tab=extend"},20),0))},setPasswordField:function(oInput){var o=oInput;if("password"!==o.get("type"))if(Y.UA.ie){var newNode,oldNode=Y.Node.getDOMNode(o),oPassword=oldNode.cloneNode(!0);oPassword.type="password",oPassword.value="",newNode=oldNode.parentNode.insertBefore(oPassword,oldNode),oldNode.parentNode.removeChild(oldNode),setTimeout(function(){try{newNode.focus()}catch(e){}},10)}else o.set("type","password"),o.set("value","")},setSelectionRange:function(input,selectionStart,selectionEnd){if(input.setSelectionRange)input.focus(),input.setSelectionRange(selectionStart,selectionEnd);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",selectionEnd),range.moveStart("character",selectionStart),range.select()}}};function maybeClearText(e){var textarea=e.target;textarea.get("value")===service_obj.default_text&&(textarea.set("value",""),textarea.removeClass("default-text"),"undefined"!=typeof updateWhileTyping&&updateWhileTyping())}var services={};function get_share_this_object_id(){return Y.config&&Y.config.flickr&&Y.config.flickr.sharing&&Y.config.flickr.sharing.object?Y.config.flickr.sharing.object.id:null}function get_share_this_object_owner_nsid(){return Y.config&&Y.config.flickr&&Y.config.flickr.sharing&&Y.config.flickr.sharing.object?Y.config.flickr.sharing.object.owner_nsid:null}function get_share_this_object_type(){return Y.config&&Y.config.flickr&&Y.config.flickr.sharing&&Y.config.flickr.sharing.object?Y.config.flickr.sharing.object.type:null}function get_dialog_state(){var o=Y.one("#share-this-v3-dialog"),state=null;return o&&(state=o.getAttribute("data-state")),state}function set_dialog_state(sClassName){var auto_focus_item;Y.one("#share-this-dialog-state")&&Y.one("#share-this-dialog-state").setAttribute("class",sClassName),sClassName&&sClassName.length>data_state_prefix.length&&("working"!==(sClassName=sClassName.substr(data_state_prefix.length))&&function(){for(var i=assigned_events.length;i--;)assigned_events[i].detach();assigned_events=[]}(),(auto_focus_item=Y.one("#share-this-v3-dialog .auto-focus"))&&auto_focus_item.focus(),service_helpers.on_show_screen&&service_helpers.on_show_screen[sClassName]&&service_helpers.on_show_screen[sClassName](),service_obj&&service_obj.on_show_screen&&service_obj.on_show_screen[sClassName]&&service_obj.on_show_screen[sClassName]())}function show_setup_state(){set_dialog_state("state-setup")}function guestpass_checkbox_update(e){!function(){var options,url_params=[];url_params.push("action=retrieve_fragments"),url_params.push("fragments[]=dialog-share-thumbnails"),service_name&&url_params.push("service_name="+service_name);share_object_id&&url_params.push("object_id="+share_object_id);share_object_type&&url_params.push("object_type="+share_object_type);share_object_owner_nsid&&url_params.push("owner_nsid="+share_object_owner_nsid);service_obj&&(service_obj.service_id&&url_params.push("service_id="+service_obj.service_id),service_obj.service_type_id&&url_params.push("service_type_id="+service_obj.service_type_id));Y.one("#global_dialog").all("input.gp-type:checked").each(function(node){url_params.push(node.getAttribute("name")+"=1")}),url_params=url_params.join("&"),options={on_complete:function(){}};var callbacks={success:function(id,obj,params){var html=obj.responseText;Y.one("#share-this-thumbnail").get("parentNode").set("innerHTML",html)}};Y.one("#share-this-thumbnail-loading").setStyle("display","block"),fetch_fragment("/share.gne",url_params,options,callbacks)}()}function add_event(yuiEventHandle){assigned_events.push(yuiEventHandle)}function assign_dialog_dismiss_events(){var fb_reconnect_link=Y.one(".fb-needs-reconnect");Y.all("#global-dialog-container a, #global-dialog-container input").on("click",function(e){var target=e.target;if(target&&(target.hasClass("close-x")||target.hasClass("CancelButt")||target.hasClass("dismissDialog")))return Y.global_dialog.hide(),e.preventDefault(),Y.PageContext&&Y.PageContext.unset(context),!1}),fb_reconnect_link&&fb_reconnect_link.on("click",function(e){e.preventDefault(),Y.global_dialog.hide(),Y.PageContext&&Y.PageContext.unset(context),Y.shareThisV3Dialog.share_by_service(service_obj.id,service_obj.service_type_id,!0,!1,null,e)},this)}function dialog_io_complete(tid,o,args){var html_state;service_obj&&service_obj.needs_setup?o.responseText?(Y.one("#share-this-v3-dialog").get("parentNode").set("innerHTML",o.responseText),(html_state=get_dialog_state())&&html_state.match(/share/i)&&Y.fire("shareDialog:servicesAuthComplete"),set_dialog_state(html_state)):service_helpers.setupOnly()||(service_obj.needs_setup=!0,service_obj.on_auth_failed&&service_obj.on_auth_failed()):looks_like_valid_response(o.responseText)&&Y.one("#share-this-v3-dialog")?(Y.one("#share-this-v3-dialog").get("parentNode").set("innerHTML",o.responseText),set_dialog_state(html_state=get_dialog_state())):service_helpers.genericError();service_helpers.assign_events()}function handle_fragment_form_submit(e){var event_name,current_state,theForm=e.target;return theForm.hasClass("scrumjax-exclude")?(Y.global_dialog.hide(),Y.global_dialog.set_loading(!0),!0):(service_obj&&(current_state=get_dialog_state())&&(event_name=current_state.substr(data_state_prefix.length),service_obj.on_submit_form&&service_obj.on_submit_form[event_name]&&service_obj.on_submit_form[event_name](e)),Y.use("io-form",function(){var cfg={method:"POST",form:{id:theForm.getAttribute("id"),useDisabled:!1},on:{success:dialog_io_complete,failure:dialog_io_complete,timeout:dialog_io_complete}};service_obj&&service_obj.setup_only?set_dialog_state("state-working setup-only"):set_dialog_state("state-working");var uri=theForm.getAttribute("action");uri=uri||theForm.getAttribute("data-ie-action"),Y.one("#"+theForm.getAttribute("id"))&&Y.io(uri,cfg)}),e.preventDefault(),!1)}function looks_like_valid_response(text){return text&&text.match(/share\-this\-v3/i)}function fetch_fragment(url,url_params,o_options,o_callbacks){var callbacks=void 0!==o_callbacks?o_callbacks:{success:function(id,obj,params){var html_state,html=obj.responseText;looks_like_valid_response(html)?(Y.global_dialog.remove_existing_dialog(),Y.global_dialog.create_dialog(html),html_state=get_dialog_state(),Y.global_dialog.show({modal:!0,width:!Y.UA.ie||Y.config.is_zeus?422:440}),o_options&&o_options.on_complete?o_options.on_complete():set_dialog_state(html_state),Y.global_dialog.reposition(),Y.global_dialog.set_loading(!1),Y.global_dialog.set_modal(!0),service_helpers.assign_events()):service_obj&&service_obj.setup_only?service_helpers.setupOnly():service_helpers.genericError()},failure:function(id,obj,params){"timeout"===obj.statusText?service_obj&&service_obj.needs_auth&&service_obj.on_auth_failed&&service_obj.on_auth_failed():service_obj&&service_obj.needs_auth&&service_obj.on_auth_failed?service_obj.on_auth_failed():(Y.global_dialog.hide(),service_helpers.genericError())}};Y.global_dialog.set_loading(!0),Y.io(url,{method:"POST",data:url_params,on:callbacks,arguments:url_params})}function fetch_sharing_fragment(o_options){var options=o_options||null,url_params=[];url_params.push("action=retrieve_fragments"),service_obj.needs_setup?url_params.push("fragments[]=dialog-setup"):url_params.push("fragments[]=dialog-share"),service_name&&url_params.push("service_name="+service_name),share_object_id&&url_params.push("object_id="+share_object_id),share_object_type&&url_params.push("object_type="+share_object_type),share_object_owner_nsid&&url_params.push("owner_nsid="+share_object_owner_nsid),url_params.push("cachebust="+(new Date).getTime()),service_obj&&(service_obj.setup_only&&url_params.push("setup_only=1"),service_obj.service_id&&url_params.push("service_id="+service_obj.service_id),service_obj.service_type_id&&url_params.push("service_type_id="+service_obj.service_type_id)),fetch_fragment("/share.gne",url_params=url_params.join("&"),options)}function webCirca1999(url,window_params,oncomplete){var item,param_array=[];for(item in window_params)window_params.hasOwnProperty(item)&&param_array.push(item+"="+window_params[item]);param_array.push("resizable=1"),param_array.push("scrollbars=1");try{(web1999Window=window.open(url,"newWindow",param_array.join(","))).focus&&web1999Window.focus()}catch(e){return!0}return oncomplete&&(Y.global_dialog.set_loading(!0),function waitForWindowClose(oncomplete){web1999Window&&web1999Window.closed?oncomplete():setTimeout(function(){waitForWindowClose(oncomplete)},1e3)}(oncomplete)),!1}function init(){Y.shareThisV3Services&&(services=Y.shareThisV3Services.get_services())}init(),Y.shareThisV3Dialog={assign_dialog_dismiss_events:assign_dialog_dismiss_events,confirm_delete:function(o_options){var url_params=[];url_params.push("action=delete"),o_options.service_id&&url_params.push("service_id="+o_options.service_id),o_options.service_type_id&&url_params.push("service_type_id="+o_options.service_type_id),url_params.push("cachebust="+(new Date).getTime()),fetch_fragment("/share.gne",url_params=url_params.join("&"),{on_complete:function(){var o=Y.one("#share-confirm-delete");if(o)try{o.focus()}catch(e){}add_event(Y.one("#global-dialog-container form.scrumjax-exclude").on("submit",handle_fragment_form_submit))}})},do_share_action:function(share_params){var data=[];for(var item in share_params)share_params.hasOwnProperty(item)&&data.push(item+"="+encodeURIComponent(share_params[item]));var cfg={method:"POST",data:data.join("&"),on:{complete:function(tID,response){var text=response.responseText;looks_like_valid_response(text)?(Y.global_dialog.create_dialog(text).show({modal:!0,width:!Y.UA.ie||Y.config.is_zeus?422:440}),assign_dialog_dismiss_events()):Y.shareThisV3Dialog.service_helpers.genericError()}}};Y.io("/share.gne",cfg)},fetch_sharing_fragment:fetch_sharing_fragment,get_current_service:function(){return service_obj},get_form_params:function(){var owner_nsid,params={};return params.service_type_id=Y.one("#form_service_type_id").get("value"),params.object_type=Y.one("#form_object_type").get("value"),params.object_id=Y.one("#form_object_id").get("value"),(owner_nsid=Y.one("#form_owner_nsid"))&&(params.owner_nsid=owner_nsid.get("value")),params},init:init,refresh_dialog_state:function(){var html_state=get_dialog_state();html_state&&set_dialog_state(html_state)},services:services,service_helpers:service_helpers,get_share_this_data:function(use_array){var i,data_array=[],data={object_id:get_share_this_object_id(),owner_nsid:get_share_this_object_owner_nsid(),object_type:get_share_this_object_type()};if(!use_array)return data;for(i in data)data.hasOwnProperty(i)&&data_array.push(i+"="+data[i]);return data_array},share_by_service:function(service_id,service_type_id,needs_setup,setup_only,always_use_popup,evt){if(Y.PageContext&&Y.PageContext.set(context),share_object_id=get_share_this_object_id(),share_object_type=get_share_this_object_type(),share_object_owner_nsid=get_share_this_object_owner_nsid(),service_name=function(service_id){var item,result=null;for(item in service_id=parseInt(service_id,10),services)if(services.hasOwnProperty(item)&&services[item].id===service_id){result=services[item].name;break}return result}(service_type_id),!services[service_name])return!1;service_obj=services[service_name];var pretend_logged_out=!(!evt||void 0===Y.config.flickr.user.admin_user)&&evt.altKey;if(!always_use_popup&&!pretend_logged_out&&Y.config&&Y.config.flickr&&Y.config.flickr.user&&Y.config.flickr.user.nsid);else if(always_use_popup||pretend_logged_out||"undefined"==typeof global_nsid||!global_nsid){if(service_obj.share_signed_out)return service_obj.share_signed_out(evt),evt.preventDefault(),!1}else;return Y.fire("flickr-menus:hide"),service_obj.needs_setup=needs_setup,service_obj.service_id=service_id,service_obj.service_type_id=service_type_id,service_obj.setup_only=setup_only,needs_setup?service_obj.use_popup&&service_obj.setup_url?webCirca1999(service_obj.setup_url,service_obj.popup_params,function(){service_obj.on_window_closed&&(service_obj.on_window_closed(),Y.fire("shareDialog:servicesAuthComplete"))}):(service_obj.use_setup_dialog,fetch_sharing_fragment({on_complete:function(){service_obj.needs_setup&&show_setup_state()}})):fetch_sharing_fragment(),!1},set_dialog_state:set_dialog_state,show_setup_state:show_setup_state,webCirca1999:webCirca1999}},"0.0.1",{requires:F.config.modules["share-this-v3-dialog"].requires||[],optional:F.config.modules["share-this-v3-dialog"].optional||[]});YUI.add("share-this-v3-triggers",function(Y){function handleClick(e){var node,service_obj,service_id,service_type_id,service_name,setup_only,needs_setup,always_use_popup,flanal_target,flanal_title;if(!(node=e.target.ancestor("a.share-dialog-action",!0))&&e.target.hasClass("Butt")&&(node=e.target.one("a.share-dialog-action")),node)if(node.hasClass("share-disabled"))e.preventDefault();else{if(service_id=node.getAttribute("data-service-id"),service_type_id=node.getAttribute("data-service-type-id"))return setup_only=node.getAttribute("data-setup-only"),needs_setup="true"===node.getAttribute("data-service-needs-setup"),always_use_popup="true"===node.getAttribute("data-service-always-use-popup"),!needs_setup&&e.shiftKey&&(Y.log("Allowing set-up override"),needs_setup=!0),setup_only||(service_name=(service_obj=Y.shareThisV3Services.get_service(parseInt(service_type_id,10)))&&service_obj.name&&service_obj.name.replace(/[^a-zA-Z0-9_\-]/g,"_"))&&(flanal_target="flickr.sharing_triggers."+(flanal_title=Y.config.flickr.user.nsid?needs_setup?service_name+"_button_needs_setup":service_name+"_button_already_setup":service_name+"_button_signed_out"),Y.flanal(flanal_target,flanal_title)),Y.shareThisV3Dialog.share_by_service(service_id,service_type_id,needs_setup,setup_only,always_use_popup,e),e.preventDefault(),!1;e.preventDefault()}}Y.shareThisV3Triggers={listen:function(container_node){container_node.on("click",handleClick)},handleClick:handleClick}},"0.0.1",{requires:F.config.modules["share-this-v3-triggers"].requires||[],optional:F.config.modules["share-this-v3-triggers"].optional||[]});YUI.add("cache-simple",function(Y){CacheSimple=function(){},CacheSimple.prototype={cache:{},add:function(key,value,payload){this.cache[key]={response:value,payload:payload}},retrieve:function(key){return this.cache[key]},clear:function(){this.cache={}}},Y.CacheSimple=CacheSimple},"0.0.1");YUI.add("node-visibility",function(Y){var NodeVisibility,handlers,dispatcher,isHiddenByOverflow,isVisible,onVisible,validateThreshold,animScrollIntoView,navigationHeight,eyebrowHeight,win=window,doc=window.document;function getViewportRegion(){var region=getViewportRegion.region;return region||((region={}).height=Y.DOM.winHeight(),region.width=Y.DOM.winWidth(),region.top=Math.max(doc.body.scrollTop||0,doc.documentElement.scrollTop||0,win.pageYOffset||0),region.left=Math.max(doc.body.scrollLeft||0,doc.documentElement.scrollLeft||0,win.pageXOffset||0),region.right=region.left+region.width,region.bottom=region.top+region.height,region[0]=region.top,region[1]=region.left,getViewportRegion.region=region),region}function invalidateViewportRegion(){getViewportRegion.region=void 0}function getNodeCache(key){var cache,data;return getNodeCache.cache||(getNodeCache.cache=new Y.CacheSimple),cache=getNodeCache.cache,Y.Lang.isString(key)?(data=cache.retrieve(key))&&data.response&&(new Date).getTime()<data.payload.expires?data.response:null:cache}handlers={resize:[],scroll:[]},eyebrowHeight=F.config.flickr.flags.enable_uh_eyebrow&&Y.one("#eyebrow")?Y.one("#eyebrow").get("offsetHeight"):0,navigationHeight=F.config.flickr.flags.enable_global_nav&&Y.one("#global-nav")?Y.one("#global-nav").get("offsetHeight")+eyebrowHeight:0,dispatcher={register:function(type,func){var index=handlers[type].push(func);return{detach:function(){handlers[type][index]=function(){}}}}},Y.on("scroll",Y.betterThrottle(function(e){Y.Array.each(handlers.scroll,function(o){o(e)})},50)),Y.on("resize",Y.betterThrottle(function(e){Y.Array.each(handlers.resize,function(o){o(e)})},50)),dispatcher.register("resize",invalidateViewportRegion),dispatcher.register("scroll",invalidateViewportRegion),isHiddenByOverflow=function(node,nodeRegion){var ancestor,ancestorOverflow;for(ancestor=node.ancestor();ancestor;ancestor=ancestor.ancestor())if(""!==(ancestorOverflow=ancestor.getStyle("overflow"))&&"visible"!==ancestorOverflow&&(nodeRegion=nodeRegion||node.get("region"),!node.inRegion(ancestor,!1,nodeRegion)))return!0;return!1},isVisible=function(node,threshold){var is_visible,viewportRegion,node_id,node_data,cached_node_data;return is_visible=!0,threshold=threshold?validateThreshold(threshold):[0,0],node_data=(cached_node_data=getNodeCache(node_id=node.toString()))||{},is_visible&&(Y.Lang.isString(node_data.display)||(node_data.display=node.getStyle("display")),Y.Lang.isNumber(node_data.offsetHeight)||(node_data.offsetHeight=node.get("offsetHeight")),Y.Lang.isNumber(node_data.offsetWidth)||(node_data.offsetWidth=node.get("offsetWidth")),"block"!==node_data.display||0!==node_data.offsetHeight&&0!==node_data.offsetWidth||(is_visible=!1)),is_visible&&(viewportRegion=getViewportRegion(),node_data.region||(node_data.region=node.get("region")),node.inRegion(function(region,threshold){var newRegion={};return Y.Lang.isNumber(threshold[0])&&(newRegion.left=region.left-threshold[0],newRegion.right=region.right+threshold[0],newRegion.width=region.width+2*threshold[0],newRegion.width<1&&(newRegion.width=1,newRegion.left=Math.floor((region.right+region.left)/2),newRegion.right=newRegion.left+1),newRegion[0]=newRegion.top),Y.Lang.isNumber(threshold[1])&&(newRegion.top=region.top-threshold[1],newRegion.bottom=region.bottom+threshold[1],newRegion.height=region.height+2*threshold[1],newRegion.height<1&&(newRegion.height=1,newRegion.top=Math.floor((region.bottom+region.top)/2),newRegion.bottom=newRegion.top+1),newRegion[1]=newRegion.left),newRegion}(viewportRegion,threshold),!1,node_data.region)||(is_visible=!1)),is_visible&&(Y.Lang.isBoolean(node_data.hidden_by_overflow)||(node_data.hidden_by_overflow=isHiddenByOverflow(node,node_data.region)),node_data.hidden_by_overflow&&(is_visible=!1)),cached_node_data||function(key,val){!Y.Lang.isString(key)||getNodeCache().add(key,val,{expires:(new Date).getTime()+500})}(node_id,node_data),is_visible},onVisible=function(){var init,uninit,cancel,callIfVisible,callAllVisible,setHandlerProperty,resizeHandle,scrollHandle,initialized=!1,handlers={};return init=function(){initialized||(resizeHandle=dispatcher.register("scroll",callAllVisible),scrollHandle=dispatcher.register("resize",callAllVisible),initialized=!0)},uninit=function(){initialized&&(resizeHandle.detach(),scrollHandle.detach(),initialized=!1)},cancel=function(id){var handler,finished;if(handlers[id]){for(handler in delete handlers[id],finished=!0,handlers)if(handlers.hasOwnProperty(handler)){finished=!1;break}return finished&&uninit(),!0}},callIfVisible=function(id){var handler=handlers[id];Y.Lang.isObject(handler)&&isVisible(handler.node,handler.threshold)&&(handler.callback.call(handler.oScope,handler.arg),cancel(id))},callAllVisible=function(){for(var id in handlers)handlers.hasOwnProperty(id)&&callIfVisible(id)},setHandlerProperty=function(id,property,value){if(Y.Lang.isObject(handlers[id]))return handlers[id][property]=value,!0},function(node,callback,threshold,arg,oScope){var handler,id;return node=Y.one(node),!(!Y.Lang.isObject(node)||!Y.Lang.isFunction(callback))&&(threshold=threshold?validateThreshold(threshold):[0,0],arg=arg||node,!0===oScope&&(oScope=arg),Y.Lang.isObject(oScope)||(oScope=window),init(),handler={node:node,callback:callback,threshold:threshold,arg:arg,oScope:oScope},id=Y.guid(),handlers[id]=handler,Y.later(0,window,callIfVisible,id),{cancel:function(){return cancel(id)},set:function(prop,val){return setHandlerProperty(id,prop,val)},check:function(){return callIfVisible(id)}})}}(),validateThreshold=function(threshold){return Y.Lang.isNumber(threshold)&&(threshold=[threshold,threshold]),Y.Lang.isArray(threshold)&&Y.Lang.isNumber(threshold[0])&&Y.Lang.isNumber(threshold[1])||(threshold=[0,0]),threshold},animScrollIntoView=function(node,align_to_top,top,onfinish,force){var anim,y;return!(!node instanceof Y.Node)&&(node.inViewportRegion(!0)&&!force||(align_to_top="object"==typeof align_to_top?(align_to_bottom=align_to_top.bottom,onfinish=align_to_top.onfinish,align_to_top.top):!!align_to_top,top=Y.Lang.isNumber(top)?top:0,win.setTimeout(function(){Y.Anim?(y=align_to_top?node.getY()-top:align_to_bottom?node.getY()-node.get("winHeight")+5+2*node.get("offsetHeight")+top:node.getY()+node.get("offsetHeight")-node.get("winHeight")+5,y-=navigationHeight,(anim=new Y.Anim({node:Y.one("window"),to:{scroll:[0,y]},duration:.3,easing:Y.Easing.easeOut})).on("end",function(){onfinish&&"function"==typeof onfinish&&onfinish()}),anim.run()):(node.scrollIntoView(align_to_top),onfinish&&"function"==typeof onfinish&&onfinish())},0)),node)},(NodeVisibility=function(config){this._node=config.host}).NS="vis",NodeVisibility.NAME="NodeVisibilityPlugin",NodeVisibility.prototype={isVisible:function(threshold){return isVisible(this._node,threshold)},onVisible:function(callback,threshold,arg,oScope){return onVisible(this._node,callback,threshold,arg,oScope)},animScrollIntoView:function(align_to_top,top,force){return animScrollIntoView(this._node,align_to_top,top,null,force)},destroy:function(){}},Y.Node.plug(NodeVisibility),Y.NodeVisibility=NodeVisibility},"0.0.1",{requires:["node","node-pluginhost","better-throttle","cache-simple"],optional:["anim","anim-scroll"]});YUI.add("share-this-v3-menu",function(Y){var menuNode,menu,postUploadMenu,buttonListNode,postUploadShareNode,open_panel_class="share-options-open",deferred_panel_class="share-options-deferred",placeholder_class="share-options-placeholder",panel_events={},initialized=!1,isPhotoPage="photo"===Y.config.flickr.page_type,isFavePage="faves"===Y.config.flickr.page_type,isExtra=Y.config.flickr.flags.enable_2013_photo_page_extras,isSihp="sihp"===Y.config.flickr.page_type,isPhotoStream="photostream"===Y.config.flickr.page_type,isSet="set"===Y.config.flickr.page_type,isFaves="faves"===Y.config.flickr.page_type,isGroups="group_pool"===Y.config.flickr.page_type,isRefresh=isExtra&&(isPhotoPage||isFavePage),showSquare=isRefresh||isSihp||isExtra&&(isPhotoStream||isSet||isFaves);function handleMenuMouseDown(e){(e.target.test("#share-options-grablink-input")||e.target.test(".embed-markup"))&&e.target.select()}function handleMenuMouseUp(e){(e.target.test("#share-options-grablink-input")||e.target.test(".embed-markup"))&&e.preventDefault()}function handleMenuClick(e){e.target.test("#share-options-grablink-input")||e.target.test(".embed-markup")?(e.target.select(),e.preventDefault()):e.target.ancestor("li.share-options div.share-options-header",!0)?(e.preventDefault(),openPanel(e.target.ancestor("li"))):e.target.ancestor(".share-more-ways",!0)?(e.preventDefault(),menuNode.one(".share-services-small").toggleClass("share-hidden")):e.target.ancestor("ul.share-options-list li, ul.share-services li, ul.share-services-small li",!0)?Y.shareThisV3Triggers.handleClick(e):e.target.ancestor("form#grab-link input",!0)?function(e){"gp-short-url"===e.target.get("id")?function(){var text_box,check_box,new_url;text_box=menuNode.one("#share-options-grablink-input"),(check_box=menuNode.one("#short-url input"))&&(new_url=check_box.get("checked")?check_box.getAttribute("data-url-short"):check_box.getAttribute("data-url-long"));new_url&&(text_box.set("value",new_url),text_box.select())}():e.target.hasClass("gp-type")?menuNode.one("form#grab-link input.gp-type:checked")?menuNode.one("#gp-add-button").replaceClass("DisabledButt","Butt"):menuNode.one("#gp-add-button").replaceClass("Butt","DisabledButt"):"gp-add-button"===e.target.get("id")&&(e.preventDefault(),e.target.hasClass("DisabledButt")||window.setTimeout(function(){get_fragments(["menu-grab-the-link"],{reload:!0,guestpass:!0})},10))}(e):e.target.ancestor("form#sharing-get-html-form input",!0)&&function(e){var targetId=e.target.get("id");"code-type-bbcode"!==targetId&&"code-type-html"!==targetId&&"code-type-playr"!==targetId||updateEmbedCode()}(e)}function checkServicesPanel(panel_node){(panel_node=panel_node||menuNode.one("."+open_panel_class))&&"services"===panel_node.getAttribute("data-panel-name")&&function(nodes){if(nodes&&nodes.one("li")){var container_width=nodes.one("li").get("offsetWidth"),truncate_nodes=nodes.all(".service-username");truncate_nodes&&truncate_nodes.each(function(){this.getAttribute("data-truncated")||!function checkServiceLabel(container,container_width,label){var html=label.get("innerHTML"),has_ellipsis=html.match(/\.\.\./),html_length=html.length-(has_ellipsis?3:0),width=container.get("offsetWidth");container_width<width&&8<html_length&&(label.set("innerHTML",html.substr(0,html.length-(has_ellipsis?4:1))+"..."),checkServiceLabel.apply(this,arguments));container.setAttribute("data-truncated",1)}(this,container_width,this.one(".service-truncated"))})}}(panel_node)}function checkDeferredPanels(panel_node){(panel_node=panel_node||menuNode.one("."+open_panel_class))&&panel_node.hasClass(deferred_panel_class)&&("share-options-grablink"===panel_node.get("id")?get_fragments(["menu-grab-the-link"]):"share-options-services"===panel_node.get("id")&&get_fragments(["menu-services"]),panel_node.removeClass(deferred_panel_class))}function openPanel(panel_node){var panel_node_inner_node,panel_node_header_node,open_panel_node,open_panel_node_inner_node,open_panel_node_header_node,opened_height,closed_height,animOpenLi,animOpenHd,animCloseLi,animCloseHd,panel_name,panelPrefMap;if(!panel_node||panel_node.hasClass(open_panel_class))return!1;checkServicesPanel(open_panel_node=menuNode.one("."+open_panel_class)),checkDeferredPanels(panel_node),panel_node_header_node=panel_node.one(".share-options-header"),(panel_node_inner_node=panel_node.one(".share-options-inner")).setStyle("display","block"),opened_height=panel_node_inner_node.get("offsetHeight")+parseInt(panel_node_inner_node.getComputedStyle("marginTop"),10)+parseInt(panel_node_inner_node.getComputedStyle("marginBottom"),10)+panel_node_header_node.get("offsetHeight")+parseInt(panel_node_header_node.getComputedStyle("marginTop"),10)+parseInt(panel_node_header_node.getComputedStyle("marginBottom"),10),(animOpenLi=new Y.Anim({node:panel_node,to:{height:opened_height},duration:.42,easing:Y.Easing.easeBoth})).on("end",function(){panel_node.setStyle("height",""),panel_node.addClass(open_panel_class)}),(!Y.UA.ie||8<=Y.UA.ie)&&(animOpenHd=new Y.Anim({node:panel_node_header_node,from:{backgroundColor:"#0063DC",color:"#ffffff"},to:{backgroundColor:"#ffffff",color:"#000000"},duration:.42,easing:Y.Easing.easeBoth})).on("end",function(){panel_node_header_node.setStyle("backgroundColor",""),panel_node_header_node.setStyle("color","")}),open_panel_node&&(open_panel_node_header_node=open_panel_node.one(".share-options-header"),open_panel_node_inner_node=open_panel_node.one(".share-options-inner"),closed_height=open_panel_node_header_node.get("offsetHeight")+parseInt(open_panel_node_header_node.getComputedStyle("marginTop"),10)+parseInt(open_panel_node_header_node.getComputedStyle("marginBottom"),10),(animCloseLi=new Y.Anim({node:open_panel_node,to:{height:closed_height},duration:.25,easing:Y.Easing.easeBoth})).on("end",function(){open_panel_node.setStyle("height",""),open_panel_node.removeClass(open_panel_class),open_panel_node_inner_node.setStyle("display","none")}),(!Y.UA.ie||8<=Y.UA.ie)&&(animCloseHd=new Y.Anim({node:open_panel_node_header_node,from:{backgroundColor:"#ffffff",color:"#000000"},to:{backgroundColor:"#F6F6F6",color:"#0063dc"},duration:.25,easing:Y.Easing.easeBoth})).on("end",function(){open_panel_node_header_node.setStyle("backgroundColor",""),open_panel_node_header_node.setStyle("color","")}),animCloseLi.run(),animCloseHd&&animCloseHd.run()),panel_name=panel_node.getAttribute("data-panel-name"),animOpenLi.run(),animOpenHd&&animOpenHd.run(),checkServicesPanel(panel_node),panelPrefMap={services:1,link:2,embed:3,party:0},panel_name&&panelPrefMap[panel_name]&&(openPanel.pending&&(window.clearTimeout(openPanel.pending),openPanel.pending=void 0),openPanel.pending=window.setTimeout(function(){Y.flickrAPI.callMethod("flickr.prefs.setPrefs",{share_this_panel:panelPrefMap[panel_name]})},2e3))}function getMoreNode(){return buttonListNode&&buttonListNode.one(".share-dropdown-arrow")}function updateEmbedCode(){var idMap,typePrefMap,sizePrefMap,size,type,visible_textarea_id;idMap={playr:{Thumbnail:"share-options-embed-textarea-t-playr",Square:"share-options-embed-textarea-sq-playr","Large Square":"share-options-embed-textarea-q-playr",Small:"share-options-embed-textarea-s-playr","Small 320":"share-options-embed-textarea-n-playr",Medium:"share-options-embed-textarea-m-playr","Medium 640":"share-options-embed-textarea-z-playr","Medium 800":"share-options-embed-textarea-c-playr",Large:"share-options-embed-textarea-l-playr","Large 1600":"share-options-embed-textarea-h-playr","Large 2048":"share-options-embed-textarea-k-playr",Original:"share-options-embed-textarea-o-playr"},html:{Thumbnail:"share-options-embed-textarea-t",Square:"share-options-embed-textarea-sq","Large Square":"share-options-embed-textarea-q",Small:"share-options-embed-textarea-s","Small 320":"share-options-embed-textarea-n",Medium:"share-options-embed-textarea-m","Medium 640":"share-options-embed-textarea-z","Medium 800":"share-options-embed-textarea-c",Large:"share-options-embed-textarea-l","Large 1600":"share-options-embed-textarea-h","Large 2048":"share-options-embed-textarea-k",Original:"share-options-embed-textarea-o"},bbcode:{Thumbnail:"share-options-embed-textarea-t-bbcode",Square:"share-options-embed-textarea-sq-bbcode","Large Square":"share-options-embed-textarea-q-bbcode",Small:"share-options-embed-textarea-s-bbcode","Small 320":"share-options-embed-textarea-n-bbcode",Medium:"share-options-embed-textarea-m-bbcode","Medium 640":"share-options-embed-textarea-z-bbcode","Medium 800":"share-options-embed-textarea-c-bbcode",Large:"share-options-embed-textarea-l-bbcode","Large 1600":"share-options-embed-textarea-h-bbcode","Large 2048":"share-options-embed-textarea-k-bbcode",Original:"share-options-embed-textarea-o-bbcode"}},typePrefMap={html:0,bbcode:1},Y.config.flickr.flags.enable_playr&&(typePrefMap={html:2,bbcode:1,playr:0}),sizePrefMap={Square:1,Thumbnail:2,Small:3,Medium:4,"Medium 640":5,Large:6,Original:7,"Large Square":8,"Small 320":9,"Medium 800":10,"Large 1600":11,"Large 2048":12},size=Y.one("#sharing_size").get("value"),visible_textarea_id=idMap[type=Y.one("#code-type-bbcode").get("checked")?"bbcode":Y.one("#code-type-playr")&&Y.one("#code-type-playr").get("checked")?"playr":"html"][size],Y.all(".embed-markup").each(function(node){node.setStyle("display","none")}),Y.one("#"+visible_textarea_id).setStyle("display","block"),updateEmbedCode.pending&&(window.clearTimeout(updateEmbedCode.pending),updateEmbedCode.pending=void 0),updateEmbedCode.pending=window.setTimeout(function(){Y.flickrAPI.callMethod("flickr.prefs.setPrefs",{photo_embed_type:typePrefMap[type],photo_embed_size_new:sizePrefMap[size]})},2e3)}function attachPanelEvents(){!panel_events.embed_size_change_handle&&Y.one("#sharing_size")&&(panel_events.embed_size_change_handle=Y.one("#sharing_size").on("change",function(e){updateEmbedCode()}))}function disableButtons(){var li_nodes;buttonListNode&&(li_nodes=buttonListNode.all(".share-this-v3"))&&li_nodes.size()&&li_nodes.each(function(node){var anchor,butt=node.one(".Butt, .DisabledButt");butt&&(butt.removeClass("Butt").addClass("DisabledButt share-disabled"),(anchor=butt.one("a"))&&(anchor.removeAttribute("data-service-type-id"),anchor.removeAttribute("data-service-id"),anchor.removeAttribute("data-service-needs-setup")))})}function getCurrentObjectKey(){return Y.JSON.stringify(Y.config.flickr.sharing.object)}function get_fragments(fragments,config){var object_key,memo,fragment_definitions,io_cfg,validated_fragments=[],url="/share.gne",url_params=[];return!!fragments&&(Y.Lang.isString(fragments)&&(fragments=[fragments]),!!Y.Lang.isArray(fragments)&&(config=config||{},object_key=getCurrentObjectKey(),fragment_definitions={buttons:{on:{start:function(){return!!buttonListNode&&(!isExtra&&(disableButtons(),!0))},success:function(html){var new_nodes;buttonListNode&&(new_nodes=Y.Node.create(html))&&(buttonListNode.all(".share-this-v3").remove(),Y.config.flickr.flags.enable_2013_photo_page&&(isPhotoPage||isFavePage)?buttonListNode.all(".divider").insert(new_nodes,"before"):buttonListNode.append(new_nodes),menu.set("button_node",getMoreNode()),postUploadMenu&&postUploadMenu.set("button_node",Y.one("#post-upload-share-more-button")))}}},"menu-grab-the-link":{on:{start:function(){return config.reload&&(memo["menu-grab-the-link"].placeholder_node||(memo["menu-grab-the-link"].placeholder_node=menuNode.one("#share-options-grablink ."+placeholder_class),memo["menu-grab-the-link"].placeholder_node||(memo["menu-grab-the-link"].placeholder_node=menuNode.one("#share-options-grablink .share-options-inner"))),config.guestpass&&(url_params.push("guestpass=1"),memo["menu-grab-the-link"].placeholder_node.all("form#grab-link input.gp-type:checked").each(function(node){url_params.push(node.getAttribute("name")+"=1")})),memo["menu-grab-the-link"].loaded=!1,memo["menu-grab-the-link"].placeholder_node.addClass(placeholder_class),memo["menu-grab-the-link"].placeholder_node.set("innerHTML","")),!memo["menu-grab-the-link"].loaded&&(menuNode.one("form#grab-link")?!(memo["menu-grab-the-link"].loaded=!0):memo["menu-grab-the-link"].placeholder_node||(memo["menu-grab-the-link"].placeholder_node=menuNode.one("#share-options-grablink ."+placeholder_class),memo["menu-grab-the-link"].placeholder_node)?(memo["menu-grab-the-link"].placeholder_node.set("innerHTML","").addClass(placeholder_class),!0):(Y.log("Missing placeholder node","error","share-this-v3-menu"),!1))},success:function(html){memo["menu-grab-the-link"].loaded=!0,memo["menu-grab-the-link"].placeholder_node.set("innerHTML",html),config.guestpass&&"photo"===Y.config.flickr.page_type&&Y.photo&&Y.photo.getCurrentPhoto&&Y.use("photo-data",function(Y){var photo_data_object=Y.photo.getCurrentPhoto();photo_data_object&&photo_data_object.increment("guestpass_count")})},failure:function(){memo["menu-grab-the-link"].placeholder_node.set("innerHTML",Y.transjax.get("share-menu","grab_the_link_fragment_error"))},complete:function(){memo["menu-grab-the-link"].placeholder_node.removeClass(placeholder_class)}}},"menu-services":{on:{start:function(){return config.reload&&(memo["menu-services"].placeholder_node||(memo["menu-services"].placeholder_node=menuNode.one("#share-options-services ."+placeholder_class),memo["menu-services"].placeholder_node||(memo["menu-services"].placeholder_node=menuNode.one("#share-options-services .share-options-inner"))),memo["menu-services"].loaded=!1,memo["menu-services"].placeholder_node.addClass(placeholder_class),memo["menu-services"].placeholder_node.set("innerHTML","")),!memo["menu-services"].loaded&&(menuNode.one("ul.share-services")?!(memo["menu-services"].loaded=!0):!(!memo["menu-services"].placeholder_node&&(memo["menu-services"].placeholder_node=menuNode.one("#share-options-services ."+placeholder_class),!memo["menu-services"].placeholder_node))||(Y.log("Missing placeholder node","error","share-this-v3-menu"),!1))},success:function(html){memo["menu-services"].loaded=!0,memo["menu-services"].placeholder_node.removeClass(placeholder_class),memo["menu-services"].placeholder_node.set("innerHTML",html)},failure:function(id,o,args){memo["menu-services"].placeholder_node.set("innerHTML",Y.transjax.get("share-menu","services_fragment_error"))},complete:function(){memo["menu-services"].placeholder_node.removeClass(placeholder_class)}}},"menu-full":{on:{start:function(){return Y.Object.each(panel_events,function(handle,key){handle&&handle.detach&&(handle.detach(),panel_events[key]=void 0)}),!0},success:function(html){menuNode&&menuNode.set("innerHTML",html),attachPanelEvents(),config.menuCallback&&config.menuCallback()}}}},get_fragments.memo||(get_fragments.memo={},Y.Object.each(fragment_definitions,function(val,fragment_id){get_fragments.memo[fragment_id]={fetching:{}}})),memo=get_fragments.memo,Y.Array.each(fragments,function(fragment_id,idx){if(memo[fragment_id].fetching[object_key])return!1;fragment_definitions[fragment_id].on.start.apply(window)&&validated_fragments.push(fragment_id)}),0!==validated_fragments.length&&(Y.config.flickr.sharing.object.id&&url_params.push("object_id="+Y.config.flickr.sharing.object.id),Y.config.flickr.sharing.object.type&&url_params.push("object_type="+Y.config.flickr.sharing.object.type),Y.config.flickr.sharing.object.owner_nsid&&(url_params.push("owner_nsid="+Y.config.flickr.sharing.object.owner_nsid),url_params.push("object_owner_nsid="+Y.config.flickr.sharing.object.owner_nsid)),url_params.push("cachebust="+(new Date).getTime()),url_params.push("action=retrieve_fragments"),Y.Array.each(validated_fragments,function(fragment_id){url_params.push("fragments[]="+fragment_id)}),"photo"===F.config.flickr.page_type&&url_params.push("is_photo_page=true"),url=url+"?"+(url_params=url_params.join("&")),io_cfg={on:{success:function(id,o){var html=o.responseText.split("\x3c!-- Fragment --\x3e");Y.Array.each(validated_fragments,function(fragment_id,idx){object_key===getCurrentObjectKey()&&(Y.Lang.isFunction(fragment_definitions[fragment_id].on.success)&&fragment_definitions[fragment_id].on.success.apply(window,[html[idx]]),Y.Lang.isFunction(fragment_definitions[fragment_id].on.complete)&&fragment_definitions[fragment_id].on.complete.apply(window,[])),delete memo[fragment_id].fetching[object_key]})},failure:function(id,o){var args=arguments;Y.Array.each(validated_fragments,function(fragment_id){object_key===getCurrentObjectKey()&&(Y.Lang.isFunction(fragment_definitions[fragment_id].on.failure)&&fragment_definitions[fragment_id].on.failure.apply(window,args),Y.Lang.isFunction(fragment_definitions[fragment_id].on.complete)&&fragment_definitions[fragment_id].on.complete.apply(window,[])),delete memo[fragment_id].fetching[object_key]})}}},Y.Array.each(validated_fragments,function(fragment_id){memo[fragment_id].fetching[object_key]=!0}),void Y.io(url,io_cfg))))}Y.shareThisV3Menu={init:function(config){var more_hover_handle,localPlacement,popover,options=config||{};function initMenu(){menu=Y.menus.add({id:"share-menu-v3",popover:popover,context:"share-menu",button_node:options.button_node||getMoreNode(),constrain_node:isRefresh?Y.one(document.body):null,scroll:!isExtra||(isPhotoStream||isSet||isFaves||isGroups)&&!Y.config.flickr.flags.enable_justified_view_inline_sharing?null:options.scroll,onHide:function(){options&&options.onHide&&options.onHide()}})}localPlacement=options.localPlacement||"#photo-actions #stats_ul",(menuNode=Y.one("#share-menu-v3"))||Y.log("share menu v3:: WARN: Could not find menuNode","error","share-this-v3-menu"),(postUploadShareNode=Y.one("#post-upload-actions"))&&Y.shareThisV3Triggers.listen(postUploadShareNode),(buttonListNode=Y.one("#share-buttons, "+(isRefresh&&isPhotoPage?"#stats_ul":"#button-bar")))&&(Y.shareThisV3Triggers.listen(buttonListNode),Y.config.flickr.is_touch_device||(more_hover_handle=buttonListNode.on("mouseover",function(e){getMoreNode().contains(e.target)&&(more_hover_handle.detach(),checkDeferredPanels())}))),menuNode&&(menuNode.on("click",handleMenuClick),menuNode.on("mousedown",handleMenuMouseDown),menuNode.on("mouseup",handleMenuMouseUp),Y.config.flickr.is_touch_device||menuNode.on("mouseover",Y.betterThrottle(function(e){var panel_node=e.target.ancestor("li."+deferred_panel_class,!0);panel_node&&checkDeferredPanels(panel_node)},100)),attachPanelEvents(),(popover=new Y.Popover({srcNode:"#share-menu-v3",visible:!1,width:"400px",accordian:!0,arrowPosition:options.arrowPosition||"tr",isRefresh:options.overrideRefresh||isRefresh,refreshBottom:options.bottom||"37px",refreshRight:options.right||"66px",showSquare:showSquare,extraCSS:showSquare?"square-menu-css":""})).on("visibleChange",function(e){e.newVal&&(checkServicesPanel(),checkDeferredPanels())}),popover.render(isRefresh&&!options.overrideRefresh?Y.one(localPlacement):void 0),Y.one("#post-upload-share-more-button")?(postUploadMenu=Y.menus.add({id:"share-menu-v3",popover:popover,context:"share-menu",button_node:Y.one("#post-upload-share-more-button")}),Y.on("postUploadSharing:close",initMenu)):initMenu()),Y.on("shareDialog:servicesAuthComplete",function(){menu&&menu.hide(),disableButtons(),window.setTimeout(function(){get_fragments(isExtra?["menu-services"]:["buttons","menu-services"],{reload:!0})},1e3)}),Y.config.flickr.sharing.shareability_is_unknown&&get_fragments(isExtra?["menu-full"]:["buttons","menu-full"],{menuCallback:options.afterInit}),F.actionQueue&&Y.Lang.isObject(F.actionQueue)&&(F.actionQueue["share-this-v3-more-button"]={display_share:function(){menu&&menu.show()}},F.actionQueue.module_loaded("share-this-v3-more-button")),Y.fire("shareMenu:initialized"),initialized=!0},show:function(){menu.show()},hide:function(){menu&&menu.hide()},openPanel:openPanel,disableButtons:disableButtons,refresh:function(callback,noButtons){get_fragments(noButtons?["menu-full"]:["buttons","menu-full"],{menuCallback:callback})},clear:function(){var li_nodes;buttonListNode&&(li_nodes=buttonListNode.all(".share-this-v3"))&&li_nodes.size()&&li_nodes.remove()},getMenu:function(){return menu},isInitialized:function(){return initialized}}},"0.0.1",{requires:F.config.modules["share-this-v3-menu"].requires||[],optional:F.config.modules["share-this-v3-menu"].optional||[]});!function(){var module_id="refresh-sihp-comment";YUI.add(module_id,function(Y){function refreshSIHPComment(config){!function(config){var containerNode;if(!Y.Lang.isObject(config))return console.warn("["+module_id+"]","No config");containerNode=config.container,Y.Lang.isString(containerNode)&&(containerNode=Y.one(containerNode));if(!Y.Lang.isObject(containerNode)||!containerNode.getDOMNode)return console.warn("["+module_id+"]","No container node");options=config,containerNode.delegate("click",handleCommentIconClick,config.commentIconSelector),containerNode.delegate("click",handleReplyClick,config.commentReplySelector||".comment-reply"),Y.config.flickr.flags.enable_feed_reskin&&(containerNode.delegate("click",handleNewReplyClick,".reply"),containerNode.delegate("click",handleDeleteComment,".delete"));Y.config.flickr.flags.enable_feed_reskin||loadCommentsCards(containerNode);dismissEvent="refresh-sihp-comment:dismiss-dialog",Y.on(dismissEvent,dismissCommentsPopover)}(config)}var options,dismissEvent,comment_backup={};function handleDeleteComment(e){e.preventDefault(),e.target.ancestor(".comment-wrapper").setStyle("opacity",".2");var commentId=e.target.getData("comment-id"),photoId=e.target.getData("photo-id"),userId=e.target.getData("user-id"),viewerNSID=e.target.getData("viewer-nsid");Y.flickrAPI.callMethod("flickr.photos.comments.deleteComment",{comment_id:userId+"-"+photoId+"-"+commentId,viewerNSID:viewerNSID},{success:function(response){e.target.ancestor(".comment-wrapper").remove(!0)},failure:function(error){console.error("Error deleting comment",error),e.target.ancestor(".comment-wrapper").setStyle("opacity","1")}})}function handleNewReplyClick(e){e.preventDefault();var formHTML,container=e.target.ancestor(".card-comment");Y.config.flickr.user.icon_url;Y.one("#comment-form")&&Y.one("#comment-form").remove(!0),formHTML='<form action="photo_comments_fragment.gne?photo='+e.target.getData("photo-id")+'" method="post" id="comment-form">',formHTML+='<img class="buddyicon" src="'+Y.config.flickr.user.icon_url+' width="32" height="32">',formHTML+='<input type="hidden" name="magic_cookie" value="'+Y.config.flickr.magic_cookie+'">',formHTML+='<input type="hidden" class="photo" name="photo" value="'+e.target.getData("photo-id")+'">',formHTML+='<input type="hidden" name="addcomment" value="1">',formHTML+='<textarea rows="2" cols="80" type="text" class="message" name="message" rows="8" tabindex="2" placeholder="Add a comment" aria-label="Add your comment"></textarea>',formHTML+='<input type="submit" class="submit-comment" name="submit" value="Comment" rows="8" tabindex="2" placeholder="Add a comment" aria-label="Add your comment">',formHTML+="</form>",container.append(formHTML);var form=container.one("#comment-form");function form_submitter(e){var photoId,message,ioConfig,container;e.preventDefault(),photoId=e.target.one(".photo").get("value"),message=encodeURIComponent(e.target.one(".message").get("value")),container=e.target.ancestor(".card-comment").one(".action-author"),ioConfig={method:"post",data:"magic_cookie="+Y.config.flickr.magic_cookie+"&photo="+photoId+"&addcomment=1&flash_ver=unknown&hide-meta=true&sort=date-posted-desc&limit=4&feed=1&message="+message+"&page_type="+Y.config.flickr.page_type,on:{success:function(id,o,args){container.set("innerHTML",o.responseText),e.target.remove(!0)},failure:function(obj,xhr){console.error("Failure",obj,xhr)}}},Y.io("/photo_comments_fragment_2013.gne?cachebust="+(new Date).getTime(),ioConfig)}form.one(".message").focus(),e.target.getData("commenter-id")&&form.one(".message").set("text","[https://www.flickr.com/photos/"+e.target.getData("commenter-id")+"] "),form.one(".message").on("keydown",function(e){13===e.keyCode&&(e.metaKey||e.ctrlKey)&&(e.target=form,form_submitter(e))}),form.on("submit",form_submitter)}function handleCommentIconClick(e){if(e.preventDefault&&e.preventDefault(),Y.shareThisV3Menu.isInitialized()&&Y.shareThisV3Menu.hide(),!e.target.ancestor(options.commentButtonNodeSelector,!0).hasClass("loading")){var container_node=e.target.ancestor(options.photoContainerSelector),comment_container=options.commentContainerSelector?container_node.ancestor(options.commentContainerSelector):container_node,photo_node=options.photoNodeSelector?container_node.one(options.photoNodeSelector):container_node,commentButtonNode=e.target.ancestor(options.commentButtonNodeSelector,!0),photo_id=photo_node.getAttribute("data-photo-id"),arrowRightOffset=(Y.one(options.container).getComputedStyle("width"),photo_node.get("offsetHeight"),options.arrowOffset||39);if(e.target.ancestor(".leftPortrait")&&(arrowRightOffset+=267),Y.one(".comments-popover-"+photo_id))dismissCommentsPopover();else{Y.one(".comments-popover")&&dismissCommentsPopover(),Y.all(".comments-popover")&&Y.all(".comments-popover").remove(),Y.all(options.commentIconSelector)&&Y.all(options.commentIconSelector).removeClass("active"),totalComments=parseInt(photo_node.getAttribute("data-comments-total-count"),10),commentButtonNode.one(".li_icon")?commentButtonNode.one(".li_icon").remove():options.onLoading&&options.onLoading(commentButtonNode),Y.config.flickr.flags.enable_feed_reskin&&"sihp"===Y.config.flickr.page_type||commentButtonNode.append('<span class="html5-balls"><span class="blueball"></span><span class="pinkball"></span></span>'),commentButtonNode.addClass("loading");var offset=totalComments<=4?0:totalComments-4,io_cfg={method:"post",data:"magic_cookie="+Y.config.flickr.magic_cookie+"&photo="+photo_id+"&offset="+offset+"&limit=4&show-chrome=true&view-more-count=20&truncate-comment-body=120&hide-meta=true&is-form=true&page_type="+Y.config.flickr.page_type,on:{success:function(id,o,args){var postNode,arrowNode;if(Y.config[module_id].open_cards[parseInt(photo_id,10)]=!0,comment_container.append('<div id="comments" class="comments-popover comments-popover-'+photo_id+'"><div class="arrow"></div><div class="comments-inner">'+o.responseText+"</div></div>"),options.edgeDetection){if(commentButtonNode.getX()<570)comment_container.one("#comments").setStyle("right",""),comment_container.one("#comments").setStyle("left","10px"),cardWidth=(cardWidth=comment_container.getComputedStyle("width")).replace("px",""),cardWidth=parseInt(cardWidth,10),arrowRightOffset=cardWidth-75+10;if(commentButtonNode.getY()<570){cardHeight=(cardHeight=comment_container.getComputedStyle("height")).replace("px",""),cardHeight=parseInt(cardHeight,10),comment_container.one("#comments").setStyle("top",cardHeight-3+"px"),comment_container.one("#comments").setStyle("bottom","inherit");var arrow=comment_container.one(".arrow"),currentBottom=arrow.getStyle("bottom");currentBottom=currentBottom.replace("px",""),currentBottom=parseInt(currentBottom,10),arrow.setStyle("top",currentBottom),arrow.setStyle("bottom","inherit"),arrow.setStyle("borderBottomColor",arrow.getStyle("borderTopColor")),arrow.setStyle("borderTopColor","transparent")}}else{var cardHeight;if(container_node.hasClass("topRightLandscapeContainer"))(cardHeight=comment_container.getComputedStyle("height"))&&(cardHeight=parseInt(cardHeight.replace("px",""),10),comment_container.one("#comments").setStyle("bottom",cardHeight/2+37+"px"));else if(container_node.hasClass("leftPortraitContainer")){var cardWidth;comment_container.one("#comments").setStyle("right",""),comment_container.one("#comments").setStyle("left","10px"),cardWidth=(cardWidth=comment_container.getComputedStyle("width")).replace("px",""),cardWidth=parseInt(cardWidth/2+"px",10),arrowRightOffset=cardWidth-75}}commentButtonNode.one(".html5-balls")&&commentButtonNode.one(".html5-balls").remove(),commentButtonNode.removeClass("loading"),commentButtonNode.addClass("active"),options.onSuccess?options.onSuccess(container_node,commentButtonNode,totalComments):commentButtonNode.append('<span class="li_icon"></span>'),(postNode=comment_container.one(".submit-comment")||comment_container.one(".comment-button-post"))&&(postNode.on("click",function(e){handlePostComment(e,photo_id)}),comment_container.one("textarea").on("keydown",function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)&&handlePostComment(e,photo_id)})),comment_container&&comment_container.one("form #message")&&(comment_container.one("form #message").on("keyup",function(e){comment_backup[photo_id]=e.target.get("value")}),comment_backup[photo_id]&&comment_container.one("form #message").set("value",comment_backup[photo_id])),commentButtonNode.hasClass("counter1")?arrowRightOffset+=5:commentButtonNode.hasClass("counter2")?arrowRightOffset+=9:commentButtonNode.hasClass("counter3")&&(arrowRightOffset+=13),(arrowNode=comment_container.one(".arrow"))&&(options.edgeDetection&&commentButtonNode.getX()<570||container_node.hasClass("leftPortraitContainer")?arrowNode.setStyle("left",arrowRightOffset+"px"):arrowNode.setStyle("right",arrowRightOffset+"px")),Y.one("#load-more-next-comments")&&Y.one("#load-more-next-comments").hide();var shimWidth=window.innerWidth+1e3;container_node.append("<div class='popover-shim' style='position: fixed; top: 0; left: -500px; height: 2000px; width: "+shimWidth+"px; z-index: 1;'></div>"),Y.one(".popover-shim")&&Y.one(".popover-shim").on("click",dismissCommentsPopover),Y.keyboardShortcutManager.register({keystring:"27",handler:dismissCommentsPopover,context:"*"});try{options.edgeDetection&&commentButtonNode.getY()<570?comment_container.one(".comment-content textarea").vis.animScrollIntoView({bottom:!0,top:!1,onfinish:function(){comment_container.one(".comment-content textarea").focus()}},100,!0):comment_container.one(".comment-content textarea").focus()}catch(ex){}comment_container.one("form #message")&&comment_container.one("form #message").focus()},failure:function(id,o,args){commentButtonNode.one(".html5-balls").remove(),options.onSuccess?options.onSuccess(container_node,commentButtonNode,totalComments):commentButtonNode.append('<span class="li_icon"></span>'),showError(Y.transjax.get("photo-comments","error_getting_comments"))}}};Y.io("/photo_comments_fragment_2013.gne?cachebust="+(new Date).getTime(),io_cfg)}}}function handlePostComment(e,photo_id){e.preventDefault();var imgWrapper,containerNode=e.target.ancestor(options.photoContainerSelector)||e.target.ancestor(options.commentContainerSelector),photo_node=containerNode.one(options.photoNodeSelector+"[data-photo-id="+photo_id+"]")?containerNode.one(options.photoNodeSelector+"[data-photo-id="+photo_id+"]"):options.commentContainerSelector?e.target.ancestor(options.commentContainerSelector):containerNode,comment_container=containerNode.ancestor(options.commentContainerSelector)||containerNode,comments_node=comment_container.one(".comments-popover, .comments-overlay"),commentButtonNode=photo_node.one(options.commentButtonNodeSelector),isPopover=!!comment_container.one(".comments-popover"),commentCountStr=photo_node.getAttribute("data-comments-total-count"),totalComments=parseInt(""===commentCountStr?0:commentCountStr,10);if(Y.config.flickr.flags.enable_grease&&!Y.config.flickr.user.nsid&&Y.grease){var comment=encodeURIComponent(comments_node.one("form #message").get("value"));return Y.grease.postComment(comment,photo_id),Y.grease.authenticate(function(success){}),!1}var io_cfg={method:"post",data:"magic_cookie="+Y.config.flickr.magic_cookie+"&photo="+photo_id+"&addcomment=1flash_ver=unknown&offset="+(totalComments-3)+"&limit=4&show-chrome=true&view-more-count=20&truncate-comment-body="+truncateLengthBasedOnActivityFeedWidth(2)+"&hide-meta=true&message="+encodeURIComponent(comments_node.one("form #message").get("value")),on:{success:function(id,o,args){var photoID,problemNode=o.responseText.trim().length?Y.Node.create(o.responseText).one(".Problem"):void 0;if(problemNode||0===o.responseText.trim().length||0===comments_node.one("form #message").get("value").trim().length)return problemNode&&"An empty comment box? That won't work!"===problemNode.get("text")?showError(Y.transjax.get("photo-comments","error_empty_body")):showError(Y.transjax.get("photo-comments","error_add_generic")),void(comments_node.one(".comments-inner")?(comments_node.one(".comments-inner .html5-balls").remove(),comments_node.one(".comments-inner form").show()):(comments_node.one(".comment-content .html5-balls").remove(),comments_node.one(".comment-content form").show()));if(comment_backup={},isPopover){var counterClass,newCount=totalComments+1;imgWrapper=photo_node.get("parentNode"),commentButtonNode.setAttribute("class",""),newCount<10?(commentButtonNode.addClass("counter1"),counterClass="counter1"):newCount<100?(commentButtonNode.addClass("counter2"),counterClass="counter2"):(commentButtonNode.addClass("counter3"),counterClass="counter3",commentButtonNode.one(options.counterSelector||".li_counter").hide(),commentButtonNode.one(".li_99_plus")&&commentButtonNode.one(".li_99_plus").show()),Y.config.flickr.flags.enable_feed_reskin?(commentButtonNode.addClass(options.commentButtonNodeClass||" comments"),commentButtonNode.addClass("rapidnofollow"),commentButtonNode.removeClass("active"),commentButtonNode.one(options.counterSelector||"span.counter").set("text",newCount)):(commentButtonNode.addClass(options.commentButtonNodeClass||"il_comments"),commentButtonNode.addClass("rapidnofollow"),commentButtonNode.removeClass("active"),commentButtonNode.one(options.counterSelector||".li_counter").set("text",newCount)),imgWrapper.get("parentNode").hasClass("card-bundle")&&(photoID=photo_node.getAttribute("data-photo-id"),imgWrapper.one(".id"+photoID).setAttribute("data-comment_class",counterClass).setAttribute("data-comment_count",newCount)),dismissCommentsPopover()}else comments_node.one(".comments-inner").set("innerHTML",o.responseText),comments_node.one(".comment-button-post")&&comments_node.one(".comment-button-post").on("click",function(e){handlePostComment(e,photo_id)});photo_node.setAttribute("data-comments-total-count",totalComments+1)},failure:function(obj,xhr){comments_node.one(".comment-content .html5-balls").remove(),comments_node.one(".comment-content form").show(),comments_node.one(".comment-content textarea").focus(),showError(Y.transjax.get("photo-comments","error_add_generic"))}}};comments_node.one(".comments-inner form")?(comments_node.one(".comments-inner form").hide(),comments_node.one(".comments-inner").append('<span class="html5-balls"><span class="blueball"></span><span class="pinkball"></span></span>')):(comments_node.one(".comment-content form").hide(),comments_node.one(".add-comment-form .comment-content").append('<span class="html5-balls"><span class="blueball"></span><span class="pinkball"></span></span>')),Y.io("/photo_comments_fragment_2013.gne?cachebust="+(new Date).getTime(),io_cfg)}function loadCommentsCards(activity){activity.all(".card-comment").each(function(node){if(!node.one(".comments-overlay")){var photoNode=node,photoID=photoNode.getAttribute("data-photo-id"),commentsNode=photoNode.one(".commentsWrapper");totalComments=parseInt(photoNode.getAttribute("data-comments-total-count"));var io_cfg={method:"post",data:"magic_cookie="+Y.config.flickr.magic_cookie+"&photo="+photoID+"&offset="+(totalComments-4)+"&limit=4&show-chrome=true&view-more-count=20&truncate-comment-body="+truncateLengthBasedOnActivityFeedWidth(2)+"&hide-meta=true",on:{success:function(id,o,args){var postNode;commentsNode&&(commentsNode.one(".comments-overlay")||(commentsNode.one(".action-view-comments")&&commentsNode.one(".action-view-comments").remove(),commentsNode.append('<div id="comments" class="comments-overlay"><div class="comments-inner">'+o.responseText+"</div></div>"),(postNode=commentsNode.one(".comment-button-post"))&&postNode.on("click",function(e){handlePostComment(e,photoID)}),Y.refreshSIHPSidebar.updateConfig()))},failure:function(id,o,args){}}};Y.io("/photo_comments_fragment_2013.gne?cachebust="+(new Date).getTime(),io_cfg)}})}function truncateLengthBasedOnActivityFeedWidth(numberOfLines){return Y.one(options.container).get("offsetWidth")<=640?50*numberOfLines:70*numberOfLines}function handleReplyClick(e){var icon_link,buddy_icon;if(e.preventDefault(),(icon_link=e.target.ancestor(".comment-block").one(".comment-buddy-icon-link"))&&(buddy_icon="[http://www.flickr.com/photos/"+icon_link.get("href").replace(/^.*?\/photos\/(.*?)\/$/,"$1")+"]"),buddy_icon){var text=buddy_icon+" ";e.target.ancestor(".comments-inner").one("#message").focus(),e.target.ancestor(".comments-inner").one("#message").set("value",text)}}function showError(msg){(showError.alert=showError.alert||new Y.FlickrDialog.Alert({message:msg,width:280})).show()}Y.config[module_id]=Y.config[module_id]||{open_cards:{}};var dismissCommentsPopover=function(){var popover=Y.one(".comments-popover");if(popover){var shim=Y.one(".popover-shim"),containerNode=popover.ancestor(options.commentContainerSelector),commentButtonNode=containerNode.all(options.commentButtonNodeSelector||".il_comments");popover.remove(),Y.all(".comments-popover").remove(!0),shim.remove(),commentButtonNode.removeClass("active"),options.onDismiss&&options.onDismiss(containerNode),delete Y.config[module_id].open_cards[parseInt(containerNode.getData("photo-id"),10)],comment_backup={}}};refreshSIHPComment.prototype.dismissCommentsPopover=dismissCommentsPopover,refreshSIHPComment.prototype.loadCommentsCards=loadCommentsCards,refreshSIHPComment.prototype.openForNode=function(node){handleCommentIconClick({target:node.one(".comments-inline-btn")})},refreshSIHPComment.prototype.getDismissEvent=function(){return dismissEvent},Y.refreshSIHPComment=refreshSIHPComment},"0.0.1",{requires:F.config.modules[module_id].requires||[],optional:F.config.modules[module_id].optional||[]})}();if(void 0===deconcept)var deconcept=new Object;void 0===deconcept.util&&(deconcept.util=new Object),void 0===deconcept.SWFObjectUtil&&(deconcept.SWFObjectUtil=new Object),deconcept._playerVersion=null,deconcept.SWFObject=function(swf,id,w,h,ver,c,quality,xiRedirectUrl,redirectUrl,detectKey,_base){if(document.getElementById){this.DETECT_KEY=detectKey||"detectflash",this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY),this.params=new Object,this.variables=new Object,this.attributes=new Array,swf&&this.setAttribute("swf",swf),id&&this.setAttribute("id",id),w&&this.setAttribute("width",w),h&&this.setAttribute("height",h),this.setAttribute("base",_base||"."),ver&&this.setAttribute("version",new deconcept.PlayerVersion(ver.toString().split("."))),this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion(),!window.opera&&document.all&&7<this.installedVer.major&&(deconcept.SWFObject.doPrepUnload=!0),c&&this.addParam("bgcolor",c);var q=quality||"high";this.addParam("quality",q),this.setAttribute("useExpressInstall",!1),this.setAttribute("doExpressInstall",!1);var xir=xiRedirectUrl||window.location;this.setAttribute("xiRedirectUrl",xir),this.setAttribute("redirectUrl",""),redirectUrl&&this.setAttribute("redirectUrl",redirectUrl)}},deconcept.SWFObject.prototype={useExpressInstall:function(path){this.xiSWFPath=path||"expressinstall.swf",this.setAttribute("useExpressInstall",!0)},setAttribute:function(name,value){this.attributes[name]=value},getAttribute:function(name){return this.attributes[name]},addParam:function(name,value){this.params[name]=value},getParams:function(){return this.params},addVariable:function(name,value){this.variables[name]=value},getVariable:function(name){return this.variables[name]},getVariables:function(){return this.variables},getVariablePairs:function(){var key,variablePairs=new Array,variables=this.getVariables();for(key in variables)variablePairs[variablePairs.length]=key+"="+variables[key];return variablePairs},getSWFHTML:function(extraHTML){var swfNode="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","PlugIn"),this.setAttribute("swf",this.xiSWFPath)),swfNode='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"',swfNode+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" base="'+this.getAttribute("base")+'" ';var params=this.getParams();for(var key in params)swfNode+=[key]+'="'+params[key]+'" ';0<(pairs=this.getVariablePairs().join("&")).length&&(swfNode+='flashvars="'+pairs+'"'),swfNode+="/>"}else{this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","ActiveX"),this.setAttribute("swf",this.xiSWFPath)),swfNode='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">',swfNode+='<param name="movie" value="'+this.getAttribute("swf")+'" />',swfNode+='<param name="base" value="'+this.getAttribute("base")+'" />';var pairs;params=this.getParams();for(var key in params)swfNode+='<param name="'+key+'" value="'+params[key]+'" />';0<(pairs=this.getVariablePairs().join("&")).length&&(swfNode+='<param name="flashvars" value="'+pairs+'" />'),swfNode+="</object>"}return swfNode=(void 0!==extraHTML?extraHTML:"")+swfNode},write:function(elementId,extraHTML){if(this.getAttribute("useExpressInstall")){var expressInstallReqVer=new deconcept.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}return this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))?(("string"==typeof elementId?document.getElementById(elementId):elementId).innerHTML=this.getSWFHTML(extraHTML),!0):(""!=this.getAttribute("redirectUrl")&&document.location.replace(this.getAttribute("redirectUrl")),!1)}},deconcept.SWFObjectUtil.getPlayerVersion=function(){if(deconcept._playerVersion)return deconcept._playerVersion;var PlayerVersion=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){x.description.match(/[a-zA-Z\s]([0-9]+)\.([0-9]+)\s*[rbd]([0-9]+)/);var versionInfo=[RegExp.$1,RegExp.$2,RegExp.$3];navigator.platform.match(/win32/i)&&!versionInfo[0]&&(x.description.match(/[a-zA-Z\s]([0-9]+)\.([0-9]+|([0-9]+.[0-9]+.))\s*[rbd]([0-9]+)/),versionInfo=[RegExp.$1,RegExp.$2,RegExp.$3]),PlayerVersion=new deconcept.PlayerVersion(versionInfo)}}else if(navigator.userAgent&&0<=navigator.userAgent.indexOf("Windows CE"))for(var axo=1,counter=3;axo;)try{counter++,axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+counter),PlayerVersion=new deconcept.PlayerVersion([counter,0,0])}catch(e){axo=null}else{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");PlayerVersion=new deconcept.PlayerVersion([6,0,21]),axo.AllowScriptAccess="always"}catch(e){if(6==PlayerVersion.major)return PlayerVersion}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}null!=axo&&(PlayerVersion=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(",")))}return deconcept._playerVersion=PlayerVersion},deconcept.PlayerVersion=function(arrVersion){this.major=null!=arrVersion[0]?parseInt(arrVersion[0]):0,this.minor=null!=arrVersion[1]?parseInt(arrVersion[1]):0,this.rev=null!=arrVersion[2]?parseInt(arrVersion[2]):0},deconcept.PlayerVersion.prototype.versionIsValid=function(fv){return!(this.major<fv.major)&&(this.major>fv.major||!(this.minor<fv.minor)&&(this.minor>fv.minor||!(this.rev<fv.rev)))},deconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(null==param)return q;if(q)for(var pairs=q.substring(1).split("&"),i=0;i<pairs.length;i++)if(pairs[i].substring(0,pairs[i].indexOf("="))==param)return pairs[i].substring(pairs[i].indexOf("=")+1);return""}},deconcept.SWFObjectUtil.cleanupSWFs=function(){for(var objects=document.getElementsByTagName("OBJECT"),i=objects.length-1;0<=i;i--)for(var x in objects[i].style.display="none",objects[i])"function"==typeof objects[i][x]&&(objects[i][x]=function(){})},deconcept.SWFObject.doPrepUnload&&(deconcept.unloadSet||(deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload),deconcept.unloadSet=!0)),!document.getElementById&&document.all&&(document.getElementById=function(id){return document.all[id]});var getQueryParamValue=deconcept.util.getRequestParameter,FlashObject=deconcept.SWFObject,SWFObject=deconcept.SWFObject;function SWFMacMouseWheel(swfObject){this.so=swfObject,-1!=navigator.appVersion.toLowerCase().indexOf("mac")&&this.init()}SWFMacMouseWheel.prototype={init:function(){SWFMacMouseWheel.instance=this,window.addEventListener&&window.addEventListener("DOMMouseScroll",SWFMacMouseWheel.instance.wheel,!1),window.onmousewheel=document.onmousewheel=SWFMacMouseWheel.instance.wheel},handle:function(delta){document[this.so.getAttribute("id")].externalMouseEvent(delta)},wheel:function(event){var delta=0;event.wheelDelta?(delta=event.wheelDelta/120,window.opera&&(delta=-delta)):event.detail&&(delta=-event.detail/3),/AppleWebKit/.test(navigator.userAgent)&&(delta/=3),delta&&SWFMacMouseWheel.instance.handle(delta),event.preventDefault&&event.preventDefault(),event.returnValue=!1}};YUI.add("view-count",function(Y){var state;function queue(photo_id,referrer,async_on_server){var referrer_is_a_path,viewData;photo_id&&canQueue(photo_id)&&(referrer&&Y.Lang.isString(referrer)||(referrer=document.referrer),"/"===referrer.charAt(0)&&(referrer_is_a_path=!0),(viewData={}).photo_id=photo_id,async_on_server&&(viewData.async=!0),referrer_is_a_path?viewData.path=referrer:viewData.referrer=referrer,state.queued[photo_id]=viewData,state.pendingFlush||(state.pendingFlush=setTimeout(flushQueue,1e3)))}function flushQueue(){state.pendingFlush&&(clearTimeout(state.pendingFlush),state.pendingFlush=void 0,function(){var max_per_call,batch,photo_ids,params,callback,remove_from_logging_hash;max_per_call=Y.config.flickr.max_photo_ids_per_api_call,batch=state.queued,state.queued={},photo_ids=Y.Object.keys(batch),max_per_call&&max_per_call<photo_ids.length&&Y.Array.each(photo_ids,function(photo_id,idx){max_per_call<=idx&&(queue(batch[photo_id]),batch[photo_id]=void 0,delete batch[photo_id])});Y.mix(state.logging,batch),"flickr.photos.addView",params={views:Y.JSON.stringify(Y.Object.values(batch))},callback={success:function(obj){Y.mix(state.logged,batch),remove_from_logging_hash()},failure:function(obj){remove_from_logging_hash()}},remove_from_logging_hash=function(){Y.Object.each(batch,function(batch_obj,batch_photo_id){state.logging[batch_photo_id]=void 0,delete state.logging[batch_photo_id]})},Y.flickrAPI.callMethod("flickr.photos.addView",params,callback)}())}function canQueue(photo_id){return!(state.queued[photo_id]||state.logging[photo_id]||state.logged[photo_id])}state={queued:{},logging:{},logged:{},pendingFlush:void 0},Y.ViewCount={canQueue:canQueue,queue:queue,flushQueue:flushQueue}},"0.0.1",{requires:F.config.modules["view-count"].requires||[],optional:F.config.modules["view-count"].optional||[]});YUI.add("playr",function(Y){"use strict";var context,is_open,defaultPhoto,positionManager,positions,mode="frame",yBody=Y.one("body"),startPosition=0,padding=0,movement_direction=0,mobileLightbox=Y.config.flickr.lightbox.enable_mobile_lightbox&&(Y.UA.iphone||Y.UA.ipod||Y.UA.android&&Y.UA.mobile),retinaDisplay=(Y.UA.android&&Y.UA.mobile,1<window.devicePixelRatio),swf_path="/apps/video/stewart.swf.v"+Y.config.flickr.video_player_version,swfs=[],timeUntilUIFades=3e3,ViewCount=Y.ViewCount,SMALL_HEIGHT_LIMIT=250,SMALL_WIDTH_LIMIT=600,SMALLEST_HEIGHT_LIMIT=250,SMALLEST_WIDTH_LIMIT=400,ENABLE_COMMENTS=!1,ENABLE_VIDEO=!0,memo={};function getViewportSize(){return!0,memo.viewport,mobileLightbox&&(90===Math.abs(window.orientation),screen.width,screen.height),memo.viewport={height:yBody.get("clientHeight"),width:yBody.get("clientWidth")},memo.viewport.width+200,memo.viewport}function getBestFit(photo){var big_enough_size,best_size,biggest_size,scale,scale_h,scale_w,size_w,size_h,max_h=getViewportSize().height-padding,max_w=getViewportSize().width-padding,retina_factor=1;return retinaDisplay&&screen&&500<screen.width&&(retina_factor=2),Y.Object.each(photo.get("sizes"),function(size,name){size&&"o"!==name&&"k"!==name&&(size_w=parseInt(size.width,10),size_h=parseInt(size.height,10),(max_w*retina_factor<=size_w||max_h*retina_factor<=size_h)&&(!big_enough_size||size.height<parseInt(big_enough_size.height,10))&&((big_enough_size=size).name=name),(!biggest_size||size_w>parseInt(biggest_size.width,10)||size_h>parseInt(biggest_size.height,10))&&((biggest_size=size).name=name)),best_size=big_enough_size||biggest_size}),scale_h=max_h/best_size.height,scale=(scale_w=max_w/best_size.width)<scale_h?scale_w:scale_h,{height:parseInt(best_size.height,10),width:parseInt(best_size.width,10),url:best_size.url,scale:scale,scaled_height:scale<1?Math.round(scale*best_size.height):best_size.height,scaled_width:scale<1?Math.round(scale*best_size.width):best_size.width,name:best_size.name}}function isSlideshow(){return"slideshow"===mode}function handlePhotoLoaded(contextid,position,photo){var thumbUrl,preloadImg,current_position=getOpenPosition();positionManager.addPosition(position,{photo:photo})&&(thumbUrl=photo.get("sizes").t.url,(preloadImg=new Image).onload=function(){preloadImg=null},preloadImg.src=thumbUrl,position!==current_position&&Y.ContextData.getPhoto(contextid,position)&&addPhoto(positionManager.getPosition(position).photo,function(photo,photoNode){}))}function resetFadeOutTimer(){clearTimeout(memo.fadeOutTimeout),memo.fadeOutTimeout=setTimeout(fadeOutUI,timeUntilUIFades)}function fadeOutUI(){clearTimeout(memo.fadeOutTimeout),getPositionNode(getOpenPosition()).addClass("faded")}function fadeInUI(){clearTimeout(memo.fadeInTimeout),getPositionNode(getOpenPosition()).removeClass("faded")}function getPhotoNode(id){return Y.one("#photo-"+id)}function getPositionNode(pos){var posCtx=positionManager.getPosition(pos);return!!posCtx&&getPhotoNode(posCtx.photo.get("id"))}function getOpenContext(){return context}function setOpenPosition(pos){memo.openPosition=pos}function getOpenPosition(){return memo.openPosition||0}function getOpenPhoto(){return Y.ContextData.getPhoto(context.id,getOpenPosition())}function toggleFave(){var photo=getOpenPhoto();getPhotoNode(photo.get("id")).one(".il_fav");photo.get("can_fave")&&photo.toggle_fave()}function handleIsFaveChange(e){var photo=e.target,photoNode=getPhotoNode(photo.get("id"));photoNode&&setClassesForFavedPhoto(photoNode,photo)}function handleFavoritesChange(e){var photo=e.target,photoNode=getPhotoNode(photo.get("id"));photoNode&&(photoNode.one(".il_fav .li_counter").set("innerHTML",photo.get("fave_count")),setClassesForCounts(photoNode.one(".il_fav"),photo.get("fave_count")))}function toggleFullScreen(e){(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled)&&!memo.isFullscreen?(memo.isFullscreen=!0,function(element){element.requestFullScreen?element.requestFullScreen():element.mozRequestFullScreen?element.mozRequestFullScreen():element.webkitRequestFullScreen&&element.webkitRequestFullScreen()}(document.documentElement)):(memo.isFullscreen=!1,document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen())}function preloadPositions(){var limit,threshold,open_context_id,current_position,start,end,preload_range,position;if(limit=Y.config.flickr.lightbox.position_preload_limit||0,threshold=Y.config.flickr.lightbox.position_preload_threshold||limit,Y.Lang.isNumber(limit)&&Y.Lang.isNumber(threshold))for(open_context_id=getOpenContext().id,current_position=getOpenPosition(),position=(preload_range=0<movement_direction?((end=(Math.floor(current_position/limit)+1)*limit)-(start=current_position+1)<threshold&&(end+=threshold),[start,end]):movement_direction<0?(start=current_position-1,end=(Math.ceil(current_position/limit)-1)*limit,Math.abs(end-start)<threshold&&(end-=threshold),[end,start]):[start=current_position-Math.ceil(limit/2),end=current_position-Math.floor(limit/2)+limit])[0];position<=preload_range[1];position++)position!==current_position&&Y.ContextData.loadPhoto(open_context_id,position)}function goBack(e){"function"==typeof e.preventDefault&&e.preventDefault(),ViewCount.flushQueue(),goTo(getOpenPosition()-1)}function goForward(e){"function"==typeof e.preventDefault&&e.preventDefault(),ViewCount.flushQueue(),goTo(getOpenPosition()+1)}function goTo(position){var prevLimit,nextLimit,position_node,old_position,oldPositionNode,newPhoto;if(context.id&&Y.Lang.isNumber(position)){if(prevLimit=Y.ContextData.getPrevLimit(context.id),Y.Lang.isNumber(prevLimit)&&position<prevLimit)return goTo(prevLimit);if(nextLimit=Y.ContextData.getNextLimit(context.id),Y.Lang.isNumber(nextLimit)&&nextLimit<position)return goTo(nextLimit);old_position=getOpenPosition(),movement_direction=old_position<position?1:position<old_position?-1:0,position_node=getPositionNode(position),oldPositionNode=getPositionNode(old_position),0!==movement_direction&&(position_node?(showPhotoNode(void 0,position_node),oldPositionNode.setStyle("display",""),setOpenPosition(position),resizePhoto()):(newPhoto=positionManager.getPosition(position).photo)&&addPhoto(newPhoto,function(photo,photoNode){showPhotoNode(photo,photoNode),oldPositionNode.setStyle("display",""),setOpenPosition(position)}),resetFadeOutTimer(),preloadPositions())}}function addPhoto(photo,callback){var extras,swf_obj,photoNode,container=Y.one("#photos"),photoNodeId="photo-"+photo.get("id"),pathalias=photo.get("pathalias")?Y.Escape.html(photo.get("pathalias")):photo.get("owner"),photoId=photo.get("id"),photoPageURL="/photos/"+pathalias+"/"+photo.get("id")+"/",ownerProfileURL="/photos/"+pathalias+"/",spaceballURL=(photo.get("iconserver")&&photo.get("iconfarm")&&(photo.get("iconfarm"),Y.config.flickr.static_domain,photo.get("iconserver"),photo.get("owner")),"https://combo.staticflickr.com/pw/images/spaceout.gif"),photoTitle=photo.get("title")?Y.Escape.html(photo.get("title")):Y.transjax.get("photo","untitled"),photoDescription=!!photo.get("description")&&Y.Escape.html(photo.get("description")),bestPhotoSize=getBestFit(photo),viewportSize=getViewportSize(),is_video="video"===photo.get("media"),fuzzy=photo.get("needs_interstitial");photo&&(ENABLE_VIDEO&&is_video&&photo.get("sizes").v&&photo.get("sizes").v.width?((photoNode=container.create('<div data-photo-id="'+photo.get("id")+'" id="'+photoNodeId+'" class="card" style="width: '+bestPhotoSize.scaled_width+"px; height: "+(bestPhotoSize.scaled_height-72)+"px; margin-top: "+Math.round((viewportSize.height-bestPhotoSize.scaled_height+72)/2)+'px;"></div>')).one(".lightbox-video"),container.append(photoNode),(swf_obj=new deconcept.SWFObject(swf_path,photoNodeId+"-swf","100%","100%",9,"#000000")).addParam("allowFullScreen","true"),swf_obj.addParam("allowScriptAccess","always"),swf_obj.addParam("bgcolor","#000000"),swf_obj.addParam("wmode","opaque"),swf_obj.addVariable("intl_lang",Y.config.flickr.lang),swf_obj.addVariable("onsite","true"),swf_obj.addVariable("intl_lang",Y.config.flickr.lang),swf_obj.addVariable("photo_secret",photo.get("secret")),swf_obj.addVariable("photo_id",photo.get("id")),swf_obj.addVariable("flickr_noAutoPlay",!0),swf_obj.addVariable("hd_default",Y.config.flickr.lightbox.hd_default?"true":"false"),swf_obj.write(photoNodeId),swfs[photo.get("id")]=container.one("#"+photoNodeId+"-swf").getDOMNode()):photoNode=container.create('<div data-photo-id="'+photo.get("id")+'" id="photo-'+photo.get("id")+'" class="card" style="width: '+bestPhotoSize.scaled_width+"px; height: "+bestPhotoSize.scaled_height+"px; margin-top: "+Math.round((viewportSize.height-bestPhotoSize.scaled_height)/2)+'px;"><a class="photo-link" href="'+photoPageURL+'"><img src="'+(fuzzy?spaceballURL:bestPhotoSize.url)+'" width="'+bestPhotoSize.scaled_width+'" height="'+bestPhotoSize.scaled_height+'" alt="'+Y.Escape.html(photo.get("title"))+'"></a></div>'),extras=(isSlideshow()?'<ul class="nav-arrows"><li class="nav-arrow-left"><a class="arrow" href="#"><span class="marker fade-target"></span></a></li><li class="nav-arrow-right"><a class="arrow" href="#"><span class="marker fade-target"></span></a></li></ul>':"")+'<div class="info-bar"><div class="opacityBackground fade-target"></div><ul class="imgLinks"><li class="il_cta il_fav counter0 fade-target"><span class="li_divider"></span><span class="li_icon"></span><span class="li_counter">'+photo.get("fave_count")+'</span><span class="li_99_plus">99+</span></li><li class="il_cta il_fullscreen fade-target"><span class="li_icon"></span></li><li><a class="logo fade-target" href="'+F.config.flickr.site_root+'" title="flickr"><img src="'+spaceballURL+'" /></a></li></ul><div class="attribution fade-target"><span class="photographer_name"><a href="'+ownerProfileURL+'">'+Y.Escape.html(photo.get("ownername"))+'</a></span>&nbsp;<span class="title"><a href="'+photoPageURL+'">'+photoTitle+"</a></span>&nbsp;",photoDescription&&(extras+='<br/><span class="description" style="font-size: 12px;"><a href="'+photoPageURL+'">'+photoDescription+"</a></span>"),extras+="</div></div>",photoNode.append(extras),fuzzy&&photoNode.one("img").addClass("fuzzy"),setClassesForCounts(photoNode.one(".il_fav"),photo.get("fave_count")),setClassesForUIScaling(photoNode,viewportSize),setClassesForFavedPhoto(photoNode,photo),photoNode.one(".il_fav").on("click",toggleFave),photoNode.one(".il_fullscreen").on("click",toggleFullScreen),is_video||photoNode.one("a.photo-link").on("click",openInIframeParentWindow),photoNode.one("span.title a").on("click",openInIframeParentWindow),photoNode.one("span.photographer_name a").on("click",openInIframeParentWindow),photoNode.one(".logo").on("click",openInIframeParentWindow),isSlideshow()&&(photoNode.one(".nav-arrow-left a.arrow").on("click",goBack),photoNode.one(".nav-arrow-right a.arrow").on("click",goForward)),container.appendChild(photoNode),ViewCount.canQueue(photoId)&&ViewCount.queue(photoId,"playr"),"function"==typeof callback&&callback(photo,photoNode))}function showPhotoNode(photo,photoNode){context.id,getOpenPosition();photoNode.setStyle("display","block")}function setClassesForCounts(node,count){0<count&&node.addClass("showCount"),9<count&&node.addClass("showCountTwo"),99<count&&node.addClass("showCountThree")}function setClassesForUIScaling(node,viewportSize){(viewportSize=viewportSize||getViewportSize()).width<SMALLEST_WIDTH_LIMIT||viewportSize.height<SMALLEST_HEIGHT_LIMIT?node.addClass("smallest-ui"):viewportSize.width<SMALL_WIDTH_LIMIT||viewportSize.height<SMALL_HEIGHT_LIMIT?node.addClass("small-ui"):(node.removeClass("small-ui"),node.removeClass("smallest-ui"))}function setClassesForFavedPhoto(node,photo){photo.get("is_fave")?node.one(".il_fav").addClass("is_fav"):node.one(".il_fav").removeClass("is_fav")}function openInIframeParentWindow(e){var anchor=e.target.ancestor("a",!0);anchor&&(e.preventDefault(),window.open(anchor.get("href"),"_top"))}function resizePhoto(e){var bufferImage,photo=getOpenPhoto(),photoNode=getPhotoNode(photo.get("id")),imgNode=photoNode.one(".photo-link img"),bestPhotoSize=getBestFit(photo),viewportSize=getViewportSize(),fuzzy=photo.get("needs_interstitial");ENABLE_VIDEO&&"video"===photo.get("media")&&photo.get("sizes").v&&photo.get("sizes").v.width||fuzzy||imgNode.get("src")===bestPhotoSize.url||((bufferImage=new Image).onload=function(e){imgNode.set("src",bestPhotoSize.url)},bufferImage.src=bestPhotoSize.url,imgNode.set("width",bestPhotoSize.scaled_width).set("height",bestPhotoSize.scaled_height)),"video"===photo.get("media")?photoNode.setStyle("width",bestPhotoSize.scaled_width+"px").setStyle("margin-top",Math.round((viewportSize.height-bestPhotoSize.scaled_height+72)/2)+"px").setStyle("height",bestPhotoSize.scaled_height-72+"px"):(photoNode.setStyle("width",bestPhotoSize.scaled_width+"px").setStyle("margin-top",Math.round((viewportSize.height-bestPhotoSize.scaled_height)/2)+"px").setStyle("height",bestPhotoSize.scaled_height+"px"),imgNode.setStyle("width",bestPhotoSize.scaled_width+"px").setStyle("height",bestPhotoSize.scaled_height+"px")),setClassesForUIScaling(photoNode,viewportSize)}positions={},positionManager={addPosition:function(index,data){return!positions["p"+index]&&(positions["p"+index]=data,!0)},getPosition:function(index){return!!positions["p"+index]&&positions["p"+index]},setParam:function(index,key,value){var pos=this.getPosition(index);pos&&(pos[key]=value)},getParam:function(index,key){var pos=this.getPosition(index);return pos?pos[key]:null},each:function(func,scope){var s=scope||func;Y.each(positions,function(value,key){func.call(s,value,parseInt(key.substr(1),10))},this)}},Y.Playr={init:function init(args){return args&&"slideshow"===args.mode&&(mode="slideshow"),context=Y.ContextData.getContext(Y.config.flickr.open_context_id),setOpenPosition(startPosition),context?(!0,void 0===document.fullscreenEnabled&&void 0===document.mozFullScreenEnabled&&void 0===document.webkitFullscreenEnabled||yBody.addClass("fullScreenIsSupported"),defaultPhoto=Y.ContextData.getPhoto(context.id,startPosition),function(context_id,position){is_open||(is_open=!0,Y.PageContext.set("playr"),Y.after("PhotoData:is_faveChange",handleIsFaveChange),Y.after("PhotoData:fave_countChange",handleFavoritesChange),Y.on("resize",Y.betterThrottle(resizePhoto,20)),isSlideshow()&&(Y.keyboardShortcutManager.register({keystring:"39,74",handler:goForward,context:"playr",legend:{key:"&rarr;",description:Y.transjax.get("photo-keyboard-shortcuts","next_photo"),group:Y.transjax.get("keyboard-shortcut-legend","navigation"),order:0}}),Y.keyboardShortcutManager.register({keystring:"37,75",handler:goBack,context:"playr",legend:{key:"&larr;",description:Y.transjax.get("photo-keyboard-shortcuts","previous_photo"),group:Y.transjax.get("keyboard-shortcut-legend","navigation"),order:0}})),Y.keyboardShortcutManager.register({keystring:"70",handler:toggleFave,context:"playr",legend:{key:"F",description:Y.transjax.get("photo-keyboard-shortcuts","fave_this_photo"),group:Y.transjax.get("keyboard-shortcut-legend","actions"),order:0}}),addPhoto(defaultPhoto,function(photo,photoNode){var config;positionManager.addPosition(position,{photo:photo}),showPhotoNode(0,photoNode),config={container:"#playr"},ENABLE_COMMENTS&&(config.commentIconSelector=".il_comments",config.photoContainerSelector=".card",config.commentButtonNodeSelector=".il_comments",new Y.refreshSIHPComment(config))}))}(context.id,startPosition),window.setTimeout(fadeOutUI,1e3),function(photo){window.addEventListener("message",function(event){var tokens=(event.data||"").split(","),identifier=photo.get("id")+","+tokens[1];1!=photo.get("safety_level")&&(identifier+=",unSafe"),event.source.postMessage(identifier,"null"!==event.origin?event.origin:"*")},!1)}(defaultPhoto),isSlideshow()&&(Y.on("ContextData:photoLoaded",handlePhotoLoaded),preloadPositions()),Y.one("html").on("mouseover",fadeInUI),Y.one("html").on("mouseout",fadeOutUI),resetFadeOutTimer(),defaultPhoto):(Y.later(100,this,init),!1)}}},"0.0.1",{requires:F.config.modules.playr.requires||[],optional:F.config.modules.playr.optional||[]});YUI.add("murmurhash",function(Y){Y.murmurhash=function(key,seed){var remainder,bytes,h1,h1b,c1,c2,k1,i;for(remainder=3&key.length,bytes=key.length-remainder,h1=seed,c1=3432918353,c2=461845907,i=0;i<bytes;)k1=255&key.charCodeAt(i)|(255&key.charCodeAt(++i))<<8|(255&key.charCodeAt(++i))<<16|(255&key.charCodeAt(++i))<<24,++i,h1=27492+(65535&(h1b=5*(65535&(h1=(h1^=k1=(65535&(k1=(k1=(65535&k1)*c1+(((k1>>>16)*c1&65535)<<16)&4294967295)<<15|k1>>>17))*c2+(((k1>>>16)*c2&65535)<<16)&4294967295)<<13|h1>>>19))+((5*(h1>>>16)&65535)<<16)&4294967295))+((58964+(h1b>>>16)&65535)<<16);switch(k1=0,remainder){case 3:k1^=(255&key.charCodeAt(i+2))<<16;case 2:k1^=(255&key.charCodeAt(i+1))<<8;case 1:h1^=k1=(65535&(k1=(k1=(65535&(k1^=255&key.charCodeAt(i)))*c1+(((k1>>>16)*c1&65535)<<16)&4294967295)<<15|k1>>>17))*c2+(((k1>>>16)*c2&65535)<<16)&4294967295}return h1^=key.length,h1=2246822507*(65535&(h1^=h1>>>16))+((2246822507*(h1>>>16)&65535)<<16)&4294967295,h1=3266489909*(65535&(h1^=h1>>>13))+((3266489909*(h1>>>16)&65535)<<16)&4294967295,(h1^=h1>>>16)>>>0}},"0.0.1",{});